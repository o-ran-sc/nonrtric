[{"id":"d0df0900.4fcd5","type":"dgstart","name":"DGSTART","outputs":1,"x":133,"y":56,"z":"7c97bedb.1d31f","wires":[["c6ff669a.26cce"]]},{"id":"c6ff669a.26cce","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":229.23807907104492,"y":116.95239067077637,"z":"7c97bedb.1d31f","wires":[["a36cb8ff.96247"]]},{"id":"a36cb8ff.96247","type":"method","name":"tunnelxconn-topology-operation-unassign","xml":"<method rpc='tunnelxconn-topology-operation-unassign' mode='sync'>\n","comments":"","outputs":1,"x":273.15489196777344,"y":156.190447807312,"z":"7c97bedb.1d31f","wires":[["80d4d61f.2e5f5"]]},{"id":"80d4d61f.2e5f5","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","comments":"","outputs":1,"x":183.47619247436523,"y":295.5237879753113,"z":"7c97bedb.1d31f","wires":[["f43956d6.a61ab","78019473.89211c","56e75d3b.d9027c","399e93b8.1efa3c","87471e8d.32c7a8","b069670d.e3fd9","8def1fff.634bf","763bc49e.756a84"]]},{"id":"78019473.89211c","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":450.0001106262207,"y":965.2145080566406,"z":"7c97bedb.1d31f","wires":[]},{"id":"f43956d6.a61ab","type":"set","name":"set output to api handler","xml":"<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='tunnelxconn-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $tunnelxconn-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n","comments":"","x":478.75402450561523,"y":929.3370542526245,"z":"7c97bedb.1d31f","wires":[]},{"id":"399e93b8.1efa3c","type":"set","name":"set tmp.ar.self-link","xml":"<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:tunnelxconn-allotted-resources/tunnelxconn-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/tunnelxconn-topology/'` \" />\n\n","comments":"","x":445.73806381225586,"y":269.33332538604736,"z":"7c97bedb.1d31f","wires":[]},{"id":"56e75d3b.d9027c","type":"set","name":"set tmp.ar.allotted-resource-id,etc","xml":"<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$tunnelxconn-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n<parameter name='tmp.ar.parent-service-instance-id' value='`$tunnelxconn-topology-operation-input.allotted-resource-information.parent-service-instance-id`' />\n\n\n","comments":"","x":492.9973258972168,"y":235.59259128570557,"z":"7c97bedb.1d31f","wires":[]},{"id":"87471e8d.32c7a8","type":"execute","name":"execute Properties","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n","comments":"","outputs":1,"x":451.9934196472168,"y":305.23152446746826,"z":"7c97bedb.1d31f","wires":[[]]},{"id":"8def1fff.634bf","type":"execute","name":"execute RestApiCallNode - Get AR by id","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n","comments":"","outputs":1,"x":514.5187530517578,"y":466.4594917297363,"z":"7c97bedb.1d31f","wires":[["2879f807.c2d608","c9414c31.18699"]]},{"id":"b069670d.e3fd9","type":"execute","name":"generate allotted-resource url","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.tx-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n","comments":"","outputs":1,"x":480.0648536682129,"y":365.0172290802002,"z":"7c97bedb.1d31f","wires":[[]]},{"id":"2879f807.c2d608","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":771.8148918151855,"y":465.26725220680237,"z":"7c97bedb.1d31f","wires":[["f4855ff6.0b3b"]]},{"id":"14a648.1d9f09b9","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":792.837329864502,"y":872.432332418859,"z":"7c97bedb.1d31f","wires":[["c4ba90bf.2de4a"]]},{"id":"d473f1de.148fe8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":783.8373794555664,"y":840.9323581680655,"z":"7c97bedb.1d31f","wires":[["c4ba90bf.2de4a"]]},{"id":"a8e7182f.312998","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":787.5874176025391,"y":811.2894630432129,"z":"7c97bedb.1d31f","wires":[["4057dc1e.4aac64"]]},{"id":"c4ba90bf.2de4a","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for tunnelxconn-allotted-resource\" />\n","comments":"","x":953.5874176025391,"y":841.6823820099235,"z":"7c97bedb.1d31f","wires":[]},{"id":"f4855ff6.0b3b","type":"block","name":"block: atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":952.8148460388184,"y":465.7672016620636,"z":"7c97bedb.1d31f","wires":[["cffd4ec6.6adda","db8e227c.028b78"]]},{"id":"cffd4ec6.6adda","type":"switchNode","name":"switch tx length","xml":"<switch test='`$mdsal-ar.tunnelxconn-allotted-resource_length`'>\n","comments":"","outputs":1,"x":1198.6720924377441,"y":500.052964925766,"z":"7c97bedb.1d31f","wires":[["5cecfc03.3b3404"]]},{"id":"5cecfc03.3b3404","type":"other","name":"outcome 1","xml":"<outcome value='1'>\n","comments":"","outputs":1,"x":1389.6720962524414,"y":500.0529625415802,"z":"7c97bedb.1d31f","wires":[["51b6d859.ea7e28"]]},{"id":"a96ddd82.3a31d","type":"set","name":"set tx-ar from get","xml":"<set>\n<parameter name='tx-ar.' value='$mdsal-ar.tunnelxconn-allotted-resource[0].' />\n","comments":"","x":1789.5292320251465,"y":500.62438678741455,"z":"7c97bedb.1d31f","wires":[]},{"id":"51b6d859.ea7e28","type":"block","name":"block: atomic","xml":"<block atomic='true'>\n","atomic":"false","comments":"","outputs":1,"x":1560.5290794372559,"y":500.6244316101074,"z":"7c97bedb.1d31f","wires":[["a96ddd82.3a31d","ec99f86c.00d618","23d29c1b.fb536c"]]},{"id":"ec99f86c.00d618","type":"set","name":"set oper-status","xml":"<set>\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$tx-ar.allotted-resource-data.allotted-resource-operation-information.request-information.request-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$tx-ar.allotted-resource-status.rpc-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$tx-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.svc-request-id`' />\n\n","comments":"","x":1787.5294761657715,"y":568.0529508590698,"z":"7c97bedb.1d31f","wires":[]},{"id":"6c17e931.0e29b","type":"comment","name":"GET tunnelxconn-allotted-resource from mdsal","info":"","comments":"","x":539.8148155212402,"y":429.7671926021576,"z":"7c97bedb.1d31f","wires":[]},{"id":"23d29c1b.fb536c","type":"switchNode","name":"switch order-status","xml":"<switch test='`$tx-ar.allotted-resource-data.allotted-resource-oper-status.order-status`'>\n","comments":"","outputs":1,"x":1797.52925491333,"y":533.6243848800659,"z":"7c97bedb.1d31f","wires":[["5f932a1c.5e9fdc","72c9269a.8f042"]]},{"id":"5f932a1c.5e9fdc","type":"outcome","name":"outcome Created","xml":"<outcome value='Created'>\n","comments":"","outputs":1,"x":2009.1292114257812,"y":494.6243848800659,"z":"7c97bedb.1d31f","wires":[["44c6766b.392c3"]]},{"id":"72c9269a.8f042","type":"outcome","name":"outcome Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2034.8435859680176,"y":530.052975654602,"z":"7c97bedb.1d31f","wires":[["44c6766b.392c3"]]},{"id":"db8e227c.028b78","type":"set","name":"save backup copy of mdsal-ar for rollback","xml":"<set>\n<parameter name='bk-tx-ar' value='$mdsal-ar.' />\n","comments":"","x":1278.3864250183105,"y":465.76729369163513,"z":"7c97bedb.1d31f","wires":[]},{"id":"547d4cb2.bc5df4","type":"comment","name":"Create urls for restapi","info":"","comments":"","x":450.9576606750488,"y":334.6243562698364,"z":"7c97bedb.1d31f","wires":[]},{"id":"4057dc1e.4aac64","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":929.2433853149414,"y":807.481632232666,"z":"7c97bedb.1d31f","wires":[[]]},{"id":"c9414c31.18699","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":771.5766868591309,"y":501.4814250469208,"z":"7c97bedb.1d31f","wires":[["98283d92.bd116"]]},{"id":"98283d92.bd116","type":"block","name":"block: atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":951.5766372680664,"y":502.1479756832123,"z":"7c97bedb.1d31f","wires":[[]]},{"id":"44c6766b.392c3","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2223.5997276306152,"y":496.0000190734863,"z":"7c97bedb.1d31f","wires":[[]]},{"id":"763bc49e.756a84","type":"execute","name":"execute RestApiCallNode - PUT AR by id","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='DELETE' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n","comments":"","outputs":1,"x":516.0000610351562,"y":824.0000267028809,"z":"7c97bedb.1d31f","wires":[["a8e7182f.312998","d473f1de.148fe8","14a648.1d9f09b9"]]}]
