[{"id":"bf3334ad.aa95c8","type":"for","name":"for each l3-network","xml":"<for index='network-index' start='0' end='`$tmp.aai.l3-networks.l3-network_length`' >\n","comments":"","outputs":1,"x":954,"y":926.4010419845581,"z":"feb1c694.520168","wires":[["4424c7b4.c59f48"]]},{"id":"119ee255.4a85ae","type":"switchNode","name":"switch : aic-cloud-region - relationship-value == input","xml":"<switch test='`$tmp.aai.l3-networks.l3-network[$network-index].relationship-list.relationship[$ridx].relationship-data[$rdidx].relationship-value == $query-aai-l3-network-by-network-role-input.aic-cloud-region`'>\n","comments":"","outputs":1,"x":2333.6945724487305,"y":1135.9482860565186,"z":"feb1c694.520168","wires":[["91405384.4ade9"]]},{"id":"91405384.4ade9","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2614.6946029663086,"y":1136.0912313461304,"z":"feb1c694.520168","wires":[["e38015d.73828e8"]]},{"id":"e38015d.73828e8","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":2748.5275802612305,"y":1135.5673398971558,"z":"feb1c694.520168","wires":[["95b3e438.5935d8","1ef86d14.11e0f3"]]},{"id":"95b3e438.5935d8","type":"set","name":"set cloud.matched.l3-networks[]","xml":"<set>\n<parameter name='cloud.matched.l3-networks[$cloud.matched.l3-networks_length].' \n\tvalue='$tmp.aai.l3-networks.l3-network[$network-index].' />","comments":"","x":2974.416374206543,"y":1135.5672016143799,"z":"feb1c694.520168","wires":[]},{"id":"c177097b.58dea8","type":"dgstart","name":"DGSTART","outputs":1,"x":100.61910247802734,"y":47.99999713897705,"z":"feb1c694.520168","wires":[["608f149b.34f30c"]]},{"id":"608f149b.34f30c","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":362.90482330322266,"y":48.17857074737549,"z":"feb1c694.520168","wires":[["e9648dda.ccd68"]]},{"id":"e9648dda.ccd68","type":"method","name":"method: query-aai-l3-network-by-network-role","xml":"<method rpc='query-aai-l3-network-by-network-role' mode='sync'>\n","comments":"","outputs":1,"x":225.94051361083984,"y":110.37698078155518,"z":"feb1c694.520168","wires":[["2ee88c19.4df2e4"]]},{"id":"12517b26.0dc7b5","type":"comment","name":"Required INPUTS","info":"query-aai-l3-network-by-network-role-input.filter\n - Either filter=[aic-cloud-region|service-instance-id|Other]\n   - Other: match on aic-cloud-region first; if more than 1 match, \n     then match against service-instance-id\n   - aic-cloud-region: match on 1st occurance of cloud region id\n   - service-instance-id: match on 1st occurance of service-instance-id\n\nquery-aai-l3-network-by-network-role-input.aic-cloud-region\n - filter multiple l3-networks with same network-role\n\nquery-aai-l3-network-by-network-role-input.service-instance-id\n - filter multiple l3-networks with same network-role and\n   aic-cloud-region, \n   \nquery-aai-l3-network-by-network-role-input.network-role\n - key for l3-network from AAI query\n ","comments":"","x":742.4405517578125,"y":47,"z":"feb1c694.520168","wires":[]},{"id":"93c2ab0e.7958f8","type":"get-resource","name":"get-resource l3-networks by network-role","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-networks\" \n\t\tkey=\"l3-network.network-role = $query-aai-l3-network-by-network-role-input.network-role\" \n\tpfx='tmp.aai.l3-networks' >","comments":"","outputs":1,"x":503.6429138183594,"y":463.210355758667,"z":"feb1c694.520168","wires":[["5cbbeab8.150404","52bcd52.4d21e2c"]]},{"id":"52bcd52.4d21e2c","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":755.6906280517578,"y":485.3531951904297,"z":"feb1c694.520168","wires":[["3d7eccad.709ca4"]]},{"id":"3d7eccad.709ca4","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Error retrieving l3-network from AAI with network-role = ' + $query-aai-l3-network-by-network-role-input.network-role`\" />\n","comments":"","x":930.690601348877,"y":485.3532314300537,"z":"feb1c694.520168","wires":[]},{"id":"5cbbeab8.150404","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":764.6192245483398,"y":443.6389284133911,"z":"feb1c694.520168","wires":[["251e6c77.f17114"]]},{"id":"251e6c77.f17114","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No active l3-network found in AAI with cloud_region_id '\n          + $vnf-topology-operation-input.vnf-request-information.aic-cloud-region + ' and network_role '\n          + $query-aai-l3-network-by-network-role-input.network-role`\" />\n","comments":"","x":930.9685020446777,"y":442.9445056915283,"z":"feb1c694.520168","wires":[]},{"id":"2a1dd340.f0380c","type":"comment","name":"Returns tmp.aai.l3-networks[]","info":"","comments":"","x":1128.0079862806533,"y":458.06749153137207,"z":"feb1c694.520168","wires":[]},{"id":"48a24709.984178","type":"switchNode","name":"switch: input.aic-cloud-region","xml":"<switch test='`$query-aai-l3-network-by-network-role-input.aic-cloud-region`'>\n","comments":"","outputs":1,"x":468.5476837158203,"y":182.9285659790039,"z":"feb1c694.520168","wires":[["6a12f78b.c08e18"]]},{"id":"6a12f78b.c08e18","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":694.797664642334,"y":183.1785659790039,"z":"feb1c694.520168","wires":[["4b61b754.ab7388"]]},{"id":"4b61b754.ab7388","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"query-aai-l3-network-by-network-role-input.aic-cloud-region is null\" />\n","comments":"","x":856.7143363952637,"y":183.2896647453308,"z":"feb1c694.520168","wires":[]},{"id":"87170b50.c8b308","type":"switchNode","name":"switch: input.service-instance-id","xml":"<switch test='`$query-aai-l3-network-by-network-role-input.service-instance-id`'>\n","comments":"","outputs":1,"x":476.29766845703125,"y":230.9285659790039,"z":"feb1c694.520168","wires":[["f2134453.11a5e8"]]},{"id":"f2134453.11a5e8","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":709.7976760864258,"y":230.4285659790039,"z":"feb1c694.520168","wires":[["32323a30.adcc96"]]},{"id":"32323a30.adcc96","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"query-aai-l3-network-by-network-role-input.service-instance-id is null\" />\n","comments":"","x":871.7143478393555,"y":230.5396647453308,"z":"feb1c694.520168","wires":[]},{"id":"e6e4ed73.68284","type":"switchNode","name":"switch: input.network-role","xml":"<switch test='`$query-aai-l3-network-by-network-role-input.network-role`'>\n","comments":"","outputs":1,"x":457.04766845703125,"y":279.6785697937012,"z":"feb1c694.520168","wires":[["39cb02ff.11c3de"]]},{"id":"39cb02ff.11c3de","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":663.5476760864258,"y":279.1785697937012,"z":"feb1c694.520168","wires":[["6eccddc7.ef39a4"]]},{"id":"6eccddc7.ef39a4","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"query-aai-l3-network-by-network-role-input.network-role is null\" />\n","comments":"","x":825.4643478393555,"y":279.2896685600281,"z":"feb1c694.520168","wires":[]},{"id":"2ee88c19.4df2e4","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":188.86910247802734,"y":183.24999713897705,"z":"feb1c694.520168","wires":[["48a24709.984178","e6e4ed73.68284","93c2ab0e.7958f8","8c3ad4c3.1173b8","762f5443.53124c","36e9d5a6.c6e93a","87170b50.c8b308"]]},{"id":"d12e8629.e48a78","type":"comment","name":"Change History","info":"9/20/17\n- added otpion to match on aic-cloud-region only, service-instance-id only, or both\n9555\n- added set node to empty query-aai-l3-network-by-network-role-output and tmp.aai.l3-networks.\n9675\n- return error when no l3-network found with the given cloud-region instead of picking the first network found in the list\n- return error when no l3-network found with the given cloud-region and service-instance-id\n- removed filter option to query only by cloud-region or service-instance-id; i.e. query must be by cloud-region and then service-instance-id\n10846\n- node 11, 12 fixed network-role variable in error-message","comments":"","x":114.94052124023438,"y":300.0357093811035,"z":"feb1c694.520168","wires":[]},{"id":"f84da69.6e03a58","type":"for","name":"for relationship list","xml":"<for index='ridx' start='0' end='`$tmp.aai.l3-networks.l3-network[$network-index].relationship-list.relationship_length`' >\n","comments":"","outputs":1,"x":1352.0358123779297,"y":987.0596609115601,"z":"feb1c694.520168","wires":[["3dd4f64f.d4b96a"]]},{"id":"41f1c1ff.38c4a","type":"switchNode","name":"switch: relationship-key","xml":"<switch test='`$tmp.aai.l3-networks.l3-network[$network-index].relationship-list.relationship[$ridx].relationship-data[$rdidx].relationship-key`'>\n","comments":"","outputs":1,"x":1745.7977600097656,"y":1135.3148355484009,"z":"feb1c694.520168","wires":[["63768c9a.07fbc4"]]},{"id":"63768c9a.07fbc4","type":"other","name":"cloud-region.cloud-region-id","xml":"<outcome value='cloud-region.cloud-region-id'>\n","comments":"","outputs":1,"x":1992.7265014648438,"y":1135.5886306762695,"z":"feb1c694.520168","wires":[["119ee255.4a85ae"]]},{"id":"f7a5b0c6.f93ab","type":"for","name":"for relationship data","xml":"<for silentFailure='false' index='rdidx' start='0' end=\"`$tmp.aai.l3-networks.l3-network[$network-index].relationship-list.relationship[$ridx].relationship-data_length`\" >\n","comments":"","outputs":1,"x":1525.2024383544922,"y":1135.4375448226929,"z":"feb1c694.520168","wires":[["41f1c1ff.38c4a"]]},{"id":"1ef86d14.11e0f3","type":"set","name":"set cloud.matched.l3-networks_length++","xml":"<set>\n<parameter name='cloud.matched.l3-networks_length' value='`$cloud.matched.l3-networks_length + 1`' />","comments":"","x":3002.797737121582,"y":1182.3612508773804,"z":"feb1c694.520168","wires":[]},{"id":"8c3ad4c3.1173b8","type":"switchNode","name":"switch : $tmp.aai.l3-networks.l3-network_length","xml":"<switch test='`$tmp.aai.l3-networks.l3-network_length`'>\n","comments":"","outputs":1,"x":518.0476760864258,"y":552.8928813934326,"z":"feb1c694.520168","wires":[["7b296b5.86add94","902a8730.77e468"]]},{"id":"7b296b5.86add94","type":"outcomeTrue","name":"1","xml":"<outcome value='1'>\n","comments":"","outputs":1,"x":788.5476760864258,"y":552.8928813934326,"z":"feb1c694.520168","wires":[["ece02720.817ac8"]]},{"id":"ece02720.817ac8","type":"set","name":"set query-aai-l3-network-by-network-role-output","xml":"<set>\n<parameter name='query-aai-l3-network-by-network-role-output.l3-network.' \n\tvalue='`$tmp.aai.l3-networks.l3-network[0].`' />\n\t\n<!--\n<parameter name='query-aai-l3-network-by-network-role-output.network-id' \n\tvalue='`$tmp.aai.l3-networks.l3-network[0].network-id`' />\n<parameter name='query-aai-l3-network-by-network-role-output.network-name' \n\tvalue='`$tmp.aai.l3-networks.l3-network[0].network-name`' />\n-->","comments":"","x":1054.0476608276367,"y":553.1428718566895,"z":"feb1c694.520168","wires":[]},{"id":"902a8730.77e468","type":"outcomeTrue","name":"Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":789.4405860900879,"y":604.857141494751,"z":"feb1c694.520168","wires":[["bd59e54d.eed458"]]},{"id":"a4529200.80a9d","type":"for","name":"for each cloud.matched.l3-networks","xml":"<for index='cidx' start='0' end='`$cloud.matched.l3-networks_length`' >\n","comments":"","outputs":1,"x":1687.7738723754883,"y":1583.9166793823242,"z":"feb1c694.520168","wires":[["e8437766.bb91b8"]]},{"id":"4a250290.cbbefc","type":"switchNode","name":"switch : $cloud.matched.l3-networks_length","xml":"<switch test='`$cloud.matched.l3-networks_length`'>\n","comments":"","outputs":1,"x":1014.7501373291016,"y":1319.2738027572632,"z":"feb1c694.520168","wires":[["ff85c7a5.83cff8","20d04cd7.e412a4","1317425a.01096e"]]},{"id":"ff85c7a5.83cff8","type":"outcomeTrue","name":"1","xml":"<outcome value='1'>\n","comments":"","outputs":1,"x":1282.2501373291016,"y":1319.2738027572632,"z":"feb1c694.520168","wires":[["af038e06.b9472"]]},{"id":"af038e06.b9472","type":"set","name":"set query-aai-l3-network-by-network-role-output","xml":"<set>\n<parameter name='query-aai-l3-network-by-network-role-output.l3-network.' \n\tvalue='`$cloud.matched.l3-networks[0].`' />\n\t\t\n<!--\t\t\n\t<parameter name='query-aai-l3-network-by-network-role-output.network-id' \n\t\tvalue='`$cloud.matched.l3-networks[0].network-id`' />\n\t<parameter name='query-aai-l3-network-by-network-role-output.network-name' \n\t\tvalue='`$cloud.matched.l3-networks[0].network-name`' />\n-->","comments":"","x":1552.7501220703125,"y":1319.52379322052,"z":"feb1c694.520168","wires":[]},{"id":"20d04cd7.e412a4","type":"outcomeTrue","name":"Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1282.4286575317383,"y":1370.809497833252,"z":"feb1c694.520168","wires":[["13260e8c.efd691"]]},{"id":"2a7ed906.631a66","type":"switchNode","name":"switch : service-instance-id - relationship-value == input","xml":"<switch test='`$cloud.matched.l3-networks[$cidx].relationship-list.relationship[$ridx].relationship-data[$rdidx].relationship-value == $query-aai-l3-network-by-network-role-input.service-instance-id`'>\n","comments":"","outputs":1,"x":2914.254077911377,"y":1886.9523391723633,"z":"feb1c694.520168","wires":[["89c568f6.31c118"]]},{"id":"89c568f6.31c118","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":3195.254108428955,"y":1887.095284461975,"z":"feb1c694.520168","wires":[["173f8ae2.0d3ce5"]]},{"id":"99cd11af.d390b","type":"for","name":"for relationship list","xml":"<for index='ridx' start='0' end='`$cloud.matched.l3-networks[$cidx].relationship-list.relationship_length`' >\n","comments":"","outputs":1,"x":1876.750057220459,"y":1725.389310836792,"z":"feb1c694.520168","wires":[["d26b52e6.a3e06"]]},{"id":"ca9edd76.63442","type":"switchNode","name":"switch: relationship-key","xml":"<switch test='`$cloud.matched.l3-networks[$cidx].relationship-list.relationship[$ridx].relationship-data[$rdidx].relationship-key`'>\n","comments":"","outputs":1,"x":2258.357265472412,"y":1886.3188886642456,"z":"feb1c694.520168","wires":[["574bc8cd.72dad8"]]},{"id":"574bc8cd.72dad8","type":"other","name":"service-instance.service-instance-id","xml":"<outcome value='service-instance.service-instance-id'>\n","comments":"","outputs":1,"x":2544.2860069274902,"y":1886.5926837921143,"z":"feb1c694.520168","wires":[["2a7ed906.631a66"]]},{"id":"8de595fc.242118","type":"for","name":"for relationship data","xml":"<for silentFailure='false' index='rdidx' start='0' end=\"`$cloud.matched.l3-networks[$cidx].relationship-list.relationship[$ridx].relationship-data_length`\" >\n","comments":"","outputs":1,"x":2005.797679901123,"y":1885.8702383041382,"z":"feb1c694.520168","wires":[["ca9edd76.63442"]]},{"id":"3111a04c.69592","type":"set","name":"set query-aai-l3-network-by-network-role-output","xml":"<set>\n<parameter name='query-aai-l3-network-by-network-role-output.l3-network.' \n\tvalue='`$cloud.matched.l3-networks[$cidx].`' />\n\n<!--\n<parameter name='query-aai-l3-network-by-network-role-output.network-id' \n\tvalue='`$cloud.matched.l3-networks[$cidx].network-id`' />\n<parameter name='query-aai-l3-network-by-network-role-output.network-name' \n\tvalue='`$cloud.matched.l3-networks[$cidx].network-name`' />\n-->","comments":"","x":3666.404548100063,"y":1887.5712970324926,"z":"feb1c694.520168","wires":[]},{"id":"953777cf.56def8","type":"set","name":"set input for testing","xml":"<set>\n<parameter name='query-aai-l3-network-by-network-role-input.aic-cloud-region' \n\tvalue='mtn6' />\n<parameter name='query-aai-l3-network-by-network-role-input.service-instance-id' \n\tvalue='bogus' />\n<parameter name='query-aai-l3-network-by-network-role-input.network-role' \n\tvalue='GN_EVPN_direct' />\n<parameter name='query-aai-l3-network-by-network-role-input.filter' \n\tvalue='service-instance-id' />\n<!--\n<parameter name='query-aai-l3-network-by-network-role-input.filter' \n\tvalue='aic-cloud-region' />\n<parameter name='query-aai-l3-network-by-network-role-input.service-instance-id' \n\tvalue='e87fa574-6826-4dba-aad0-bf862a586ad3' />\n<parameter name='query-aai-l3-network-by-network-role-input.filter' \n\tvalue='Other' />\n-->","comments":"","x":875.6548385620117,"y":96.64285850524902,"z":"feb1c694.520168","wires":[]},{"id":"173f8ae2.0d3ce5","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":3353.9286308288574,"y":1887.5237760543823,"z":"feb1c694.520168","wires":[["3111a04c.69592","f2203553.f05ce8","b10af6ab.da4238"]]},{"id":"f2203553.f05ce8","type":"returnFailure","name":"BREAK","xml":"<return status='failure'>","comments":"","x":3547.4050369262695,"y":1990.6190071105957,"z":"feb1c694.520168","wires":[]},{"id":"1f5b3666.f39caa","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1439.738037109375,"y":1583.6667308807373,"z":"feb1c694.520168","wires":[["a4529200.80a9d","8869134c.cdc45"]]},{"id":"8869134c.cdc45","type":"returnSuccess","name":"CATCH BREAK","xml":"<return status='success'>\n","comments":"","x":1638.4523620605469,"y":1987.9522705078125,"z":"feb1c694.520168","wires":[]},{"id":"c8096fa6.4cf5","type":"comment","name":"OUTPUT","info":"query-aai-l3-network-by-network-role-output.l3-network.","comments":"","x":676.0477294921875,"y":92.57142639160156,"z":"feb1c694.520168","wires":[]},{"id":"3dd4f64f.d4b96a","type":"switchNode","name":"switch: relationship-list.relationship[].related-to","xml":"<switch test='`$tmp.aai.l3-networks.l3-network[$network-index].relationship-list.relationship[$ridx].related-to`'>\n","comments":"","outputs":1,"x":1504.2857666015625,"y":1053.5239171981812,"z":"feb1c694.520168","wires":[["828ee5fa.b8d688"]]},{"id":"828ee5fa.b8d688","type":"other","name":"cloud-region","xml":"<outcome value='cloud-region'>\n","comments":"","outputs":1,"x":1791.7857818603516,"y":1054.023928642273,"z":"feb1c694.520168","wires":[["f7a5b0c6.f93ab"]]},{"id":"d26b52e6.a3e06","type":"switchNode","name":"switch: relationship-list.relationship[].related-to","xml":"<switch test='`$cloud.matched.l3-networks[$cidx].relationship-list.relationship[$ridx].related-to`'>\n","comments":"","outputs":1,"x":2014.0952949523926,"y":1800.7501153945923,"z":"feb1c694.520168","wires":[["ff875f64.7bfc9"]]},{"id":"ff875f64.7bfc9","type":"other","name":"service-instance","xml":"<outcome value='service-instance'>\n","comments":"","outputs":1,"x":2301.5953102111816,"y":1801.250126838684,"z":"feb1c694.520168","wires":[["8de595fc.242118"]]},{"id":"77958b76.344254","type":"switchNode","name":"switch: relationship-list.relationship_length","xml":"<switch test='`$tmp.aai.l3-networks.l3-network[$network-index].relationship-list.relationship_length`'>","comments":"","outputs":1,"x":1427.7500457763672,"y":926.9525861740112,"z":"feb1c694.520168","wires":[["5b4e99c5.c9b4e8"]]},{"id":"5b4e99c5.c9b4e8","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":1687.0832977294922,"y":926.3692121505737,"z":"feb1c694.520168","wires":[["b52a5ba3.5bcee8"]]},{"id":"b52a5ba3.5bcee8","type":"switchNode","name":"set relationship-list.relationship_length = 0","xml":"<set>\n<parameter name ='tmp.aai.l3-networks.l3-network[$network-index].relationship-list.relationship_length' value = '0' />\n","comments":"","outputs":1,"x":1954.7500457763672,"y":926.3692121505737,"z":"feb1c694.520168","wires":[[]]},{"id":"4424c7b4.c59f48","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1144.7143249511719,"y":927.0597143173218,"z":"feb1c694.520168","wires":[["77958b76.344254","f84da69.6e03a58"]]},{"id":"5a454f73.cdbdd","type":"switchNode","name":"switch: relationship-list.relationship_length","xml":"<switch test='`$tmp.aai.l3-networks.l3-network[$network-index].relationship-list.relationship_length`'>\n","comments":"","outputs":1,"x":1949.6310653686523,"y":1657.9644203186035,"z":"feb1c694.520168","wires":[["a5fe2f1c.8d41a"]]},{"id":"a5fe2f1c.8d41a","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":2206.3929138183594,"y":1657.9524097442627,"z":"feb1c694.520168","wires":[["bb489d22.7e4d1"]]},{"id":"bb489d22.7e4d1","type":"switchNode","name":"set relationship-list.relationship_length = 0","xml":"<set>\n<parameter name ='tmp.aai.l3-networks.l3-network[$network-index].relationship-list.relationship_length' value = '0' />\n","comments":"","outputs":1,"x":2448.0596618652344,"y":1657.9524097442627,"z":"feb1c694.520168","wires":[[]]},{"id":"e8437766.bb91b8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1669.2500915527344,"y":1657.7261791229248,"z":"feb1c694.520168","wires":[["5a454f73.cdbdd","99cd11af.d390b"]]},{"id":"1317425a.01096e","type":"outcomeTrue","name":"0","xml":"<outcome value='0'>\n","comments":"","outputs":1,"x":1282.8215637207031,"y":1265.345209121704,"z":"feb1c694.520168","wires":[["d7044fae.8418"]]},{"id":"e693088d.236668","type":"set","name":"set query-aai-l3-network-by-network-role-output = FIRST l3-network","xml":"<set>\n<parameter name='query-aai-l3-network-by-network-role-output.l3-network.' \n\tvalue='`$tmp.aai.l3-networks.l3-network[0].`' />\n\t\t\n<!--\t\t\n\t<parameter name='query-aai-l3-network-by-network-role-output.network-id' \n\t\tvalue='`$cloud.matched.l3-networks[0].network-id`' />\n\t<parameter name='query-aai-l3-network-by-network-role-output.network-name' \n\t\tvalue='`$cloud.matched.l3-networks[0].network-name`' />\n-->","comments":"","x":1866.6073608398438,"y":1267.0237998962402,"z":"feb1c694.520168","wires":[]},{"id":"13260e8c.efd691","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1230.2501411437988,"y":1505.059398651123,"z":"feb1c694.520168","wires":[["1f5b3666.f39caa","2a53cc04.197444"]]},{"id":"2a53cc04.197444","type":"switchNode","name":"switch : tmp.l3-network-found","xml":"<switch test='`$tmp.l3-network-found`'>\n","comments":"","outputs":1,"x":1502.3454132080078,"y":2082.2500467300415,"z":"feb1c694.520168","wires":[["97a102aa.624f2"]]},{"id":"562dfc81.f13814","type":"set","name":"set query-aai-l3-network-by-network-role-output","xml":"<set>\n<parameter name='query-aai-l3-network-by-network-role-output.l3-network.' \n\tvalue='`$cloud.matched.l3-networks[0].`' />\n\t\t\n<!--\t\t\n\t<parameter name='query-aai-l3-network-by-network-role-output.network-id' \n\t\tvalue='`$cloud.matched.l3-networks[0].network-id`' />\n\t<parameter name='query-aai-l3-network-by-network-role-output.network-name' \n\t\tvalue='`$cloud.matched.l3-networks[0].network-name`' />\n-->","comments":"","x":2043.2026062011719,"y":2163.2619552612305,"z":"feb1c694.520168","wires":[]},{"id":"97a102aa.624f2","type":"outcomeTrue","name":"0","xml":"<outcome value='0'>\n","comments":"","outputs":1,"x":1738.4167938232422,"y":2081.988163948059,"z":"feb1c694.520168","wires":[["ae3a485b.36e298"]]},{"id":"b10af6ab.da4238","type":"set","name":"set tmp.l3-network-found = 1","xml":"<set>\n<parameter name='tmp.l3-network-found' value='1' />\n\t","comments":"","x":3610.3450622558594,"y":1937.2498664855957,"z":"feb1c694.520168","wires":[]},{"id":"bd59e54d.eed458","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":722.7381591796875,"y":806.1905012130737,"z":"feb1c694.520168","wires":[["fa71b5e1.12aad8","162f00a4.dbf4df","bf3334ad.aa95c8","4a250290.cbbefc"]]},{"id":"fa71b5e1.12aad8","type":"set","name":"set tmp.l3-network-found = 0","xml":"<set>\n<parameter name='tmp.l3-network-found' value='0' />","comments":"","x":981.5953674316406,"y":805.6190900802612,"z":"feb1c694.520168","wires":[]},{"id":"162f00a4.dbf4df","type":"set","name":"initialize cloud.matched.l3-networks_length","xml":"<set>\n<parameter name='cloud.matched.l3-networks_length' value='0' />","comments":"","x":1026.4048156738281,"y":856.8571882247925,"z":"feb1c694.520168","wires":[]},{"id":"6d4d6798.2bc218","type":"comment","name":"match both cloud-region and then service-instance-id","info":"","comments":"","x":815.2380676269531,"y":1114.8573160171509,"z":"feb1c694.520168","wires":[]},{"id":"762f5443.53124c","type":"set","name":"Empty query-aai-l3-network-by-network-role-output.","xml":"<set>\n<parameter name='query-aai-l3-network-by-network-role-output.' value='' />","comments":"","x":537.7380676269531,"y":337.4285488128662,"z":"feb1c694.520168","wires":[]},{"id":"36e9d5a6.c6e93a","type":"set","name":"Empty tmp.aai.l3-networks.","xml":"<set>\n<parameter name='tmp.aai.l3-networks.' value='' />","comments":"","x":461.8809509277344,"y":391.7143154144287,"z":"feb1c694.520168","wires":[]},{"id":"d7044fae.8418","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No l3-network with network-role=' + $query-aai-l3-network-by-network-role-input.network-role + ' and cloud-region=' + $query-aai-l3-network-by-network-role-input.aic-cloud-region + ' found in AAI'`\" />\n","comments":"","x":1441.9285430908203,"y":1265.5000114440918,"z":"feb1c694.520168","wires":[]},{"id":"ae3a485b.36e298","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No l3-network with network-role=' + $query-aai-l3-network-by-network-role-input.network-role + ' and cloud-region=' + $query-aai-l3-network-by-network-role-input.aic-cloud-region + ' and service-instance-id=' + $query-aai-l3-network-by-network-role-input.service-instance-id + ' found in AAI'`\" />\n","comments":"","x":1921.9285430908203,"y":2081.071544647217,"z":"feb1c694.520168","wires":[]}]