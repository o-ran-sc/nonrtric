[{"id":"67a53f15.ab9b6","type":"dgstart","name":"DGSTART","outputs":1,"x":133.57701110839844,"y":62.1484432220459,"z":"d5178f42.44976","wires":[["b0d5fc31.8c038"]]},{"id":"b0d5fc31.8c038","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":290.4341335296631,"y":175.6246566772461,"z":"d5178f42.44976","wires":[["366ff52e.33c5ca"]]},{"id":"366ff52e.33c5ca","type":"method","name":"network-topology-operation-assign-vlantagging-instancegroup","xml":"<method rpc='network-topology-operation-assign-vlantagging-instancegroup' mode='sync'>\n","comments":"","outputs":1,"x":336.2080764770508,"y":279.27935695648193,"z":"d5178f42.44976","wires":[["830a3a63.0a3188"]]},{"id":"23048cc0.43a9d4","type":"comment","name":"Called from assign when network instance group passed in from mso","info":"","comments":"","x":368.71986389160156,"y":139.95797157287598,"z":"d5178f42.44976","wires":[]},{"id":"830a3a63.0a3188","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":235.86273193359375,"y":576.67236328125,"z":"d5178f42.44976","wires":[["a3dcfb29.be3be8","44bed9f5.f8a198","6b6b467e.e2b328","6e7beecb.c5df7","a8edbe94.39dac","d4e2ddfb.452e","352b0634.a770ea","c0d1166f.f33bd","3e6da276.1b9876","39ea7531.083dba","985b6687.301738","b1ce3134.3e591","e090256e.e635b8","22e7595d.96a916","93ad9038.590b3","b93d2eef.37f8c","58f3035b.c67d9c","c8f94428.c0f5e8","85da8119.1634e","f05d6459.4c0c08","1eee48d9.dde947","47106adb.c7b994","f241bc6f.abe91","fe4bedce.dccf4","36134ff2.81826","ad080ed7.e2805","83f50832.31bf28","92dee517.041028","ce90a809.365528","4d821497.3ac9ac","bb175352.d3a6d","1868f533.5d5d1b","c535d1b3.3325f","43ee4152.fab5d","1618d258.7486ae","c252ed05.9b99f","307054cf.25730c","8576e473.d1f3e8","9695c264.9ae04","94083d5a.ebf56","48826944.8a8cc8"]]},{"id":"bb175352.d3a6d","type":"set","name":"set nig.vpn-bindings","xml":"<set>\n<parameter name='nig.vpn-bindings.id' value=\"`$vpn-binding.vpn-binding-id`\" />\n<parameter name='nig.vpn-bindings.global-route-target' value=\"`$vpn-binding.global-route-target`\" />\n<parameter name='nig.vpn-bindings.aic-zone' value=\"`$aaiapi.output.cloud-zone`\" />\n<parameter name='nig.vpn-bindings.route-target-role' value=\"`$vpn-binding.route-target-role`\" />\n\n","comments":"","x":755.2925186157227,"y":1952.6742695571156,"z":"d5178f42.44976","wires":[]},{"id":"6e7beecb.c5df7","type":"set","name":"copy input to service-data","xml":"<set>\n<parameter name='service-data.networks.network[$nidx].network-data.sdnc-request-header.' value='`$network-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.networks.network[$nidx].network-data.request-information.' value='`$network-topology-operation-input.request-information.`' />\n<parameter name='service-data.networks.network[$nidx].network-data.service-information.' value='`$network-topology-operation-input.service-information.`' />\n<parameter name='service-data.networks.network[$nidx].network-data.network-information.' value='`$network-topology-operation-input.network-information.`' />\n<parameter name='service-data.networks.network[$nidx].network-data.network-request-input.' value='`$network-topology-operation-input.network-request-input.`' />\n<parameter name='service-data.networks.network[$nidx].network-id' value='`$tmp.l3-network.network-id`' />","comments":"","x":906.2679061889648,"y":338.28430461883545,"z":"d5178f42.44976","wires":[]},{"id":"a8edbe94.39dac","type":"set","name":"set onap-model-info","xml":"<set>\n<parameter name='tmp.l3-network.model-invariant-id' value=\"`$network-topology-operation-input.network-information.onap-model-information.model-invariant-uuid`\" />\n<parameter name='tmp.l3-network.model-version-id' value=\"`$network-topology-operation-input.network-information.onap-model-information.model-version`\" />\n<parameter name='tmp.l3-network.model-customization-id' value=\"`$network-topology-operation-input.network-information.onap-model-information.model-customization-uuid`\" />\n<parameter name='s-onap-model-information.model-invariant-uuid' value='`$service-model.invariant-uuid`' />\n<parameter name='s-onap-model-information.model-version' value='`$service-model.version`' />\n<parameter name='s-onap-model-information.model-uuid' value='`$service-model.service-uuid`' />\n<parameter name='s-onap-model-information.model-name' value='`$service-model.name`' />\n<parameter name='n-onap-model-information.model-invariant-uuid' value='`$network-model.invariant-uuid`' />\n<parameter name='n-onap-model-information.model-version' value='`$network-model.version`' />\n<parameter name='n-onap-model-information.model-uuid' value='`$network-model.uuid`' />\n<parameter name='n-onap-model-information.model-name' value='`$network-model.name`' />","comments":"","x":892.8668212890625,"y":372.7048645019531,"z":"d5178f42.44976","wires":[]},{"id":"d4e2ddfb.452e","type":"set","name":"set onap-model-info with mysql data","xml":"<set>\n<parameter name='service-data.networks.network[$nidx]..network-data.service-information.onap-model-information.' value=\"`$s-onap-model-information.`\" />\n<parameter name='service-data.networks.network[$nidx]..network-data.network-information.onap-model-information.' value=\"`$n-onap-model-information.`\" />\n","comments":"","x":946.2596778869629,"y":409.13341426849365,"z":"d5178f42.44976","wires":[]},{"id":"6b6b467e.e2b328","type":"set","name":"set: tmp.error-message to \"\", set tmp.l3-network","xml":"<set>\n\t<parameter name=\"tmp.error-message\" value=\"\"/>\n\t<parameter name=\"tmp.l3-network.network-instance-group-id\" value=\"`$network-topology-operation-input.network-request-input.network-instance-group-id`\" />\n\t<parameter name='tmp.l3-network.network-type' value=\"`$network-model.network-type`\" />\n\t<parameter name='tmp.l3-network.network-role' value=\"`$network-model.network-role`\" />\n\t<parameter name='tmp.l3-network.network-technology' value=\"`$network-model.network-technology`\" />","comments":"","x":981.4751014709473,"y":298.4915442466736,"z":"d5178f42.44976","wires":[]},{"id":"93ad9038.590b3","type":"set","name":"set: get-complex-resource-service-model-input.customization-uuid","xml":"<set>\n\t<parameter name=\"get-complex-resource-service-model-input.customization-uuid\" value=\"`$aaiapi.output.collection-customization-uuid`\"/>","comments":"","x":908.3611755371094,"y":1220.3469247817993,"z":"d5178f42.44976","wires":[]},{"id":"22e7595d.96a916","type":"call","name":"call aai-get-network-instance-group","xml":"<call module='GENERIC-RESOURCE-API' rpc='aai-get-network-instance-group' mode='sync' >\n","comments":"","outputs":1,"x":834.7896575927734,"y":1046.6325091720792,"z":"d5178f42.44976","wires":[[]]},{"id":"85da8119.1634e","type":"set","name":"set: get-data-from-policy-input.policy-instance-name for subnet assignment","xml":"<set>\n\t<parameter name=\"get-data-from-policy-input.policy-instance-name\" value=\"`$get-complex-resource-service-model-output.subnet-assignment-policy`\" />\n\t","comments":"","x":953.1470718383789,"y":1405.6041303275852,"z":"d5178f42.44976","wires":[]},{"id":"f05d6459.4c0c08","type":"call","name":"call get-data-from-policy","xml":"<call module='GENERIC-RESOURCE-API' rpc='get-data-from-policy' mode='sync' >\n","comments":"","outputs":1,"x":789.1469879150391,"y":1444.6040411590366,"z":"d5178f42.44976","wires":[[]]},{"id":"7a297c31.4a0a24","type":"comment","name":"Determine if subnet use is unique or shared","info":"","comments":"","x":856.1469192504883,"y":1374.604030191782,"z":"d5178f42.44976","wires":[]},{"id":"1eee48d9.dde947","type":"set","name":"set: nig.subnet-assignment-policy.subnet-use","xml":"<set>\n\t<parameter name=\"nig.subnet-assignment-policy.subnet-use\" value=\"`$get-data-from-policy-output.ip-assignment`\" />\n\t","comments":"","x":858.6469116210938,"y":1480.6040077804355,"z":"d5178f42.44976","wires":[]},{"id":"ad080ed7.e2805","type":"set","name":"set: cloud owner/region","xml":"<set>\n\t<parameter name=\"aaiapi.input.cloud-owner\" value=\"`$prop.cloud-region.cloud-owner`\" />\n\t<parameter name=\"aaiapi.input.cloud-region-id\" value=\"`$network-topology-operation-input.network-request-input.aic-cloud-region`\" />\n\n\t","comments":"","x":773.7544403076172,"y":1794.0051078796387,"z":"d5178f42.44976","wires":[]},{"id":"83f50832.31bf28","type":"call","name":"call aai-get-aic-zone","xml":"<call module='GENERIC-RESOURCE-API' rpc='aai-get-aic-zone' mode='sync' >\n","comments":"","outputs":1,"x":760.7544021606445,"y":1825.005069732666,"z":"d5178f42.44976","wires":[[]]},{"id":"ce90a809.365528","type":"set","name":"set params for mS","xml":"<set>\n\t<parameter name=\"nig.cloud-zone\" value=\"`$aaiapi.output.cloud-zone`\" />\n\t<parameter name=\"rt.aic-zone\" value=\"`$aaiapi.output.cloud-zone`\" />\n\t<parameter name=\"rt.resource\" value=\"NetworkID\" />\n\t<parameter name=\"rt.resource-value\" value=\"`$tmp.l3-network.network-id`\" />\n\t<parameter name=\"rt.network-name\" value=\"`$tmp.l3-network.network-name`\" />\n\t<parameter name=\"rt.service-instance-id\" value=\"`$network-topology-operation-input.service-information.service-instance-id`\" />\n\t<parameter name=\"rt.network-instance-group-id\" value=\"`$tmp.l3-network.network-instance-group-id`\" />","comments":"","x":751.2543869018555,"y":1886.0055103302002,"z":"d5178f42.44976","wires":[]},{"id":"eef385b1.a41f98","type":"comment","name":"Get aic zone","info":"","comments":"","x":742.0043296813965,"y":1760.0050220489502,"z":"d5178f42.44976","wires":[]},{"id":"4d821497.3ac9ac","type":"call","name":"call create-route-target-and-vpn-binding","xml":"<call module='GENERIC-RESOURCE-API' rpc='create-route-target-and-vpn-binding' mode='sync' >\n","comments":"","outputs":1,"x":818.0046463012695,"y":1922.005283355713,"z":"d5178f42.44976","wires":[[]]},{"id":"b1ce3134.3e591","type":"get-resource","name":"get AnAI - l3-network by network-id","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network\" \n\t\tkey=\"l3-network.network-id = $tmp.l3-network.network-id\" \n\t\tlocal-only=\"false\" \n\t\tpfx=\"aai.l3-network\">\n","comments":"","outputs":1,"x":826.1826171875,"y":936.2040013672085,"z":"d5178f42.44976","wires":[["cd276bd4.4ec2d8","1fb23d1f.248fb3"]]},{"id":"cd276bd4.4ec2d8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1106.1826133728027,"y":936.203972756979,"z":"d5178f42.44976","wires":[["c9ac2f78.68a14"]]},{"id":"1fb23d1f.248fb3","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1109.1825408935547,"y":972.2040061355801,"z":"d5178f42.44976","wires":[[]]},{"id":"c9ac2f78.68a14","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name=\"error-code\" value=\"500\" />\n\t<parameter name=\"error-message\" value=\"'Error searching for l3-network with network-id =' + $tmp.l3-network.network-id + 'from AnAI.  Network should be created by MSO'\" />","comments":"","x":1258.2936973571777,"y":936.4262017608853,"z":"d5178f42.44976","wires":[]},{"id":"8417006f.508b2","type":"comment","name":"Verify the network exists in AAI, else throw error","info":"","comments":"","x":856.1826019287109,"y":892.2040490509244,"z":"d5178f42.44976","wires":[]},{"id":"fd2df853.9f51c8","type":"execute","name":"execute RestApiCallNode - Get network instance group by id","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.nig-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='DELETE' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-nig\" />\n\n","comments":"","outputs":1,"x":2543.5757904052734,"y":3081.1475110054016,"z":"d5178f42.44976","wires":[["b1af37b5.b16318","1d58b7d3.9f05e8"]]},{"id":"b1af37b5.b16318","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":2882.371627807617,"y":3044.455379009247,"z":"d5178f42.44976","wires":[["851e27ab.fc1778"]]},{"id":"851e27ab.fc1778","type":"block","name":"block: atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":3061.3716926574707,"y":3044.955325603485,"z":"d5178f42.44976","wires":[[]]},{"id":"7aa290b9.dbfb","type":"comment","name":"Delete network-instance-group from mdsal on rollback","info":"","comments":"","x":2518.979106903076,"y":3048.0269055366516,"z":"d5178f42.44976","wires":[]},{"id":"1d58b7d3.9f05e8","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2880.223400115967,"y":3124.5214619636536,"z":"d5178f42.44976","wires":[["64bdc280.770b8c"]]},{"id":"64bdc280.770b8c","type":"block","name":"block: atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":3060.2233505249023,"y":3125.188012599945,"z":"d5178f42.44976","wires":[[]]},{"id":"c535d1b3.3325f","type":"save","name":"save relationship: l3-network to instance group","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network:relationship-list\" \n\tkey=\"l3-network.network-id = $tmp.l3-network.network-id\" \n\tforce=\"true\" \n\tlocal-only=\"false\">\n\t<parameter name=\"relationship-list.relationship[0].related-to\" value=\"instance-group\" />\n\t<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/aai/v$/network/instance-groups/instance-group/'+ $tmp.network-instance-group-id`\" />\n","comments":"","outputs":1,"x":833.0040893554688,"y":2601.004062652588,"z":"d5178f42.44976","wires":[["3203a1dc.f1b18e","b974bb76.717a98"]]},{"id":"3203a1dc.f1b18e","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1118.077003479004,"y":2596.479751586914,"z":"d5178f42.44976","wires":[["e5a724d0.277648"]]},{"id":"e5a724d0.277648","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1305.969882965088,"y":2596.1158590316772,"z":"d5178f42.44976","wires":[["e6189e22.f13c9"]]},{"id":"e6189e22.f13c9","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'An error occurred while saving instance-group relationship for l3-network in AnAI where instance-group-id = ' + $tmp.network-instance-group-id`\"/>","comments":"","x":1519.069423675537,"y":2596.8657579421997,"z":"d5178f42.44976","wires":[]},{"id":"b974bb76.717a98","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1126.162940979004,"y":2639.1310234069824,"z":"d5178f42.44976","wires":[["e5a724d0.277648"]]},{"id":"750843e0.4ef3ac","type":"comment","name":"Save relationship to Network instance group","info":"","comments":"","x":825.0040893554688,"y":2566.004069328308,"z":"d5178f42.44976","wires":[]},{"id":"9695c264.9ae04","type":"set","name":"set object-path","xml":"<set>\n<parameter name='network-object-path'\n value=\"`$tmp.l3-network.self-link`\"/>\n \n","comments":"","x":749.0040817260742,"y":3179.004289627075,"z":"d5178f42.44976","wires":[]},{"id":"8576e473.d1f3e8","type":"set","name":"set networkId","xml":"<set>\n<parameter name='networkId' value='`$tmp.l3-network.network-id`' />\n","comments":"","x":745.4325790405273,"y":3135.2896909713745,"z":"d5178f42.44976","wires":[]},{"id":"48826944.8a8cc8","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name='' value='' />\n","comments":"","x":755.0040283203125,"y":3378.7184524536133,"z":"d5178f42.44976","wires":[]},{"id":"94083d5a.ebf56","type":"set","name":"set network-level-oper-status","xml":"<set>\n<parameter name='service-data.networks.network[$nidx].network-data.network-level-oper-status.order-status' value='PendingCreate' />\n<parameter name='service-data.networks.network[$nidx].network-data.network-level-oper-status.last-rpc-action' value='`$network-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.networks.network[$nidx].network-data.network-level-oper-status.last-action' value='`$network-topology-operation-input.request-information.request-action`' />\n","comments":"","x":790.2530822753906,"y":3225.5032529830933,"z":"d5178f42.44976","wires":[]},{"id":"8a263bc3.22e118","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1057.4002418518066,"y":2768.094113200903,"z":"d5178f42.44976","wires":[["8567ebd6.a38748"]]},{"id":"8567ebd6.a38748","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1237.2931213378906,"y":2767.730220645666,"z":"d5178f42.44976","wires":[["4fa520ad.fc33e"]]},{"id":"4fa520ad.fc33e","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'An error occurred while saving service-instance relationship for l3-network in AnAI where service-instance-id = ' + $network-topology-operation-input.service-information.service-instance-id`\"/>","comments":"","x":1475.3926887512207,"y":2767.4801433980465,"z":"d5178f42.44976","wires":[]},{"id":"3d5a9b10.7d0c54","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1065.13669374254,"y":2810.5746375819053,"z":"d5178f42.44976","wires":[["8567ebd6.a38748"]]},{"id":"43ee4152.fab5d","type":"save","name":"save relationship: service-instance","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network:relationship-list\" \n\tkey=\"l3-network.network-id = $tmp.l3-network.network-id\" >\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"service-instance\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"customer.global-customer-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$service-data.service-information.global-customer-id`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[1].relationship-key\" value=\"service-subscription.service-type\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[1].relationship-value\" value=\"`$service-data.service-information.subscription-service-type`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[2].relationship-key\" value=\"service-instance.service-instance-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[2].relationship-value\" value=\"`$service-data.service-information.service-instance-id`\" />","comments":"","outputs":1,"x":800.3790168762207,"y":2766.5036114156246,"z":"d5178f42.44976","wires":[["8a263bc3.22e118","3d5a9b10.7d0c54"]]},{"id":"307054cf.25730c","type":"set","name":"set network in service-data","xml":"<set>\n<parameter name=\"service-data.networks.network[$nidx].network-id\" value='`$tmp.l3-network.network-id`' />\n<parameter name=\"service-data.networks.network[$nidx].network-data.network-topology.\" value='$network-topology.' />\n<parameter name=\"service-data.networks.network_length\" value='`$nidx_len`' />\n\n","comments":"","x":786.7539253234863,"y":3054.7535923421383,"z":"d5178f42.44976","wires":[]},{"id":"1618d258.7486ae","type":"set","name":"set network-topology-identifier-structure in service-data","xml":"<set>\n<parameter name='network-topology.network-topology-identifier-structure.' value='`$tmp.l3-network.`' />\n<parameter name='network-topology.tenant' value='`$network-topology-operation-input.network-request-input.tenant`' />\n<parameter name='network-topology.onap-model-information.' value='`$network-topology-operation-input.network-information.onap-model-information.`' />\n<parameter name='network-topology.network-parameters.' value='`$network-topology-operation-input.network-request-input.network-parameters.`' />\n<parameter name='network-topology.aic-cloud-region' value='`$network-topology-operation-input.network-request-input.aic-cloud-region`' />","comments":"","x":870.50390625,"y":2947.6109828948975,"z":"d5178f42.44976","wires":[]},{"id":"b93d2eef.37f8c","type":"call","name":"call get-complex-resource-service-model","xml":"<call module='GENERIC-RESOURCE-API' rpc='get-complex-resource-service-model' mode='sync' >\n","comments":"","outputs":1,"x":833.57568359375,"y":1256.3110961914062,"z":"d5178f42.44976","wires":[[]]},{"id":"a7165e9f.1f2c4","type":"comment","name":"Get complex service model info","info":"","comments":"","x":796.8969650268555,"y":1181.6325550079346,"z":"d5178f42.44976","wires":[]},{"id":"e090256e.e635b8","type":"set","name":"set aaiapi.input.network-instance-group-id","xml":"<set>\n<parameter name='aaiapi.input.network-instance-group-id' value=\"`$tmp.l3-network.network-instance-group-id`\" />","comments":"","x":854.2896728515625,"y":1011.6324462890625,"z":"d5178f42.44976","wires":[]},{"id":"1868f533.5d5d1b","type":"switchNode","name":"switch nig.subnet-assignment-policy.subnet-use","xml":"<switch test='`$nig.subnet-assignment-policy.subnet-use`'>\n","comments":"","outputs":1,"x":853.7540588378906,"y":2008.0041007995605,"z":"d5178f42.44976","wires":[["80ea04d2.713458","bb4bfbdc.3ac068","5d5a651b.69c2fc"]]},{"id":"80ea04d2.713458","type":"other","name":"outcome NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":1188.7540283203125,"y":2010.004098892212,"z":"d5178f42.44976","wires":[["c40792bd.8000b"]]},{"id":"e259f887.453e58","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1395.0397911071777,"y":2082.5756874084473,"z":"d5178f42.44976","wires":[["da09529c.7bd81"]]},{"id":"bb4bfbdc.3ac068","type":"other","name":"outcome unique","xml":"<outcome value='unique'>\n","comments":"","outputs":1,"x":1191.7541580200195,"y":2046.0042152404785,"z":"d5178f42.44976","wires":[["e8c6568f.40eef8"]]},{"id":"5d5a651b.69c2fc","type":"other","name":"outcome shared","xml":"<outcome value='shared'>\n","comments":"","outputs":1,"x":1189.7540283203125,"y":2083.004098892212,"z":"d5178f42.44976","wires":[["e259f887.453e58"]]},{"id":"da09529c.7bd81","type":"switchNode","name":"switch first-network","xml":"<switch test='`$tmp.first-network`'>\n","comments":"","outputs":1,"x":1622.7540283203125,"y":2083.0041546821594,"z":"d5178f42.44976","wires":[["fab5e305.08848","a54c9af5.901b08"]]},{"id":"fab5e305.08848","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1864.754020690918,"y":1802.0040340423584,"z":"d5178f42.44976","wires":[["e8c6568f.40eef8"]]},{"id":"a54c9af5.901b08","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1885.7541704177856,"y":2639.0047483444214,"z":"d5178f42.44976","wires":[["5c068cfe.3f07a4"]]},{"id":"40a6453b.1fd08c","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"Subnet use not set\"/>","comments":"","x":1614.7540664672852,"y":2010.0044298171997,"z":"d5178f42.44976","wires":[]},{"id":"c1d9c0b7.72207","type":"switchNode","name":"switch tmp.nig-preexists","xml":"<switch test='`$tmp.nig-preexists`'>\n","comments":"","outputs":1,"x":1782.0039978027344,"y":3047.0039596557617,"z":"d5178f42.44976","wires":[["d00ae7b1.1e2958","b8eeae0.6645e5"]]},{"id":"d00ae7b1.1e2958","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1995.0040817260742,"y":3015.4327602386475,"z":"d5178f42.44976","wires":[["36213aaa.5381f6"]]},{"id":"b8eeae0.6645e5","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1994.004056930542,"y":3079.0040760040283,"z":"d5178f42.44976","wires":[["3ed49ae5.86c5a6"]]},{"id":"3ed49ae5.86c5a6","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2180.4326934814453,"y":3079.2900104522705,"z":"d5178f42.44976","wires":[["fd2df853.9f51c8"]]},{"id":"36213aaa.5381f6","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2177.7897987365723,"y":3013.8610706329346,"z":"d5178f42.44976","wires":[[]]},{"id":"c40792bd.8000b","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1383.5040283203125,"y":2011.004098892212,"z":"d5178f42.44976","wires":[["40a6453b.1fd08c","c1d9c0b7.72207"]]},{"id":"35159ac5.660f16","type":"comment","name":"Need to add more thorough rollback","info":"","comments":"","x":1789.1827850341797,"y":2985.0042428970337,"z":"d5178f42.44976","wires":[]},{"id":"f241bc6f.abe91","type":"call","name":"call naming-policy-generate-name","xml":"<call module='GENERIC-RESOURCE-API' rpc='naming-policy-generate-name' mode='sync' >\n","comments":"","outputs":1,"x":821.6469955444336,"y":1620.6043549178867,"z":"d5178f42.44976","wires":[[]]},{"id":"47106adb.c7b994","type":"set","name":"set parameters for generate-unique-name","xml":"<set>\n<parameter name='naming-policy-generate-name-input.policy-instance-name' value='`$get-complex-resource-service-model-output.network-naming-policy`' />\n<parameter name='naming-policy-generate-name-input.context-id' value='`$tmp.l3-network.network-id`' />\n<parameter name='naming-policy-generate-name-input.naming-type' value='NETWORK' />\n<parameter name='naming-policy-generate-name-input.action' value='ASSIGN' />\n<parameter name='naming-policy-generate-name-input.query-parameter' value='`$network-model.customization-uuid`' />\n\n\n","comments":"","x":842.3971710205078,"y":1583.6043979524402,"z":"d5178f42.44976","wires":[]},{"id":"fe4bedce.dccf4","type":"set","name":"set network name","xml":"<set>\n<parameter name='tmp.l3-network.network-name' value='`$naming-policy-generate-name-output.network-name`' />\n\n\n\n","comments":"","x":770.8970489501953,"y":1655.604353010538,"z":"d5178f42.44976","wires":[]},{"id":"49a4db31.f771e4","type":"comment","name":"Generate a name","info":"","comments":"","x":764.64697265625,"y":1543.6043673156528,"z":"d5178f42.44976","wires":[]},{"id":"36134ff2.81826","type":"set","name":"set tmp.network-topology","xml":"<set>\n<parameter name='network-topology.network-topology-identifier-structure.network-id' value=\"`$tmp.l3-network.network-id`\" />\n<parameter name='network-topology.network-topology-identifier-structure.network-name' value=\"`$tmp.l3-network.network-name`\" />\n<parameter name='network-topology.network-topology-identifier-structure.network-instance-group-id' value=\"`$tmp.l3-network.network-instance-group-id`\" />\n<parameter name='network-topology.network-topology-identifier-structure.network-type' value=\"`$tmp.l3-network.network-type`\" />\n<parameter name='network-topology.network-topology-identifier-structure.network-role' value=\"`$tmp.l3-network.network-role`\" />\n<parameter name='network-topology.network-topology-identifier-structure.network-technology' value=\"`$tmp.l3-network.network-technology`\" />\n<parameter name='network-topology.region-identifier.tenant' value=\"`$network-topology-operation-input.network-request-input.tenant`\" />\n<parameter name='network-topology.region-identifier.aic-cloud-region' value=\"`$network-topology-operation-input.network-request-input.aic-cloud-region`\" />\n<parameter name='network-topology.region-identifier.aic-clli' value=\"`$network-topology-operation-input.network-request-input.aic-clli`\" />\n<parameter name='network-topology.onap-model-information.' value=\"`$network-topology-operation-input.network-information.onap-model-information.`\" />\n<parameter name='network-topology.network-parameters.' value=\"`$network-topology-operation-input.network-request-input.network-input-parameters.`\" />\n<parameter name='nig.network.network-id' value=\"`$tmp.l3-network.network-id`\" />","comments":"","x":795.3969892263412,"y":1690.604379713419,"z":"d5178f42.44976","wires":[]},{"id":"58f3035b.c67d9c","type":"set","name":"set: nig identifier data","xml":"<set>\n\t<parameter name=\"nig.network-instance-group-id\" value=\"`$tmp.l3-network.network-instance-group-id`\"/>\n\t<parameter name=\"nig.network-instance-group-function\" value=\"`$aaiapi.output.collection-function`\"/>\n\t<parameter name=\"nig.service-instance-id\" value=\"`$network-topology-operation-input.service-information.service-instance-id`\"/>\n","comments":"","x":770.9164733886719,"y":1301.3838511108188,"z":"d5178f42.44976","wires":[]},{"id":"c8f94428.c0f5e8","type":"set","name":"set network-id","xml":"<set>\n<parameter name='nig.networks.network[$ngnidx].network-id' value=\"`$tmp.l3-network.network-id`\" />","comments":"","x":751.8531799316406,"y":1332.3834181426791,"z":"d5178f42.44976","wires":[]},{"id":"a3dcfb29.be3be8","type":"switchNode","name":"switch tmp.nidx ","xml":"<switch test=\"`$tmp.nidx`\">\n\n","comments":"","outputs":1,"x":892.2912139892578,"y":117.14844608306885,"z":"d5178f42.44976","wires":[["30c9e880.3ebc78","7464fb80.2dd3b4"]]},{"id":"30c9e880.3ebc78","type":"outcome","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":1118.5768585205078,"y":117.14839267730713,"z":"d5178f42.44976","wires":[["9337c637.20ec98"]]},{"id":"9337c637.20ec98","type":"switchNode","name":"switch service-data.networks_length","xml":"<switch test='`$service-data.networks.network_length`'>\n","comments":"","outputs":1,"x":1367.8029518127441,"y":118.33930969238281,"z":"d5178f42.44976","wires":[["b0241fa7.69347","6cbf8a0c.d761d4"]]},{"id":"b0241fa7.69347","type":"other","name":"Null","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":1665.898292541504,"y":102.14861726760864,"z":"d5178f42.44976","wires":[["173ed7db.4f7aa8"]]},{"id":"173ed7db.4f7aa8","type":"set","name":"set nidx","xml":"<set>\n<parameter name='nidx' value='0' />\n<parameter name='nidx_len' value='1'/>\n","comments":"","x":1836.6127471923828,"y":102.7200288772583,"z":"d5178f42.44976","wires":[]},{"id":"6cbf8a0c.d761d4","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1663.7554368972778,"y":142.86289072036743,"z":"d5178f42.44976","wires":[["254ad291.d12d8e"]]},{"id":"254ad291.d12d8e","type":"set","name":"set nidx","xml":"<set>\n<parameter name='nidx' value='`$service-data.networks.network_length`' />\n<parameter name='nidx_len' value='`$service-data.networks.network_length + 1`' />\n","comments":"","x":1836.3268671035767,"y":143.72009134292603,"z":"d5178f42.44976","wires":[]},{"id":"7464fb80.2dd3b4","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1120.0054931640625,"y":155.71986484527588,"z":"d5178f42.44976","wires":[["5b261be0.07e9c4"]]},{"id":"5b261be0.07e9c4","type":"set","name":"set nidx","xml":"<set>\n<parameter name='nidx' value='`$tmp.nidx`' />\n<parameter name='nidx_len' value='`$service-data.networks.network_length`' />\n","comments":"","x":1282.8626174926758,"y":155.71989059448242,"z":"d5178f42.44976","wires":[]},{"id":"44bed9f5.f8a198","type":"switchNode","name":"switch tmp.ngidx ","xml":"<switch test=\"`$tmp.ngidx`\">\n\n","comments":"","outputs":1,"x":892.8627777099609,"y":204.29132843017578,"z":"d5178f42.44976","wires":[["d6e4ec1a.e6e93","8751a27d.a5675"]]},{"id":"d6e4ec1a.e6e93","type":"outcome","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":1134.291275024414,"y":202.86267757415771,"z":"d5178f42.44976","wires":[["b03031bc.a8721"]]},{"id":"b03031bc.a8721","type":"switchNode","name":"switch service-data.network-instance-groups.network-instance-group_len","xml":"<switch test='`$service-data.network-instance-groups.network-instance-group_len`'>\n","comments":"","outputs":1,"x":1499.231704711914,"y":204.05360412597656,"z":"d5178f42.44976","wires":[["f57cf34f.7619f","d6ea05bc.20b178"]]},{"id":"f57cf34f.7619f","type":"other","name":"Null","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":1913.7556266784668,"y":204.29148191213608,"z":"d5178f42.44976","wires":[["b0c63751.bc3848"]]},{"id":"b0c63751.bc3848","type":"set","name":"set ngidx","xml":"<set>\n<parameter name='ngidx' value='0' />\n<parameter name='ngidx_len' value='1'/>\n<parameter name=\"ngnidx\" value='0' />\n<parameter name=\"nig.preexists\" value=\"false\"/>\n<parameter name=\"nig.first-network\" value=\"true\"/>\n<parameter name=\"nig.networks.network_len\" value=\"1\" />\n\n","comments":"","x":2086.612817764282,"y":202.14860528707504,"z":"d5178f42.44976","wires":[]},{"id":"d6ea05bc.20b178","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1912.3271217346191,"y":238.57717990875244,"z":"d5178f42.44976","wires":[["9b5fbee6.21443"]]},{"id":"9b5fbee6.21443","type":"set","name":"set ngidx","xml":"<set>\n<parameter name='ngidx' value='`$service-data.network-instance-groups.network-instance-group_length`' />\n<parameter name='ngidx_len' value='`$service-data.network-instance-groups.network-instance-group_length + 1`' />\n<parameter name=\"nig.preexists\" value=\"false\"/>\n<parameter name=\"ngnidx\" value='0' />\n<parameter name=\"nig.first-network\" value=\"true\"/>\n<parameter name=\"nig.networks.network_len\" value=\"1\" />","comments":"","x":2088.041379928589,"y":237.72010797262192,"z":"d5178f42.44976","wires":[]},{"id":"8751a27d.a5675","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1135.7199096679688,"y":241.43414974212646,"z":"d5178f42.44976","wires":[["8415c5ef.359e28"]]},{"id":"16fb0168.14aadf","type":"set","name":"set ngidx","xml":"<set>\n<parameter name='ngidx' value='`$tmp.ngidx`' />\n<parameter name='ngidx_len' value='`$service-data.network-instance-groups.network-instance-group_length`' />\n<parameter name=\"nig.preexists\" value=\"false\"/>","comments":"","x":1504.2913513183594,"y":240.00561666488647,"z":"d5178f42.44976","wires":[]},{"id":"8415c5ef.359e28","type":"block","name":"block: atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":1308.5770263671875,"y":241.4341583251953,"z":"d5178f42.44976","wires":[["16fb0168.14aadf","ce6e4cc2.462f2"]]},{"id":"ce6e4cc2.462f2","type":"switchNode","name":"switch networks.network_len","xml":"<switch test='`$ctx.network-instance-group-data.networks.network_len`'>\n","comments":"","outputs":1,"x":1574.2918243408203,"y":275.71987533569336,"z":"d5178f42.44976","wires":[["4e750736.532bf8","d95056d5.924ce8","c969201f.52f67"]]},{"id":"4e750736.532bf8","type":"other","name":"0","xml":"<outcome value='0'>\n","comments":"","outputs":1,"x":1831.1484718322754,"y":308.8269855976105,"z":"d5178f42.44976","wires":[["c10f69b8.9aebd8"]]},{"id":"d95056d5.924ce8","type":"other","name":"null","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":1829.148582458496,"y":277.8270561695099,"z":"d5178f42.44976","wires":[["c10f69b8.9aebd8"]]},{"id":"c10f69b8.9aebd8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2026.1744999355742,"y":308.38727392090686,"z":"d5178f42.44976","wires":[["763b73e5.e9fa9c"]]},{"id":"763b73e5.e9fa9c","type":"set","name":"set: first-network = true","xml":"<set>\n<parameter name=\"nig.first-network\" value=\"true\" />\n<parameter name=\"ngnidx\" value=\"0\" />\n<parameter name=\"nig.networks.network_len\" value=\"1\" />","comments":"","x":2258.6746372646758,"y":307.1373034848107,"z":"d5178f42.44976","wires":[]},{"id":"c969201f.52f67","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1831.8184700012207,"y":344.0778257846832,"z":"d5178f42.44976","wires":[["4933902d.618d4"]]},{"id":"4933902d.618d4","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2027.711441040039,"y":344.07779335975647,"z":"d5178f42.44976","wires":[["cdb6a15a.3212a","798af161.c715b"]]},{"id":"cdb6a15a.3212a","type":"set","name":"set: first-network = false","xml":"<set>\n<parameter name=\"nig.first-network\" value=\"false\" />\n<parameter name=\"ngnidx\" value=\"`$ctx.network-instance-group-data.networks.network_length`\" />\n<parameter name=\"nig.networks.network_len\" value=\"`$ctx.network-instance-group-data.networks.network_length + 1`\" />\n<parameter name=\"nig.\" value=\"`$ctx.network-instance-group-data.`\" />","comments":"","x":2259.2117652893066,"y":375.8278331756592,"z":"d5178f42.44976","wires":[]},{"id":"798af161.c715b","type":"set","name":"set: nig data","xml":"<set>\n<parameter name=\"nig.\" value=\"`$ctx.network-instance-group-data.`\" />","comments":"","x":2227.503879547119,"y":342.0039052963257,"z":"d5178f42.44976","wires":[]},{"id":"5c068cfe.3f07a4","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2097.004189491272,"y":2639.004349708557,"z":"d5178f42.44976","wires":[["48c61180.635eb"]]},{"id":"48c61180.635eb","type":"switchNode","name":"switch ngnidx","xml":"<switch test='`$ngnidx`'>\n","comments":"","outputs":1,"x":2291.0042581558228,"y":2639.004288673401,"z":"d5178f42.44976","wires":[["aa783e80.a6c83","554f9fef.e514d"]]},{"id":"aa783e80.a6c83","type":"outcome","name":"0","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":2482.004204750061,"y":2613.004267692566,"z":"d5178f42.44976","wires":[["2a71e575.36750a"]]},{"id":"554f9fef.e514d","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2483.004288673401,"y":2644.004319190979,"z":"d5178f42.44976","wires":[[]]},{"id":"2a71e575.36750a","type":"for","name":"for 0..subnet_length","xml":"<for index='sidx' start='0' end='`$tmp.l3-network.subnet_length`' >\n","comments":"","outputs":1,"x":2677.254292488098,"y":2612.0042600631714,"z":"d5178f42.44976","wires":[["46adadcf.b10ea4"]]},{"id":"46adadcf.b10ea4","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2877.396858215332,"y":2616.8931579589844,"z":"d5178f42.44976","wires":[["fae75c2d.25c5c","896df025.a1fea"]]},{"id":"fae75c2d.25c5c","type":"set","name":"set: tmp.subnet-id","xml":"<set>\n<parameter name=\"tmp.subnet-id\" value=\"`$tmp.l3-network.subnet[$sidx].subnet-id`\"/>\n\t","comments":"","x":3099.1748046875,"y":2585.7183837890625,"z":"d5178f42.44976","wires":[]},{"id":"896df025.a1fea","type":"switchNode","name":"switch dhcp-enabled","xml":"<switch test='`$tmp.l3-network.subnet[$sidx].dhcp-enabled`'>\n","comments":"","outputs":1,"x":3106.80952835083,"y":2622.015778541565,"z":"d5178f42.44976","wires":[[]]},{"id":"e8c6568f.40eef8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2041.0041122436523,"y":1624.0039863586426,"z":"d5178f42.44976","wires":[["e65e043c.0d83c8","9ab51d6.254d9e","727e503e.e99e1","76567230.ae29cc","2c47409f.cb9c7","1451a72d.c96e71","6d06e17a.7f1a2","95e4e3b2.775858"]]},{"id":"e65e043c.0d83c8","type":"set","name":"set: input for process-generic-eipam-pools","xml":"<set>\n<parameter name=\"tmp.skip-first-level\" value=\"Y\"/>\n<parameter name=\"tmp.allocate-subnet-flag\" value=\"Y\"/>\n<parameter name=\"generate-FQPN-input.aic-cloud-region\" value=\"`$aai.cloud-region.cloud-region-id`\" />\n<parameter name=\"generate-FQPN-input.network-name\" value=\"`$network-topology.network-topology-identifier-structure.network-name`\" />\n<parameter name=\"generate-FQPN-input.network-role\" value=\"`$network-topology.network-topology-identifier-structure.network-role`\" />\n<parameter name=\"generate-FQPN-input.network-collection\" value=\"`$aaiapi.output.collection-name`\" />\n<parameter name=\"generate-FQPN-input.network-id\" value=\"`$network-topology.network-topology-identifier-structure.network-id`\" />\n<parameter name=\"tmp.network-id\" value=\"`network-topology.network-topology-identifier-structure.network-id`\" />\n<parameter name=\"tmp.network-instance-group-id\" value=\"`$network-topology.network-topology-identifier-structure.network-instance-group-id`\" />\n\n<!-- the following are not set by calling dg\ngenerate-FQPN-input.subnet-role\ngenerate-FQPN-input.zone\ngenerate-FQPN-input.equipment\n-->\n<!-- network model is already in contect memory -->\n<!-- aai.cloud-region.cloud-region-id  is already in contect memory -->\n\n\t","comments":"","x":2347.2537841796875,"y":1606.0040283203125,"z":"d5178f42.44976","wires":[]},{"id":"9ab51d6.254d9e","type":"switchNode","name":"switch $network-model.eipam-v4-address-plan is not null","xml":"<switch test=\"`$network-model.eipam-v4-address-plan != ''`\">\n","comments":"","outputs":1,"x":2394.25390625,"y":1723.00390625,"z":"d5178f42.44976","wires":[["c9d4cba4.24fff8"]]},{"id":"42389da4.7eb2c4","type":"comment","name":"Process v4 plan","info":"","comments":"","x":2260.254005432129,"y":1691.0040283203125,"z":"d5178f42.44976","wires":[]},{"id":"c9d4cba4.24fff8","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2701.253890991211,"y":1691.0039176940918,"z":"d5178f42.44976","wires":[["1e20a4e2.74b9eb"]]},{"id":"1e20a4e2.74b9eb","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2865.2539138793945,"y":1691.0039367675781,"z":"d5178f42.44976","wires":[["8a474f48.9398f","11cb7113.5402d7"]]},{"id":"727e503e.e99e1","type":"switchNode","name":"switch $network-model.eipam-v6-address-plan is not null","xml":"<switch test=\"`$network-model.eipam-v6-address-plan != ''`\">\n","comments":"","outputs":1,"x":2394.2537841796875,"y":1816.00390625,"z":"d5178f42.44976","wires":[["e81185af.c04448"]]},{"id":"2765b6a2.a89dfa","type":"comment","name":"Process v6 plan","info":"","comments":"","x":2265.2538452148438,"y":1784.0040893554688,"z":"d5178f42.44976","wires":[]},{"id":"e81185af.c04448","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2709.253776550293,"y":1816.0038986206055,"z":"d5178f42.44976","wires":[["6635ad54.167cd4"]]},{"id":"6635ad54.167cd4","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2873.2537994384766,"y":1816.0039176940918,"z":"d5178f42.44976","wires":[["3e402883.aa4e28","31489f02.5d1d88"]]},{"id":"8a474f48.9398f","type":"set","name":"set: v4plan in mdsal","xml":"<set>\n<parameter name=\"network-topology.network-identifier-structure.eipam-v4-address-plan\" value=\"`$network-model.eipam-v4-address-plan`\" />\n\t","comments":"","x":3061.254035949707,"y":1691.0039672851562,"z":"d5178f42.44976","wires":[]},{"id":"3e402883.aa4e28","type":"set","name":"set: v6plan in mdsal","xml":"<set>\n<parameter name=\"network-topology.network-identifier-structure.eipam-v6-address-plan\" value=\"`$network-model.eipam-v4-address-plan`\" />\n\t","comments":"","x":3076.2538146972656,"y":1815.0039367675781,"z":"d5178f42.44976","wires":[]},{"id":"92dee517.041028","type":"set","name":"set tmp.network-topology","xml":"<set>\n<parameter name='network-topology.region-identifier.aic-clli' value=\"`$aaiapi.output.aic-clli`\" />\n","comments":"","x":775.25390625,"y":1853.0040283203125,"z":"d5178f42.44976","wires":[]},{"id":"76567230.ae29cc","type":"call","name":"call process-generic-eipam-pools","xml":"<call module='GENERIC-RESOURCE-API' rpc='process-generic-eipam-pools' mode='sync' >\n","comments":"","outputs":1,"x":2314.8831787109375,"y":1640.88330078125,"z":"d5178f42.44976","wires":[["3ee93bff.44a3fc"]]},{"id":"3ee93bff.44a3fc","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2543.41650390625,"y":1640.4832763671875,"z":"d5178f42.44976","wires":[["f0d7d581.591998"]]},{"id":"f0d7d581.591998","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"`'Error from process-generic-eipam-pools, ' + $error-message`\" />\n","comments":"","x":2702.1664848327637,"y":1640.4832725524902,"z":"d5178f42.44976","wires":[]},{"id":"11cb7113.5402d7","type":"for","name":"for 0..CreatePoolPlans_length","xml":"<for silentFailure='true' index='eidx' start='0' end='`$eipam-ip-block.createPoolResponse.CreatePoolPlans_length`' >\n","comments":"","outputs":1,"x":3093.88330078125,"y":1735.88330078125,"z":"d5178f42.44976","wires":[["32ce7747.c70768"]]},{"id":"32ce7747.c70768","type":"switchNode","name":"switch PlanName == network-model.eipam-v4-address-plan","xml":"<switch test=\"`$eipam-ip-block.createPoolResponse.CreatePoolPlans[$eidx].CreatePoolPlan.PlanName == $network-model.eipam-v4-address-plan`\">\n","comments":"","outputs":1,"x":3476.88330078125,"y":1735.88330078125,"z":"d5178f42.44976","wires":[["73515ea5.55cd5"]]},{"id":"31489f02.5d1d88","type":"for","name":"for 0..CreatePoolPlans_length","xml":"<for silentFailure='true' index='eidx' start='0' end='`$eipam-ip-block.createPoolResponse.CreatePoolPlans_length`' >\n","comments":"","outputs":1,"x":3111.88330078125,"y":1853.88330078125,"z":"d5178f42.44976","wires":[["39f88f1c.91ea8"]]},{"id":"39f88f1c.91ea8","type":"switchNode","name":"switch PlanName == network-model.eipam-v6-address-plan","xml":"<switch test=\"`$eipam-ip-block.createPoolResponse.CreatePoolPlans[$eidx].CreatePoolPlan.PlanName == $network-model.eipam-v6-address-plan`\">\n","comments":"","outputs":1,"x":3502.88330078125,"y":1853.88330078125,"z":"d5178f42.44976","wires":[["cff6d3ae.f1aa3"]]},{"id":"73515ea5.55cd5","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":3813.883331298828,"y":1735.8833312988281,"z":"d5178f42.44976","wires":[["b96644be.0dbc98"]]},{"id":"cff6d3ae.f1aa3","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":3827.88330078125,"y":1853.4832763671875,"z":"d5178f42.44976","wires":[["746695da.4b9b9c"]]},{"id":"b96644be.0dbc98","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":3973.316650390625,"y":1736.0833740234375,"z":"d5178f42.44976","wires":[["5cbea0a0.58604"]]},{"id":"746695da.4b9b9c","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":3984.316650390625,"y":1853.0833740234375,"z":"d5178f42.44976","wires":[["31f3e12f.a943de"]]},{"id":"5cbea0a0.58604","type":"set","name":"set: v4 ip info","xml":"<set>\n<parameter name=\"v4.ip-prefix\" value=\"`$eipam-ip-block.createPoolResponse.CreatePoolPlans[$eidx].CreatePoolPlan.IPDataBlock.IPAddress`\"/>\n<parameter name=\"v4.mask\" value=\"`$eipam-ip-block.createPoolResponse.CreatePoolPlans[$eidx].CreatePoolPlan.IPDataBlock.Mask`\"/>\n<parameter name=\"v4.entity-id\" value=\"`$eipam-ip-block.createPoolResponse.CreatePoolPlans[$eidx].CreatePoolPlan.IPDataBlock.IpamPoolAllocId`\"/>","comments":"","x":4164.2666015625,"y":1736.0833740234375,"z":"d5178f42.44976","wires":[]},{"id":"31f3e12f.a943de","type":"set","name":"set: v6 ip info","xml":"<set>\n<parameter name=\"v6.ip-prefix\" value=\"`$eipam-ip-block.createPoolResponse.CreatePoolPlans[$eidx].CreatePoolPlan.IPDataBlock.IPAddress`\"/>\n<parameter name=\"v6.mask\" value=\"`$eipam-ip-block.createPoolResponse.CreatePoolPlans[$eidx].CreatePoolPlan.IPDataBlock.Mask`\"/>\n<parameter name=\"v6.entity-id\" value=\"`$eipam-ip-block.createPoolResponse.CreatePoolPlans[$eidx].CreatePoolPlan.IPDataBlock.IpamPoolAllocId`\"/>","comments":"","x":4177.88330078125,"y":1853.0833740234375,"z":"d5178f42.44976","wires":[]},{"id":"2c47409f.cb9c7","type":"call","name":"call GENERIC-RESOURCE-API:create-l3-subnet","xml":"<call module='GENERIC-RESOURCE-API' rpc='create-l3-subnet' mode='sync' >\n","comments":"tmp.level should be set to 1","outputs":1,"x":2373.0864181518555,"y":1868.0233001708984,"z":"d5178f42.44976","wires":[[]]},{"id":"889334d4.ee512","type":"save","name":"save AnAI - l3-network","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network\" \n\t\tkey=\"l3-network.network-id = $tmp.l3-network.network-id\" >\n<!-- Create l3-network object -->\n<parameter name=\"network-id\" value=\"`$tmp.l3-network.network-id`\" />\n<parameter name=\"network-name\" value=\"`$tmp.l3-network.network-name`\" />\n<parameter name=\"network-type\" value=\"`$network-model.network-type`\" />\n<parameter name=\"network-role\" value=\"`$network-model.network-role`\" />\n<parameter name=\"network-technology\" value=\"`$network-model.network-technology`\" />\n<parameter name=\"is-bound-to-vpn\" value=\"`$tmp.l3-network.is-bound-to-vpn-boolean`\" />\n<parameter name=\"tenant-id\" value=\"`$network-topology-operation-input.network-request-information.tenant`\" />\n<parameter name=\"model-invariant-id\" value=\"`$network-model.invariant_uuid`\" />\n<parameter name=\"model-version\" value=\"`$network-model.version`\" />\n<parameter name=\"model-customization-id\" value=\"`$network-model.customization-id`\" />\n<parameter name=\"physical-network-name\" value=\"`$network-model.physical-network-name`\" />\n<parameter name=\"is-provider-network\" value=\"`$tmp.l3-network.is-provider-network-boolean`\" />\n<parameter name=\"is-shared-network\" value=\"`$tmp.l3-network.is-shared-network-boolean`\" />\n<parameter name=\"is-external-network\" value=\"`$tmp.l3-network.is-external-network-boolean`\" />\n<parameter name=\"selflink\" value=\"`$tmp.l3-network.self-link`\" />\n<parameter name=\"service-id\" value=\"`$tmp.l3-network.service-id`\" />\n<parameter name=\"operational-status\" value=\"out-of-service-path\" />\n\n","comments":"","outputs":1,"x":2659.050048828125,"y":1966.2833251953125,"z":"d5178f42.44976","wires":[["fd2dffb4.626d88","166d7fb.02683"]]},{"id":"bc8ed07.0e83cb","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Failed to save l3-network in AAI for network-id = ' + $tmp.l3-network.network-id`\" />\n","comments":"","x":3148.7292909622192,"y":1931.5768394470215,"z":"d5178f42.44976","wires":[]},{"id":"fd2dffb4.626d88","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2902.1575317382812,"y":1931.3424072265625,"z":"d5178f42.44976","wires":[["bc8ed07.0e83cb"]]},{"id":"6d06e17a.7f1a2","type":"for","name":"for 0..subnet_length","xml":"<for index='sidx' start='0' end='`$tmp.l3-network.subnet_length`' >\n","comments":"","outputs":1,"x":2277.1418199539185,"y":2072.342499732971,"z":"d5178f42.44976","wires":[["b25f750f.5ab41"]]},{"id":"b25f750f.5ab41","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2504.2845001220703,"y":2071.231451034546,"z":"d5178f42.44976","wires":[["d4bb25ae.3ce62","c577661b.70d328","b6bec758.f11a5","bedb778a.035b4"]]},{"id":"166d7fb.02683","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":2907.9669799804688,"y":1959.8187255859375,"z":"d5178f42.44976","wires":[["bc8ed07.0e83cb"]]},{"id":"d4bb25ae.3ce62","type":"set","name":"set: tmp.subnet-id","xml":"<set>\n<parameter name=\"tmp.subnet-id\" value=\"`$tmp.l3-network.subnet[$sidx].subnet-id`\"/>\n\t","comments":"","x":2726.0624465942383,"y":2040.056676864624,"z":"d5178f42.44976","wires":[]},{"id":"c577661b.70d328","type":"switchNode","name":"switch dhcp-enabled","xml":"<switch test='`$tmp.l3-network.subnet[$sidx].dhcp-enabled`'>\n","comments":"","outputs":1,"x":2733.6971702575684,"y":2076.3540716171265,"z":"d5178f42.44976","wires":[["50789132.4385b8","615683d.86d5bfc"]]},{"id":"615683d.86d5bfc","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2969.8399658203125,"y":2006.2111206054688,"z":"d5178f42.44976","wires":[["282d91de.f05ee6"]]},{"id":"50789132.4385b8","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":2965.6971702575684,"y":2088.354193687439,"z":"d5178f42.44976","wires":[["6ee6838a.ca20ac"]]},{"id":"282d91de.f05ee6","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3160.7283935546875,"y":2006.4334716796875,"z":"d5178f42.44976","wires":[["7c2c5c81.31cfa4"]]},{"id":"6ee6838a.ca20ac","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3158.5858421325684,"y":2092.5765447616577,"z":"d5178f42.44976","wires":[["506e8049.8f6fc8"]]},{"id":"7c2c5c81.31cfa4","type":"switchNode","name":"switch gateway-address","xml":"<switch test='`$tmp.l3-network.subnet[$sidx].gateway-address`'>\n","comments":"","outputs":1,"x":3380.691680908203,"y":2006.7656421661377,"z":"d5178f42.44976","wires":[["72eb0aff.498254","b992c40a.e3fc88"]]},{"id":"506e8049.8f6fc8","type":"switchNode","name":"switch gateway-address","xml":"<switch test='`$tmp.l3-network.subnet[$sidx].gateway-address`'>\n","comments":"","outputs":1,"x":3389.977409362793,"y":2091.480155944824,"z":"d5178f42.44976","wires":[["f9389512.87fe1","d915319.95e925"]]},{"id":"1451a72d.c96e71","type":"switchNode","name":"switch service-id","xml":"<switch test='`$tmp.l3-network.service-id`'>\n","comments":"","outputs":1,"x":2268.9296875,"y":1952.6705322265625,"z":"d5178f42.44976","wires":[["b6d98b6a.61fe58","3902684f.6009f8"]]},{"id":"b6d98b6a.61fe58","type":"outcome","name":"outcome NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":2457.9296875,"y":1931.6705322265625,"z":"d5178f42.44976","wires":[["54a47008.56e48"]]},{"id":"3902684f.6009f8","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2432.9296875,"y":1966.6705322265625,"z":"d5178f42.44976","wires":[["889334d4.ee512"]]},{"id":"54a47008.56e48","type":"save","name":"save AnAI - l3-network","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network\" \n\t\tkey=\"l3-network.network-id = $tmp.l3-network.network-id\" >\n<!-- Create l3-network object -->\n<parameter name=\"network-id\" value=\"`$tmp.l3-network.network-id`\" />\n<parameter name=\"network-name\" value=\"`$tmp.l3-network.network-name`\" />\n<parameter name=\"network-type\" value=\"`$network-model.network-type`\" />\n<parameter name=\"network-role\" value=\"`$network-model.network-role`\" />\n<parameter name=\"network-technology\" value=\"`$network-model.network-technology`\" />\n<parameter name=\"is-bound-to-vpn\" value=\"`$tmp.l3-network.is-bound-to-vpn-boolean`\" />\n<parameter name=\"tenant-id\" value=\"`$network-topology-operation-input.network-request-information.tenant`\" />\n<parameter name=\"model-invariant-id\" value=\"`$network-model.invariant_uuid`\" />\n<parameter name=\"model-version\" value=\"`$network-model.version`\" />\n<parameter name=\"model-customization-id\" value=\"`$network-model.customization-id`\" />\n<parameter name=\"physical-network-name\" value=\"`$network-model.physical-network-name`\" />\n<parameter name=\"is-provider-network\" value=\"`$tmp.l3-network.is-provider-network-boolean`\" />\n<parameter name=\"is-shared-network\" value=\"`$tmp.l3-network.is-shared-network-boolean`\" />\n<parameter name=\"is-external-network\" value=\"`$tmp.l3-network.is-external-network-boolean`\" />\n<parameter name=\"selflink\" value=\"`$tmp.l3-network.self-link`\" />\n<parameter name=\"operational-status\" value=\"out-of-service-path\" />","comments":"","outputs":1,"x":2664.9296875,"y":1931.6705322265625,"z":"d5178f42.44976","wires":[["fd2dffb4.626d88","166d7fb.02683"]]},{"id":"352b0634.a770ea","type":"set","name":"set tmp.l3-network","xml":"<set>\n<parameter name='tmp.l3-network.network-type' value=\"`$network-model.network-type`\" />\n<parameter name='tmp.l3-network.network-role' value=\"`$network-model.network-role`\" />\n<parameter name='tmp.l3-network.network-technology' value=\"`$network-model.network-technology`\" />\n<parameter name='tmp.l3-network.is-bound-to-vpn' value=\"`$network-model.is-bound-to-vpn`\" />\n<parameter name='tmp.l3-network.orchestration-status' value=\"PendingCreate\" />\n<parameter name='tmp.l3-network.model-invariant-id' value=\"`$network-topology-operation-input.network-information.onap-model-information.model-invariant-uuid`\" />\n<parameter name='tmp.l3-network.model-version-id' value=\"`$network-topology-operation-input.network-information.onap-model-information.model-version`\" />\n<parameter name='tmp.l3-network.model-customization-id' value=\"`$network-topology-operation-input.network-information.onap-model-information.model-customization-uuid`\" />\n<parameter name='tmp.l3-network.is-provider-network' value=\"`$network-model.is-provider-network`\" />\n<parameter name='tmp.l3-network.is-shared-network' value=\"`$network-model.is-shared-network`\" />\n<parameter name='tmp.l3-network.is-external-network' value=\"`$network-model.is-external-network`\" />\n<parameter name='tmp.l3-network.eipam-v6-address-plan' value=\"`$network-model.eipam-v6-address-plan`\" />\n<parameter name='tmp.l3-network.eipam-v4-address-plan' value=\"`$network-model.eipam-v4-address-plan`\" />\n<parameter name='tmp.l3-network.service-id' value=\"`$service-data.service-information.service-id`\" />\n<parameter name='tmp.l3-network.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $network-topology-operation-input.service-information.service-instance-id\n + '/service-data/networks/network/'\n + $tmp.l3-network.network-id\n + '/network-data/network-topology/'` \" />\n","comments":"","x":886.88330078125,"y":451.4833068847656,"z":"d5178f42.44976","wires":[]},{"id":"c252ed05.9b99f","type":"set","name":"set network instance group in service-data","xml":"<set>\n<parameter name=\"service-data.network-instance-groups.network-instance-group[$ngidx].\" value='`$nig.`' />\n\n\n","comments":"","x":828.88330078125,"y":2999.4833984375,"z":"d5178f42.44976","wires":[]},{"id":"c0d1166f.f33bd","type":"switchNode","name":"switch network--model.is-provider-network","xml":"<switch test='`$network-model.is-provider-network`'>\n","comments":"","outputs":1,"x":943.6000061035156,"y":517.8833475112915,"z":"d5178f42.44976","wires":[["2d70e649.07ae42","3835b478.0b1234"]]},{"id":"2d70e649.07ae42","type":"other","name":"outcome Y","xml":"<outcome value='Y'>\n","comments":"","outputs":1,"x":1248.7431564331055,"y":497.7087926864624,"z":"d5178f42.44976","wires":[["9294abcc.7f7ec8"]]},{"id":"9294abcc.7f7ec8","type":"set","name":"set tmp.l3-network.physical-network-name","xml":"<set>\n<parameter name='tmp.l3-network.physical-network-name' value=\"`$network-model.physical-network-name`\" />\n<parameter name='tmp.l3-network.is-provider-network-boolean' value='true' />","comments":"","x":1516.7430114746094,"y":494.708758354187,"z":"d5178f42.44976","wires":[]},{"id":"3835b478.0b1234","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1236.1082153320312,"y":528.5818138122559,"z":"d5178f42.44976","wires":[["4cb8c1ac.228e38"]]},{"id":"4cb8c1ac.228e38","type":"set","name":"set tmp.l3-network.physical-network-name","xml":"<set>\n<parameter name='tmp.l3-network.physical-network-name' value=\"\" />\n<parameter name='tmp.l3-network.is-provider-network-boolean' value='false' />","comments":"","x":1520.394172668457,"y":527.153244972229,"z":"d5178f42.44976","wires":[]},{"id":"3e6da276.1b9876","type":"switchNode","name":"switch network--model.is-shared-network","xml":"<switch test='`$network-model.is-shared-network`'>\n","comments":"","outputs":1,"x":941.2665252685547,"y":563.5181550979614,"z":"d5178f42.44976","wires":[["9f3ffa9d.8179c","76801177.35bc58"]]},{"id":"9f3ffa9d.8179c","type":"other","name":"outcome Y","xml":"<outcome value='Y'>\n","comments":"","outputs":1,"x":1246.885726928711,"y":563.58176612854,"z":"d5178f42.44976","wires":[["26f53153.826cbe"]]},{"id":"26f53153.826cbe","type":"set","name":"set tmp.l3-network.is-shared-network-boolean","xml":"<set>\n<parameter name='tmp.l3-network.is-shared-network-boolean' value='true' />","comments":"","x":1539.1714401245117,"y":563.5816135406494,"z":"d5178f42.44976","wires":[]},{"id":"76801177.35bc58","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1235.6797523498535,"y":598.8832731246948,"z":"d5178f42.44976","wires":[["f9000a6c.baff6"]]},{"id":"f9000a6c.baff6","type":"set","name":"set tmp.l3-network.is-shared-network-boolean","xml":"<set>\n<parameter name='tmp.l3-network.is-shared-network-boolean' value='false' />","comments":"","x":1539.9656715393066,"y":598.7404508590698,"z":"d5178f42.44976","wires":[]},{"id":"39ea7531.083dba","type":"switchNode","name":"switch network--model.is-external-network","xml":"<switch test='`$network-model.is-external-network`'>\n","comments":"","outputs":1,"x":949.9498291015625,"y":635.5657958984375,"z":"d5178f42.44976","wires":[["7aba3265.5fa204","c956eb87.42b64"]]},{"id":"7aba3265.5fa204","type":"other","name":"outcome Y","xml":"<outcome value='Y'>\n","comments":"","outputs":1,"x":1248.9022941589355,"y":642.2961139678955,"z":"d5178f42.44976","wires":[["d8231d31.87054"]]},{"id":"d8231d31.87054","type":"set","name":"set tmp.l3-network.is-external-network-boolean","xml":"<set>\n<parameter name='tmp.l3-network.is-external-network-boolean' value='true' />","comments":"","x":1541.1880073547363,"y":642.2959613800049,"z":"d5178f42.44976","wires":[]},{"id":"c956eb87.42b64","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1237.6963195800781,"y":677.5976209640503,"z":"d5178f42.44976","wires":[["df2c956f.5ebb7"]]},{"id":"df2c956f.5ebb7","type":"set","name":"set tmp.l3-network.is-external-network-boolean","xml":"<set>\n<parameter name='tmp.l3-network.is-external-network-boolean' value='false' />","comments":"","x":1541.9822387695312,"y":677.4547986984253,"z":"d5178f42.44976","wires":[]},{"id":"985b6687.301738","type":"switchNode","name":"switch network--model.is-bound-to-vpn","xml":"<switch test='`$network-model.is-bound-to-vpn`'>\n","comments":"","outputs":1,"x":935.5313415527344,"y":748.6398734451504,"z":"d5178f42.44976","wires":[["841de692.8816c8","92021a98.fb2718"]]},{"id":"841de692.8816c8","type":"other","name":"outcome Y","xml":"<outcome value='Y'>\n","comments":"","outputs":1,"x":1247.1505546569824,"y":716.703462600708,"z":"d5178f42.44976","wires":[["ae32e0dd.54349"]]},{"id":"ae32e0dd.54349","type":"set","name":"set tmp.l3-network.is-bound-to-vpn-boolean","xml":"<set>\n<parameter name='tmp.l3-network.is-bound-to-vpn-boolean' value='true' />","comments":"","x":1539.4362678527832,"y":716.7033100128174,"z":"d5178f42.44976","wires":[]},{"id":"92021a98.fb2718","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1235.944580078125,"y":752.0049695968628,"z":"d5178f42.44976","wires":[["53abbcde.c1e354"]]},{"id":"53abbcde.c1e354","type":"set","name":"set tmp.l3-network.is-bound-to-vpn-boolean","xml":"<set>\n<parameter name='tmp.l3-network.is-bound-to-vpn-boolean' value='false' />","comments":"","x":1540.2304992675781,"y":751.8621473312378,"z":"d5178f42.44976","wires":[]},{"id":"4e2d72ac.a20f14","type":"save","name":"save AnAI - l3-network.subnets","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"subnet\" \n\t\tkey=\"l3-network.network-id = $tmp.l3-network.network-id \n\t\t\tAND subnet.subnet-id = $tmp.subnet-id\" >\n<!-- Create l3-network object -->\n<parameter name=\"network-id\" value=\"`$tmp.l3-network.network-id`\" />\n<parameter name=\"subnet-id\" value=\"`$tmp.l3-network.subnet[$sidx].subnet-id`\" />\n<parameter name=\"subnet-name\" value=\"`$tmp.l3-network.subnet[$sidx].subnet-name`\" />\n<parameter name=\"gateway-address\" value=\"`$tmp.l3-network.subnet[$sidx].gateway-address`\" />\n<parameter name=\"network-start-address\" value=\"`$tmp.l3-network.subnet[$sidx].network-start-address`\" />\n<parameter name=\"cidr-mask\" value=\"`$tmp.l3-network.subnet[$sidx].cidr-mask`\" />\n<parameter name=\"ip-version\" value=\"`$tmp.l3-network.subnet[$sidx].ip-version`\" />\n<parameter name=\"dhcp-enabled\" value=\"`$tmp.l3-network.subnet[$sidx].dhcp-enabled`\" />\n<parameter name=\"orchestration-status\" value=\"PendingCreate\" />","comments":"","outputs":1,"x":4070.083251953125,"y":2100.4833984375,"z":"d5178f42.44976","wires":[["c0ceef0e.0078a","1e9136c3.87ee69"]]},{"id":"c0ceef0e.0078a","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":4421.638069152832,"y":2059.81626701355,"z":"d5178f42.44976","wires":[["15650c05.6d1314"]]},{"id":"1e9136c3.87ee69","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":4430.361213684082,"y":2097.4594554901123,"z":"d5178f42.44976","wires":[["15650c05.6d1314"]]},{"id":"d752adcc.20017","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'An error occurred while saving subnet relationship for l3-network in AnAI where network-id = ' + $tmp.l3-network.network-id`\"/>","comments":"","x":4861.511116027832,"y":2074.67368888855,"z":"d5178f42.44976","wires":[]},{"id":"15650c05.6d1314","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":4606.36837387085,"y":2074.102150917053,"z":"d5178f42.44976","wires":[["d752adcc.20017"]]},{"id":"461634d9.663cc4","type":"save","name":"save AnAI - l3-network.subnets","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"subnet\" \n\t\tkey=\"l3-network.network-id = $tmp.l3-network.network-id \n\t\t\tAND subnet.subnet-id = $tmp.subnet-id\" >\n<!-- Create l3-network object -->\n<parameter name=\"network-id\" value=\"`$tmp.l3-network.network-id`\" />\n<parameter name=\"subnet-id\" value=\"`$tmp.l3-network.subnet[$sidx].subnet-id`\" />\n<parameter name=\"subnet-name\" value=\"`$tmp.l3-network.subnet[$sidx].subnet-name`\" />\n<parameter name=\"gateway-address\" value=\"`$tmp.l3-network.subnet[$sidx].gateway-address`\" />\n<parameter name=\"network-start-address\" value=\"`$tmp.l3-network.subnet[$sidx].network-start-address`\" />\n<parameter name=\"cidr-mask\" value=\"`$tmp.l3-network.subnet[$sidx].cidr-mask`\" />\n<parameter name=\"ip-version\" value=\"`$tmp.l3-network.subnet[$sidx].ip-version`\" />\n<parameter name=\"dhcp-start\" value=\"`$tmp.l3-network.subnet[$sidx].dhcp-start`\" />\n<parameter name=\"dhcp-end\" value=\"`$tmp.l3-network.subnet[$sidx].dhcp-end`\" />\n<parameter name=\"dhcp-enabled\" value=\"`$tmp.l3-network.subnet[$sidx].dhcp-enabled`\" />\n<parameter name=\"orchestration-status\" value=\"PendingCreate\" />","comments":"","outputs":1,"x":4107.337271690369,"y":2022.2094249725342,"z":"d5178f42.44976","wires":[["1e9136c3.87ee69","c0ceef0e.0078a"]]},{"id":"72eb0aff.498254","type":"outcome","name":"outcome NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":3648.618034362793,"y":1985.7638292312622,"z":"d5178f42.44976","wires":[["94f52050.d9fb1"]]},{"id":"b992c40a.e3fc88","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":3624.332302093506,"y":2021.4782190322876,"z":"d5178f42.44976","wires":[["c9204b2d.3b077"]]},{"id":"c9204b2d.3b077","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":3860.7606801986694,"y":2021.907039642334,"z":"d5178f42.44976","wires":[["461634d9.663cc4"]]},{"id":"f531428e.13ed98","type":"save","name":"save AnAI - l3-network.subnets","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"subnet\" \n\t\tkey=\"l3-network.network-id = $tmp.l3-network.network-id \n\t\t\tAND subnet.subnet-id = $tmp.subnet-id\" >\n<!-- Create l3-network object -->\n<parameter name=\"network-id\" value=\"`$tmp.l3-network.network-id`\" />\n<parameter name=\"subnet-id\" value=\"`$tmp.l3-network.subnet[$sidx].subnet-id`\" />\n<parameter name=\"subnet-name\" value=\"`$tmp.l3-network.subnet[$sidx].subnet-name`\" />\n<parameter name=\"network-start-address\" value=\"`$tmp.l3-network.subnet[$sidx].network-start-address`\" />\n<parameter name=\"cidr-mask\" value=\"`$tmp.l3-network.subnet[$sidx].cidr-mask`\" />\n<parameter name=\"ip-version\" value=\"`$tmp.l3-network.subnet[$sidx].ip-version`\" />\n<parameter name=\"dhcp-start\" value=\"`$tmp.l3-network.subnet[$sidx].dhcp-start`\" />\n<parameter name=\"dhcp-end\" value=\"`$tmp.l3-network.subnet[$sidx].dhcp-end`\" />\n<parameter name=\"dhcp-enabled\" value=\"`$tmp.l3-network.subnet[$sidx].dhcp-enabled`\" />\n<parameter name=\"orchestration-status\" value=\"PendingCreate\" />","comments":"","outputs":1,"x":4105.046538352966,"y":1986.7640361785889,"z":"d5178f42.44976","wires":[["c0ceef0e.0078a","1e9136c3.87ee69"]]},{"id":"94f52050.d9fb1","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":3874.184100151062,"y":1988.0331344604492,"z":"d5178f42.44976","wires":[["f531428e.13ed98"]]},{"id":"f9389512.87fe1","type":"outcome","name":"outcome NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":3657.903739929199,"y":2064.7641019821167,"z":"d5178f42.44976","wires":[["ecdbbdf9.e0987"]]},{"id":"d915319.95e925","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":3633.618007659912,"y":2100.478491783142,"z":"d5178f42.44976","wires":[["2d8feac9.f46f5e"]]},{"id":"2d8feac9.f46f5e","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":3835.0465965270996,"y":2101.9071559906006,"z":"d5178f42.44976","wires":[["4e2d72ac.a20f14"]]},{"id":"ecdbbdf9.e0987","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":3842.7557411193848,"y":2065.176050186157,"z":"d5178f42.44976","wires":[["57002b51.96ccbc"]]},{"id":"57002b51.96ccbc","type":"save","name":"save AnAI - l3-network.subnets","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"subnet\" \n\t\tkey=\"l3-network.network-id = $tmp.l3-network.network-id \n\t\t\tAND subnet.subnet-id = $tmp.subnet-id\" >\n<!-- Create l3-network object -->\n<parameter name=\"network-id\" value=\"`$tmp.l3-network.network-id`\" />\n<parameter name=\"subnet-id\" value=\"`$tmp.l3-network.subnet[$sidx].subnet-id`\" />\n<parameter name=\"subnet-name\" value=\"`$tmp.l3-network.subnet[$sidx].subnet-name`\" />\n<parameter name=\"network-start-address\" value=\"`$tmp.l3-network.subnet[$sidx].network-start-address`\" />\n<parameter name=\"cidr-mask\" value=\"`$tmp.l3-network.subnet[$sidx].cidr-mask`\" />\n<parameter name=\"ip-version\" value=\"`$tmp.l3-network.subnet[$sidx].ip-version`\" />\n<parameter name=\"dhcp-enabled\" value=\"`$tmp.l3-network.subnet[$sidx].dhcp-enabled`\" />\n<parameter name=\"orchestration-status\" value=\"PendingCreate\" />","comments":"","outputs":1,"x":4067.9035606384277,"y":2061.90673828125,"z":"d5178f42.44976","wires":[["c0ceef0e.0078a","1e9136c3.87ee69"]]},{"id":"b6bec758.f11a5","type":"set","name":"set: subnet in mdsal","xml":"<set>\n<parameter name=\"nig.subnets[$msidx].start-address\" value=\"`$tmp.l3-network.subnet[$sidx].network-start-address`\" />\n<parameter name=\"nig.subnets[$msidx].subnet-id\" value=\"`$tmp.l3-network.subnet[$sidx].subnet-id`\" />\n<parameter name=\"nig.subnets[$msidx].subnet-name\" value=\"`$tmp.l3-network.subnet[$sidx].subnet-name`\" />\n<parameter name=\"nig.subnets[$msidx].gateway-address\" value=\"`$tmp.l3-network.subnet[$sidx].gateway-address`\" />\n<parameter name=\"nig.subnets[$msidx].cidr-mask\" value=\"`$tmp.l3-network.subnet[$sidx].cidr-mask`\" />\n<parameter name=\"nig.subnets[$msidx].ip-version\" value=\"`$tmp.l3-network.subnet[$sidx].ip-version`\" />\n<parameter name=\"nig.subnets[$msidx].dhcp-start-address\" value=\"`$tmp.l3-network.subnet[$sidx].dhcp-start`\" />\n<parameter name=\"nig.subnets[$msidx].dhcp-end-address\" value=\"`$tmp.l3-network.subnet[$sidx].dhcp-end`\" />\n<parameter name=\"nig.subnets[$msidx].dhcp-enabled\" value=\"`$tmp.l3-network.subnet[$sidx].dhcp-enabled`\" />\n<parameter name=\"orchestration-status\" value=\"PendingCreate\" />\n\t","comments":"","x":2732.283203125,"y":2114.4833984375,"z":"d5178f42.44976","wires":[]},{"id":"95e4e3b2.775858","type":"set","name":"set: msidx","xml":"<set>\n<parameter name=\"msidx\" value=\"`$nig.subnets_length`\" />\n\t","comments":"","x":2252.2830810546875,"y":2033.4832763671875,"z":"d5178f42.44976","wires":[]},{"id":"bedb778a.035b4","type":"set","name":"set: increment msidx","xml":"<set>\n<parameter name=\"msidx\" value=\"`$msidx + 1`\" />\n<parameter name=\"nig.subnets_length\" value=\"`$nig.subnets_length + 1`\" />\n\t","comments":"","x":2729.283203125,"y":2151.4833984375,"z":"d5178f42.44976","wires":[]}]