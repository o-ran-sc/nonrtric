[
  {
    "id": "fd67dde.a66f82",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 116,
    "y": 35,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "1df77df2.bd25c2"
      ]
    ]
  },
  {
    "id": "1df77df2.bd25c2",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 257.00000190734863,
    "y": 112.00001430511475,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "4ae5acd4.5be1a4"
      ]
    ]
  },
  {
    "id": "4ae5acd4.5be1a4",
    "type": "method",
    "name": "sotn-attachment-topology-operation-create",
    "xml": "<method rpc='sotn-attachment-topology-operation-create' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 245.00012016296387,
    "y": 199.99999713897705,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "b78625b7.40d198"
      ]
    ]
  },
  {
    "id": "b78625b7.40d198",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 165.0000514984131,
    "y": 949.0002450942993,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "13c3075f.a550d9",
        "326099aa.e4b1f6",
        "9e7243fc.98276",
        "a773278f.c60928",
        "79a41f6b.cf86f",
        "afaa69e7.b4aba8",
        "4a444e95.a33bb",
        "77c3364e.f87538",
        "9851c050.afe45",
        "5f01282.a94d0d8",
        "7e65d530.30d0fc",
        "17bffa68.c6e1f6",
        "b279212f.2876c",
        "624c4802.103f08",
        "15e63162.783f4f",
        "4d0b157.d3d26ec",
        "7b0dce99.088f9",
        "47b622.5f78d9e",
        "547adbe.09cf724",
        "1c8354a6.82036b",
        "908c2ae3.c4f938",
        "323f6bf8.18f834",
        "ef225a8b.70ebd8",
        "16153237.cff69e",
        "5054f74f.3fad08",
        "9ff190ab.bed71"
      ]
    ]
  },
  {
    "id": "811ec7f1.394838",
    "type": "comment",
    "name": "Set allotted resource id if not sent by SO",
    "info": "",
    "comments": "",
    "x": 664.0767593383789,
    "y": 144.433913230896,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "13c3075f.a550d9",
    "type": "switchNode",
    "name": "switch allotted-resource-id",
    "xml": "<switch test='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 610.0000381469727,
    "y": 199.99998664855957,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "1fd27893.31ab57",
        "380f681d.6db258"
      ]
    ]
  },
  {
    "id": "1fd27893.31ab57",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>",
    "comments": "",
    "outputs": 1,
    "x": 808.0001258850098,
    "y": 169.99997520446777,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "f434bacd.73f0c8"
      ]
    ]
  },
  {
    "id": "380f681d.6db258",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 807.0000343322754,
    "y": 206.99998569488525,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "b52073bc.07c9f"
      ]
    ]
  },
  {
    "id": "b52073bc.07c9f",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-id",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n",
    "comments": "",
    "x": 1005.0000228881836,
    "y": 204.00000476837158,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "326099aa.e4b1f6",
    "type": "set",
    "name": "set tmp.ar.self-link",
    "xml": "<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:connection-attachment-allotted-resources/connection-attachment-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/connection-attachment-topology/'` \" />\n\n",
    "comments": "",
    "x": 562.9999523162842,
    "y": 386.00009632110596,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "9e7243fc.98276",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 563.2618942260742,
    "y": 472.6668071746826,
    "z": "6ade2963.0875b8",
    "wires": [
      []
    ]
  },
  {
    "id": "a773278f.c60928",
    "type": "execute",
    "name": "generate allotted-resource tmp.ar-url",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.connection-attachment-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 616.2619304656982,
    "y": 554.6666955947876,
    "z": "6ade2963.0875b8",
    "wires": [
      []
    ]
  },
  {
    "id": "f434bacd.73f0c8",
    "type": "execute",
    "name": "execute tmp.ar.allotted-resource-id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"tmp.ar.allotted-resource-id\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 1023.0001029968262,
    "y": 170.99998092651367,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "9ab0be9f.9431d"
      ]
    ]
  },
  {
    "id": "9ab0be9f.9431d",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1241.000144958496,
    "y": 170.99994468688965,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "aca58bfe.822378"
      ]
    ]
  },
  {
    "id": "aca58bfe.822378",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value=\"An error occured while generation allotted resource ID\" />\n",
    "comments": "",
    "x": 1407.000099182129,
    "y": 170.9999589920044,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "43d96423.28d03c",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1122.000228881836,
    "y": 626.777868270874,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "1050cf03.802321"
      ]
    ]
  },
  {
    "id": "b3c8cfd5.7bea1",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error: Existing connection attachment allotted resource\" />\n    \n",
    "comments": "",
    "x": 1855.5186080932617,
    "y": 627.843939781189,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "293dd257.14194e",
    "type": "comment",
    "name": "Check for non existence of allotted resource",
    "info": "",
    "comments": "",
    "x": 978.000150680542,
    "y": 560.7779350280762,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "c5387b68.c01b28",
    "type": "for",
    "name": "for cidx..service-data.consumed-allotted-resources.consumed-allotted-resource[]",
    "xml": "<for index='cidx' start='0' end='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1498.666696548462,
    "y": 771.0000474452972,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "c340ff54.e12d9"
      ]
    ]
  },
  {
    "id": "afaa69e7.b4aba8",
    "type": "switchNode",
    "name": "switch service-data.consumed-allotted-resources_length",
    "xml": "<switch test='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 680.6660213470459,
    "y": 747.7140798568726,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "7d136f12.04ec4",
        "c30cd80f.81caf8"
      ]
    ]
  },
  {
    "id": "7d136f12.04ec4",
    "type": "other",
    "name": "outcome Null",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 984.8089199066162,
    "y": 716.5715169906616,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "58b68eae.81516"
      ]
    ]
  },
  {
    "id": "c30cd80f.81caf8",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 961.8089694976807,
    "y": 777.5714721679688,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "7a8ccc70.38dd84"
      ]
    ]
  },
  {
    "id": "7a8ccc70.38dd84",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1121.9360599517822,
    "y": 775.6974487304688,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "c5387b68.c01b28",
        "e1e02207.f540e",
        "9846e0ee.d12b5"
      ]
    ]
  },
  {
    "id": "58b68eae.81516",
    "type": "set",
    "name": "set cidx",
    "xml": "<set>\n<parameter name='tmp.cidx' value=\"`0`\" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource_length' value=\"1\" />\n\n\n",
    "comments": "",
    "x": 1134.6659030914307,
    "y": 714.2855672836304,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "4a444e95.a33bb",
    "type": "set",
    "name": "set consumed allotted resources",
    "xml": "<set>\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource[$tmp.cidx].allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource[$tmp.cidx].allotted-resource-type' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type` \" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource[$tmp.cidx].allotted-resource-pointer' value=\"`$tmp.ar.self-link` \" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource_length' value='`$tmp.cidx + 1`' />\n\n",
    "comments": "",
    "x": 609.5233135223389,
    "y": 851.28564453125,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "e1e02207.f540e",
    "type": "switchNode",
    "name": "switch tmp.found-cidx",
    "xml": "<switch test='`$tmp.found-cidx`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1311.0511074066162,
    "y": 807.7089715003967,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "d3531383.fcd03"
      ]
    ]
  },
  {
    "id": "d3531383.fcd03",
    "type": "outcomeTrue",
    "name": "false",
    "xml": "<outcome value='false'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1501.051061630249,
    "y": 807.7089085578918,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "40bc6162.88ce4"
      ]
    ]
  },
  {
    "id": "40bc6162.88ce4",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1667.051061630249,
    "y": 807.7089085578918,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "ae09ce54.6bf07"
      ]
    ]
  },
  {
    "id": "c340ff54.e12d9",
    "type": "switchNode",
    "name": "switch allotted-resource-id",
    "xml": "<switch test=\"`$service-data.consumed-allotted-resources.consumed-allotted-resource[$cidx].allotted-resource-id == $tmp.ar.allotted-resource-id`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1915.778326034546,
    "y": 768.0000743865967,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "1d1de9d1.83f6a6"
      ]
    ]
  },
  {
    "id": "1d1de9d1.83f6a6",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2097.587900161743,
    "y": 768.464521408081,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "a46d34eb.cac738"
      ]
    ]
  },
  {
    "id": "ae09ce54.6bf07",
    "type": "set",
    "name": "set tmp.cidx",
    "xml": "<set>\n<parameter name='tmp.cidx' value='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`' />\n",
    "comments": "",
    "x": 1828.9244441986084,
    "y": 807.220609664917,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "896433e5.65cfe",
    "type": "comment",
    "name": "Add to consumed service consumed-allotted-resources in mdsal",
    "info": "Prepare data and add to service-data",
    "comments": "",
    "x": 701.6672344207764,
    "y": 678.0000438690186,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "f08c9e13.c44cf",
    "type": "comment",
    "name": "This set resource will be added to MDSAL by provider code",
    "info": "Below we add to service-data.consumed-allotted-resource at last index",
    "comments": "",
    "x": 689.000150680542,
    "y": 816.7781362533569,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "c88c64b6.dfe1a8",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 789.4527835845947,
    "y": 1857.4844884872437,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "9e7b6d53.3088c"
      ]
    ]
  },
  {
    "id": "9e7b6d53.3088c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"AAI failed\" />\n",
    "comments": "",
    "x": 955.9766635894775,
    "y": 1869.1035594940186,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "d0e9a590.6f6418",
    "type": "failure",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 796.5480709075928,
    "y": 1890.2464561462402,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "9e7b6d53.3088c"
      ]
    ]
  },
  {
    "id": "939b0538.009728",
    "type": "comment",
    "name": "Save Resource to AAI",
    "info": "",
    "comments": "",
    "x": 571.5004863739014,
    "y": 1809.8338594436646,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "452cb6fa.b17108",
    "type": "comment",
    "name": "Set allotted resource type if not sent by SO",
    "info": "",
    "comments": "",
    "x": 650.0000076293945,
    "y": 252.9999942779541,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "79a41f6b.cf86f",
    "type": "switchNode",
    "name": "switch allotted-resource-type",
    "xml": "<switch test='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 611.9233169555664,
    "y": 293.56605052948,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "9df4ab55.c16cf8",
        "31f43c4.20babc4"
      ]
    ]
  },
  {
    "id": "9df4ab55.c16cf8",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>",
    "comments": "",
    "outputs": 1,
    "x": 814.923469543457,
    "y": 278.56605339050293,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "e98a3f5.eded9c"
      ]
    ]
  },
  {
    "id": "31f43c4.20babc4",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 807.9232978820801,
    "y": 318.5660734176636,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "1fb5cc66.1487a4"
      ]
    ]
  },
  {
    "id": "1fb5cc66.1487a4",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-type",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-type' value='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type`' />\n",
    "comments": "",
    "x": 1039.923282623291,
    "y": 318.56607818603516,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "fd7e59b0.bdc4b8",
    "type": "comment",
    "name": "For storage in AAI connection-attachment-topology",
    "info": "",
    "comments": "",
    "x": 659.9999599456787,
    "y": 352.99999713897705,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "80a14ec4.93ba1",
    "type": "comment",
    "name": "Obtain different URL, template location etc",
    "info": "For saving resource information to MDSAL & for AAI",
    "comments": "",
    "x": 634.9999446868896,
    "y": 434.88890647888184,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "77a4ea23.6f89a4",
    "type": "comment",
    "name": "Used for Put AR by id to MDSAL",
    "info": "",
    "comments": "",
    "x": 601.0000286102295,
    "y": 523.8889236450195,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "9a5ebcbf.d7c64",
    "type": "comment",
    "name": "Obtain the last index in services",
    "info": "ServiceData is added by Provider code",
    "comments": "",
    "x": 602.4444713592529,
    "y": 709.8888683319092,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "547adbe.09cf724",
    "type": "set",
    "name": "set output to api handler",
    "xml": "<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='connection-attachment-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $connection-attachment-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n",
    "comments": "",
    "x": 580.2681331634521,
    "y": 1773.3591861724854,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "1c8354a6.82036b",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 525.6813278198242,
    "y": 2062.9751262664795,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "e98a3f5.eded9c",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-type",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-type' value=\"SOTNAttachmentInstance\" />\n",
    "comments": "",
    "x": 1054.000156402588,
    "y": 278.99997997283936,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "1a362e33.d91322",
    "type": "call",
    "name": "call GENERIC-RESOURCE-API:sotn-get-saved-ar-param",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sotn-get-saved-ar-param' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 881.9941539764404,
    "y": 1622.4937267303467,
    "z": "6ade2963.0875b8",
    "wires": [
      []
    ]
  },
  {
    "id": "47b622.5f78d9e",
    "type": "execute",
    "name": "execute RestApiCallNode - PUT AR by id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.sotn-attachment.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 631.00026512146,
    "y": 1707.0001153945923,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "b728505b.0e0f4",
        "c43ce215.10dc2",
        "e9e15e53.ae354"
      ]
    ]
  },
  {
    "id": "b728505b.0e0f4",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 880.6416187286377,
    "y": 1745.3314456939697,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "66f7d186.f5a07"
      ]
    ]
  },
  {
    "id": "c43ce215.10dc2",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 871.6416683197021,
    "y": 1713.8314714431763,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "66f7d186.f5a07"
      ]
    ]
  },
  {
    "id": "e9e15e53.ae354",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 875.3917064666748,
    "y": 1684.1885763183236,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "7fa6f3ff.c75f4c"
      ]
    ]
  },
  {
    "id": "66f7d186.f5a07",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource\" />\n",
    "comments": "",
    "x": 1041.3917064666748,
    "y": 1714.5814952850342,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "7fa6f3ff.c75f4c",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1017.0476741790771,
    "y": 1680.3807455077767,
    "z": "6ade2963.0875b8",
    "wires": [
      []
    ]
  },
  {
    "id": "7e65d530.30d0fc",
    "type": "execute",
    "name": "execute RestApiCallNode - Update parent provided service AR",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.parentsvc.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.parent-ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"parent\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 700.9999523162842,
    "y": 1133.0001621246338,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "b6d4488a.291cc8",
        "59f3d9b4.dd0088",
        "20a7e6fe.74d03a"
      ]
    ]
  },
  {
    "id": "b6d4488a.291cc8",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1009.308012008667,
    "y": 1164.9984378814697,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "2d8af8d.61d7808"
      ]
    ]
  },
  {
    "id": "59f3d9b4.dd0088",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1000.3080615997314,
    "y": 1133.4984636306763,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "2d8af8d.61d7808"
      ]
    ]
  },
  {
    "id": "20a7e6fe.74d03a",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1004.0580997467041,
    "y": 1103.8555685058236,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "3fdd6b37.b0dbe4"
      ]
    ]
  },
  {
    "id": "2d8af8d.61d7808",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource\" />\n",
    "comments": "",
    "x": 1170.058099746704,
    "y": 1134.2484874725342,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "3fdd6b37.b0dbe4",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1145.7140674591064,
    "y": 1100.0477376952767,
    "z": "6ade2963.0875b8",
    "wires": [
      []
    ]
  },
  {
    "id": "fef74984.54b2d8",
    "type": "comment",
    "name": "Put the parent allotted resource in mdsal",
    "info": "",
    "comments": "",
    "x": 629.9998989105225,
    "y": 1095.0000686645508,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "b279212f.2876c",
    "type": "set",
    "name": "set connection-attachment-ar-identifiers",
    "xml": "<set>\n<parameter name='connection-attachment-ar-identifiers.consuming-service-instance-id' value=\"`$connection-attachment-topology-operation-input.service-information.service-instance-id` \" />\n<parameter name='connection-attachment-ar-identifiers.parent-service-instance-id' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id` \" />\n<parameter name='connection-attachment-ar-identifiers.allotted-resource-type' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type` \" />\n<parameter name='connection-attachment-ar-identifiers.allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n\n",
    "comments": "",
    "x": 626.357084274292,
    "y": 1297.5716876983643,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "17bffa68.c6e1f6",
    "type": "set",
    "name": "set ar-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n<parameter name='connection-attachment-ar.allotted-resource-status.action' value=\"`$connection-attachment-topology-operation-input.request-information.request-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-name' value=\"connection-attachment-topology-operation\" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-action' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.request-information.' value=\"`$connection-attachment-topology-operation-input.request-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.service-information.' value=\"`$connection-attachment-topology-operation-input.service-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.allotted-resource-information.' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.connection-attachment-request-input.' value=\"`$connection-attachment-topology-operation-input.connection-attachment-request-input.` \" />",
    "comments": "",
    "x": 540.2138652801514,
    "y": 1265.3810443878174,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "624c4802.103f08",
    "type": "set",
    "name": "set identifiers in overall structure",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.connection-attachment-topology.allotted-resource-identifiers.' \nvalue=\"`$connection-attachment-ar-identifiers.`\" />\n\n\n",
    "comments": "",
    "x": 605.1668834686279,
    "y": 1331.6668729782104,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "15e63162.783f4f",
    "type": "execute",
    "name": "execute getTime",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='setTime' >\n    <parameter name=\"outputPath\" value=\"tmp.current-time\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 557.4997234344482,
    "y": 1405.000400543213,
    "z": "6ade2963.0875b8",
    "wires": [
      []
    ]
  },
  {
    "id": "4d0b157.d3d26ec",
    "type": "set",
    "name": "set allotted-resource-oper-status",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status' value='Created' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$connection-attachment-topology-operation-input.request-information.request-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-request-id`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.create-timestamp' value='`$tmp.current-time`' />\n",
    "comments": "",
    "x": 608.4867610931396,
    "y": 1460.9516334533691,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "7b0dce99.088f9",
    "type": "set",
    "name": "set model-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.connection-attachment-topology.onap-model-information.' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.` \" />",
    "comments": "",
    "x": 553.0553798675537,
    "y": 1366.5557584762573,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "3f9a586f.0ed898",
    "type": "comment",
    "name": "Prepare data for allotted-resource addition to MDSAL",
    "info": "This will add to allotted-resource which is present inside service.",
    "comments": "",
    "x": 670.3888683319092,
    "y": 1231.5556049346924,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "5f01282.a94d0d8",
    "type": "execute",
    "name": "generate parent-ar url - replace allotted-resource-id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$tmp.parent-ar-url`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.parent-ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 665.5000133514404,
    "y": 1059.0000076293945,
    "z": "6ade2963.0875b8",
    "wires": [
      []
    ]
  },
  {
    "id": "9851c050.afe45",
    "type": "execute",
    "name": "generate parent-ar url - replace service-instance-id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.parent-provided-resource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.parent-ar-url\"/>\n    <parameter name=\"target\" value=\"{service-instance-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.parent-service-instance-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 661.4999370574951,
    "y": 1016.0001440048218,
    "z": "6ade2963.0875b8",
    "wires": [
      []
    ]
  },
  {
    "id": "e506fda2.8d2ea",
    "type": "comment",
    "name": "Prepare Parent AR URL",
    "info": "Preparation to set provided-allotted-resource in parent service instance",
    "comments": "",
    "x": 579.500394821167,
    "y": 945.0000972747803,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "77c3364e.f87538",
    "type": "set",
    "name": "set tmp.ar.parent-service-instance-id",
    "xml": "<set>\n<parameter name='tmp.ar.parent-service-instance-id' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id` \" />\n\n",
    "comments": "",
    "x": 618.5001888275146,
    "y": 978.5000367164612,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "92f0d3fa.a1c8f",
    "type": "comment",
    "name": "Required for filling template values",
    "info": "This is done because connection-attachment is generic resource and doesn't have specific parameters",
    "comments": "",
    "x": 808.0003566741943,
    "y": 1585.4997997283936,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "a46d34eb.cac738",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource as cosumed allotted resource already exists.\" />\n",
    "comments": "",
    "x": 2175.756971359253,
    "y": 816.6458263397217,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "9846e0ee.d12b5",
    "type": "set",
    "name": "set tmp.found-cidx",
    "xml": "<set>\n<parameter name='tmp.found-cidx' value=\"`false`\" />\n\n\n",
    "comments": "",
    "x": 1301.6461429595947,
    "y": 728.3125693798065,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "8a1a8721.8ed3e8",
    "type": "comment",
    "name": "Add to parent services provided-allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 690.2015056610107,
    "y": 912.9792537689209,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "1b0d53ce.9a266c",
    "type": "comment",
    "name": "Add to allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 610.9686946868896,
    "y": 1198.968934059143,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "1050cf03.802321",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1284.0000495910645,
    "y": 626.2777576446533,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "e1fb702b.b9339"
      ]
    ]
  },
  {
    "id": "e1fb702b.b9339",
    "type": "switchNode",
    "name": "switch cr length",
    "xml": "<switch test='`$mdsal-ar.connection-attachment-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1471.8574295043945,
    "y": 626.8968930244446,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "e440f3e0.a28bd"
      ]
    ]
  },
  {
    "id": "e440f3e0.a28bd",
    "type": "other",
    "name": "outcome 1",
    "xml": "<outcome value='1'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1671.1905517578125,
    "y": 626.8969717025757,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "b3c8cfd5.7bea1"
      ]
    ]
  },
  {
    "id": "908c2ae3.c4f938",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource connection-attachment-allotted-resource",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 756.0000514984131,
    "y": 621.0000333786011,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "43d96423.28d03c",
        "4feb08ba.5bc668"
      ]
    ]
  },
  {
    "id": "4feb08ba.5bc668",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1124.0000820159912,
    "y": 591.0000314712524,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "83e21d77.f2154"
      ]
    ]
  },
  {
    "id": "83e21d77.f2154",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1276.0000820159912,
    "y": 590.0000314712524,
    "z": "6ade2963.0875b8",
    "wires": [
      []
    ]
  },
  {
    "id": "323f6bf8.18f834",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 552.5556087493896,
    "y": 1540.6666507720947,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "e3e339e2.fb2158",
        "1a362e33.d91322"
      ]
    ]
  },
  {
    "id": "e3e339e2.fb2158",
    "type": "for",
    "name": "for each sotn-get-request-input-param",
    "xml": "<for index='i' start='0' end='`$connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.connection-attachment-request-input.param_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 822.5556735992432,
    "y": 1540.6666984558105,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "bbd24f47.537d9"
      ]
    ]
  },
  {
    "id": "efeae286.69244",
    "type": "comment",
    "name": "Take the parameter names by removing prefix",
    "info": "",
    "comments": "",
    "x": 1362.555456161499,
    "y": 1496.6667318344116,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "7418c4f0.7b725c",
    "type": "execute",
    "name": "execute split parameterName",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.connection-attachment-request-input.param[$i].name`'/>\n<parameter name=\"regex\" value=\"_\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"param-prefix\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 1320.590124130249,
    "y": 1531.6458749771118,
    "z": "6ade2963.0875b8",
    "wires": [
      []
    ]
  },
  {
    "id": "91cb2a09.3ae8f8",
    "type": "set",
    "name": "set parameterName",
    "xml": "<set>\n<parameter name=\"`connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.connection-attachment-request-input.param[$i].name`\" value='`$param-prefix[$param-prefix_length -1]`'/>\n",
    "comments": "",
    "x": 1291.0346508026123,
    "y": 1564.6458749771118,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "6e625d6.e7e6ea4",
    "type": "comment",
    "name": "Remove VNFC prefix",
    "info": "",
    "comments": "",
    "x": 763.5556011199951,
    "y": 1508.1110124588013,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "bbd24f47.537d9",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1069.5555095672607,
    "y": 1539.1110429763794,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "7418c4f0.7b725c",
        "91cb2a09.3ae8f8"
      ]
    ]
  },
  {
    "id": "ef225a8b.70ebd8",
    "type": "set",
    "name": "set src-ltpId",
    "xml": "<set>\n<parameter name='src-ltpId' value=\"`'nodeId-' + $prop.connection-attachment.access-node-id + '-ltpId-' + $prop.connection-attachment.access-ltp-id`\" />\n",
    "comments": "",
    "x": 529.0000972747803,
    "y": 1930.0003395080566,
    "z": "6ade2963.0875b8",
    "wires": []
  },
  {
    "id": "16153237.cff69e",
    "type": "update",
    "name": "save AAI allotted-resource",
    "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='allotted-resource' \n      key='customer.global-customer-id = $connection-attachment-topology-operation-input.service-information.global-customer-id AND\n\t\t\tservice-subscription.service-type = $connection-attachment-topology-operation-input.service-information.subscription-service-type AND\n\t\t\tservice-instance.service-instance-id = $connection-attachment-topology-operation-input.service-information.service-instance-id AND\n\t\t\tallotted-resource.id = $tmp.ar.allotted-resource-id' >        \n    <parameter name=\"id\" value=\"`$tmp.ar.allotted-resource-id`\" />\n\t<parameter name=\"name\" value=\"`$prop.connection-attachment.sotnVpnName`\" />\n\t<parameter name=\"access-provider-id\" value=\"`$prop.connection-attachment.access-provider-id`\" />\n\t<parameter name=\"access-client-id\" value=\"`$prop.connection-attachment.access-client-id`\" />\n\t<parameter name=\"access-topology-id\" value=\"`$prop.connection-attachment.access-topology-id`\" />\n\t<parameter name=\"access-node-id\" value=\"`$prop.connection-attachment.access-node-id`\" />\n\t<parameter name=\"access-ltp-id\" value=\"`$prop.connection-attachment.access-ltp-id`\" />\t\n\t<parameter name=\"cvlan\" value=\"`$prop.connection-attachment.cVLAN`\" />\n    <parameter name=\"vpn-name\" value=\"`$prop.connection-attachment.sotnVpnName`\" />\n\t<parameter name=\"selflink\" value=\"`$tmp.ar.self-link`\" />\n\t<parameter name=\"model-invariant-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-invariant-uuid`\" />\n\t<parameter name=\"model-version-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-uuid`\" />\n\t<parameter name=\"operational-status\" value=\"Created\" />\n",
    "comments": "",
    "outputs": 1,
    "x": 579.0039520263672,
    "y": 1870.5039854049683,
    "z": "6ade2963.0875b8",
    "wires": [
      [
        "c88c64b6.dfe1a8",
        "d0e9a590.6f6418"
      ]
    ]
  },
  {
    "id": "5054f74f.3fad08",
    "type": "save",
    "name": "save srcLTP relationship in AAI",
    "xml": "<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"allotted-resource:relationship-list\" \n\t\tkey=\"customer.global-customer-id = $connection-attachment-topology-operation-input.service-information.global-customer-id AND\n\t\t\tservice-subscription.service-type = $connection-attachment-topology-operation-input.service-information.subscription-service-type AND\n\t\t\tservice-instance.service-instance-id = $connection-attachment-topology-operation-input.service-information.service-instance-id AND\n\t\t\tallotted-resource.id = $tmp.ar.allotted-resource-id\" \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"p-interface\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/pnfs/pnf/' + $prop.connection-attachment.access-node-id + '/p-interfaces/p-interface/' + $src-ltpId`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"p-interface.interface-name\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$src-ltpId`\" />\n\n\n\n",
    "comments": "",
    "outputs": 1,
    "x": 579.3170623779297,
    "y": 1976.9767112731934,
    "z": "6ade2963.0875b8",
    "wires": [
      []
    ]
  },
  {
    "id": "9ff190ab.bed71",
    "type": "save",
    "name": "save allotted relationship in AAI",
    "xml": "<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" resource=\"service-instance:relationship-list\" \n\t\tkey=\"customer.global-customer-id = $connection-attachment-topology-operation-input.service-information.global-customer-id AND\n\t\t\tservice-subscription.service-type = $connection-attachment-topology-operation-input.service-information.subscription-service-type AND\n\t\t\tservice-instance.service-instance-id = $connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id\" \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"allotted-resource\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/business/customers/customer/' + $connection-attachment-topology-operation-input.service-information.global-customer-id + '/service-subscriptions/service-subscription/' + $connection-attachment-topology-operation-input.service-information.subscription-service-type + '/service-instances/service-instance/' + $connection-attachment-topology-operation-input.service-information.service-instance-id + '/allotted-resources/allotted-resource/' + $tmp.ar.allotted-resource-id`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"allotted-resource.id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$tmp.ar.allotted-resource-id`\" />\n\n\n\n",
    "comments": "",
    "outputs": 1,
    "x": 577.3130798339844,
    "y": 2015.9724407196045,
    "z": "6ade2963.0875b8",
    "wires": [
      []
    ]
  }
]
