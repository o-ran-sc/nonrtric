[{"id":"e2e3481.5f32db8","type":"dgstart","name":"DGSTART","outputs":1,"x":95.71428680419922,"y":28.571428298950195,"z":"349cd3c6.7ae4ac","wires":[["2b280696.a1533a"]]},{"id":"2b280696.a1533a","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":361.8071594238281,"y":26.173827171325684,"z":"349cd3c6.7ae4ac","wires":[["c5939f21.48bac"]]},{"id":"80ef1851.d2a118","type":"comment","name":"ChangeLog","info":"3/21 - initial version","comments":"","x":84.54327392578125,"y":76.32904410362244,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"c5939f21.48bac","type":"method","name":"eipam-create-generic-pool","xml":"<method rpc='eipam-create-generic-pool' mode='sync'>\n","comments":"","outputs":1,"x":153.26294708251953,"y":117.25627899169922,"z":"349cd3c6.7ae4ac","wires":[["23817fa2.ce037"]]},{"id":"b036d114.4c11","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"network-topology-operation\"/>\n<parameter name=\"field3\" value=\"eipam-create-generic-pool\"/>\n<parameter name=\"field4\" value=\"`$eipam-ip-block.plans[$eipam-ip-block.plans_length].plan-name`\"/>\n<parameter name=\"field5\" value=\"`$eipam-ip-block.plans[$eipam-ip-block.plans_length].requests[0].pools[$l4-idx].key-name`\"/>\n<parameter name=\"field6\" value=\"`$eipam-ip-block.plans[$eipam-ip-block.plans_length].requests[0].pools[$l4-idx].key-value`\"/>\n\n","comments":"","outputs":1,"x":2174.688430786133,"y":741.7044677734375,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"6f8e94f6.a5cbcc","type":"set","name":"set EIPAM pool info at each Level","xml":"<set>\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].requests[0].pools[$l4-idx].key-name\" value=\"`$v4FQPN-output.pools[$l4-idx].key-name`\"/>\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].requests[0].pools[$l4-idx].key-value\" value=\"`$v4FQPN-output.pools[$l4-idx].key-value`\"/>\n","comments":"subnet and subnet_keys are deleted in the EIPAMPlugin","x":2249.500452041626,"y":697.2501811981201,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"629efca9.657ab4","type":"execute","name":"execute EIPAM createPool","xml":"<execute plugin=\"com.att.sdnctl.sli.plugin.eipam.EIPAMPlugin\" method=\"createPool\">\n","comments":"subnet and subnet_keys are deleted in the EIPAMPlugin","outputs":1,"x":788.7142181396484,"y":1656.3458805084229,"z":"349cd3c6.7ae4ac","wires":[["45e81867.eab068","3b05b3c5.afdfac"]]},{"id":"23817fa2.ce037","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":105.40047454833984,"y":167.6314868927002,"z":"349cd3c6.7ae4ac","wires":[["b9c0b035.a2a53","7e88c71a.3c9f78","d6eff478.7ae598","e937da96.450648","5fcb4629.8fc1a8","c95edad7.418dc8","9b4b3a87.ce0398","d0744c26.6d381"]]},{"id":"b9c0b035.a2a53","type":"switchNode","name":"switch: network-model.use-ipv4","xml":"<switch test=\"`$network-model.use-ipv4`\">","comments":"","outputs":1,"x":370.7142753601074,"y":458.6314868927002,"z":"349cd3c6.7ae4ac","wires":[["f9d87dbe.be8de","d0a1dc79.d23e","f4309371.e6295"]]},{"id":"d0a1dc79.d23e","type":"other","name":"NULL","xml":"<outcome value=\"\">","comments":"","outputs":1,"x":582.7143363952637,"y":471.63151359558105,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"f9d87dbe.be8de","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":581.7143936157227,"y":427.6314868927002,"z":"349cd3c6.7ae4ac","wires":[["26fa525e.93ddde"]]},{"id":"26fa525e.93ddde","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":735.7143363952637,"y":426.63149070739746,"z":"349cd3c6.7ae4ac","wires":[["7ebe02e2.9471bc"]]},{"id":"60344065.a233","type":"set","name":"set: eipam-ip-block.plans[]++","xml":"<set>\n\t<parameter name=\"eipam-ip-block.plans_length\" value=\"`$eipam-ip-block.plans_length + 1`\" />","comments":"","x":1825.1878242492676,"y":795.4603271484375,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"45e81867.eab068","type":"failure","name":"failure","xml":"<outcome value='failure'>","outputs":1,"x":998.7142639160156,"y":1657.7362461090088,"z":"349cd3c6.7ae4ac","wires":[["514e1ae1.e90694"]]},{"id":"514e1ae1.e90694","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"tmp.eipam-error\" value=\"true\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"An error occured while creating pool in EIPAM.\" />\n\t","comments":"","x":1162.7142944335938,"y":1660.736276626587,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"7e88c71a.3c9f78","type":"set","name":"set: data initialization","xml":"<set>\n\t<parameter name=\"tmp.eipam-error\" value=\"false\" />\n\t<parameter name=\"tmp.create-v4-pool-flag\" value=\"N\" />\n\t<parameter name=\"tmp.create-v6-pool-flag\" value=\"N\" />\n\t<parameter name='eipam-ip-block.plans_length' value='0' />\n\t<parameter name=\"eipam-pool.v4.pre-existing\" value=\"N\"/>\n\t<parameter name=\"eipam-pool.v6.pre-existing\" value=\"N\"/>\n\t<parameter name=\"level\" value=\"`$eipam-ip-block.level - 1`\" />","comments":"","x":362.7434768676758,"y":176.6623296737671,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"d6eff478.7ae598","type":"switchNode","name":"switch: network-model.use-ipv6","xml":"<switch test=\"`$network-model.use-ipv6`\">","comments":"","outputs":1,"x":347.39631271362305,"y":1004.3200531005859,"z":"349cd3c6.7ae4ac","wires":[["7deae29a.1a055c","2374789e.b074e8","8b66ef6.ad3381"]]},{"id":"2374789e.b074e8","type":"other","name":"NULL","xml":"<outcome value=\"\">","comments":"","outputs":1,"x":618.3963432312012,"y":1048.320053100586,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"7deae29a.1a055c","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":623.3964500427246,"y":1003.3200531005859,"z":"349cd3c6.7ae4ac","wires":[["b663fc8f.61603"]]},{"id":"b663fc8f.61603","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":779.9678726196289,"y":1001.1771831512451,"z":"349cd3c6.7ae4ac","wires":[["8245ad31.919cc"]]},{"id":"f4309371.e6295","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":583.7143363952637,"y":509.57142448425293,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"8b66ef6.ad3381","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":620.2857475280762,"y":1089.714340209961,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"7ebe02e2.9471bc","type":"get-resource","name":"DB - validate if pool exists for level already","xml":"<get-resource\n        plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n        resource='SQL'\n        key=\"SELECT * FROM EIPAM_IP_POOLS where plan_name = $network-model.eipam-v4-address-plan and level = $eipam-ip-block.level and key_value = $v4FQPN-output.pools[$level].key-value ;\"\n        pfx='tmp.eipam-pool-row'>\n\n","comments":"","outputs":1,"x":1010.3623199462891,"y":348.10715198516846,"z":"349cd3c6.7ae4ac","wires":[["d99065ab.323ec8","eee028af.a5deb8","1c016b1c.b5d1e5"]]},{"id":"6b13034.09e54fc","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"tmp.eipam-error\" value=\"true\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"Query to DB table EIPAM_IP_POOLS failed.\" />\n\t","comments":"","x":1414.5408020019531,"y":342.5714454650879,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"d99065ab.323ec8","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1267.790885925293,"y":380.5714454650879,"z":"349cd3c6.7ae4ac","wires":[["2e3df561.44defa"]]},{"id":"c074e0c3.e9003","type":"switchNode","name":"test: eipam-ip-block.level","xml":"<switch test=\"`$l-idx`\">","comments":"","outputs":1,"x":1026.399745941162,"y":443.8215026855469,"z":"349cd3c6.7ae4ac","wires":[["d683f90d.bc3ea8","c3fe815f.6da18","267f5e4a.4aee02"]]},{"id":"d683f90d.bc3ea8","type":"other","name":"level 1","xml":"<outcome value='1'>","comments":"","outputs":1,"x":1054.586441040039,"y":513.7500696182251,"z":"349cd3c6.7ae4ac","wires":[["749d6519.db75ac"]]},{"id":"c3fe815f.6da18","type":"other","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1057.1578521728516,"y":615.6071872711182,"z":"349cd3c6.7ae4ac","wires":[["162c89d9.7a2f86"]]},{"id":"162c89d9.7a2f86","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"tmp.eipam-error\" value=\"true\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"Please set the eipam-ip-block.level for appropriate EIPAM request.\" />\n\t","comments":"","x":1184.4077491760254,"y":614.6072125434875,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"e937da96.450648","type":"switchNode","name":"switch: network-model.use-ipv4","xml":"<switch test=\"`$network-model.use-ipv4`\">","comments":"","outputs":1,"x":306.71414947509766,"y":2024.4723377227783,"z":"349cd3c6.7ae4ac","wires":[["79314023.487a9","4cb8a60e.a2c188","b4fe1b28.500a58"]]},{"id":"4cb8a60e.a2c188","type":"other","name":"NULL","xml":"<outcome value=\"\">","comments":"","outputs":1,"x":497.7142105102539,"y":2044.9723205566406,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"79314023.487a9","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":495.46424102783203,"y":2004.9724445343018,"z":"349cd3c6.7ae4ac","wires":[["4342f9af.5328e8"]]},{"id":"9cd666e7.72ced8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1054.2856712341309,"y":1894.0438032150269,"z":"349cd3c6.7ae4ac","wires":[["11ba19d5.d9c756","148249f9.846256","67dc159b.560f4c","d77f382b.bfda98","b9aa3822.9ae098"]]},{"id":"b4fe1b28.500a58","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":501.3536148071289,"y":2090.366728782654,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"11ba19d5.d9c756","type":"switchNode","name":"switch: eipam-ip-block.level","xml":"<switch test=\"`$eipam-ip-block.level`\">","comments":"","outputs":1,"x":1249.9999237060547,"y":1915.4725914001465,"z":"349cd3c6.7ae4ac","wires":[["4da585da.42efcc","ee30d95a.ab8b18"]]},{"id":"4da585da.42efcc","type":"other","name":"1","xml":"<outcome value='1'>","comments":"","outputs":1,"x":1433.6030578613281,"y":1867.544111251831,"z":"349cd3c6.7ae4ac","wires":[["87c2ca4a.4911b8"]]},{"id":"ee30d95a.ab8b18","type":"other","name":"Other","xml":"<outcome value='Other'>","comments":"","outputs":1,"x":1430.9960632324219,"y":1931.7941188812256,"z":"349cd3c6.7ae4ac","wires":[["9f65900e.a4ec6"]]},{"id":"b76edc1c.d7929","type":"save","name":"insert EIPAM_IP_POOLS for V4","xml":"<save\n        plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n        resource='SQL'\n        key=\"INSERT EIPAM_IP_POOLS\n             SET\n             key_name = $key-name ,\n             key_value = $key-value ,\n             level = $eipam-ip-block.level ,\n             plan_name = $network-model.eipam-v4-address-plan ,\n             address_family = $network-model.ipv4-ip-version ,\n             parent_pool = $parent_pool ,\n             service_instance_id = $network-topology-operation-input.service-information.service-instance-id ,\n             network_id = $tmp.network-id ,\n             network_instance_group_id = $tmp.network-instance-group-id ; \"\n    force='true'\n        pfx='pfx.eipam-v4pool-row'>\n","comments":"","outputs":1,"x":1668.2366638183594,"y":1993.8939743041992,"z":"349cd3c6.7ae4ac","wires":[["5ee60164.3bc0a"]]},{"id":"5fcb4629.8fc1a8","type":"switchNode","name":"switch: network-model.use-ipv6","xml":"<switch test=\"`$network-model.use-ipv6`\">","comments":"","outputs":1,"x":295.90048599243164,"y":2334.9010162353516,"z":"349cd3c6.7ae4ac","wires":[["eb3c98eb.650608","74db2aa6.3483b4","f4b6e870.76a488"]]},{"id":"74db2aa6.3483b4","type":"other","name":"NULL","xml":"<outcome value=\"\">","comments":"","outputs":1,"x":491.9005470275879,"y":2367.9010162353516,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"eb3c98eb.650608","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":490.900577545166,"y":2332.9010009765625,"z":"349cd3c6.7ae4ac","wires":[["515f275f.47d888"]]},{"id":"a9455b72.3c8be8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1095.9361877441406,"y":2344.4011573791504,"z":"349cd3c6.7ae4ac","wires":[["b569280.fe633d8","5d7e9df0.a4b464","a8eaf985.0af738","8aaeaea5.5564","6dead66c.9a7628"]]},{"id":"f4b6e870.76a488","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":491.7899513244629,"y":2398.2953033447266,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"b569280.fe633d8","type":"switchNode","name":"switch: eipam-ip-block.level","xml":"<switch test=\"`$eipam-ip-block.level`\">","comments":"","outputs":1,"x":1311.6146812438965,"y":2335.1869230270386,"z":"349cd3c6.7ae4ac","wires":[["7763293e.d8afb8","57135bde.54d0f4"]]},{"id":"7763293e.d8afb8","type":"other","name":"1","xml":"<outcome value='1'>","comments":"","outputs":1,"x":1502.8248672485352,"y":2312.7581419944763,"z":"349cd3c6.7ae4ac","wires":[["33c3acd0.2d0594"]]},{"id":"57135bde.54d0f4","type":"other","name":"Other","xml":"<outcome value='Other'>","comments":"","outputs":1,"x":1499.110610961914,"y":2354.900963783264,"z":"349cd3c6.7ae4ac","wires":[["90e8ec58.75872"]]},{"id":"c9a24ebf.0b46c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value='failed to update EIPAM_IP_POOLS .' />\n","comments":"","x":2427.1304244995117,"y":2001.458854675293,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"9ad840a2.e8024","type":"failure","name":"failure","xml":"<outcome value='failure'>","outputs":1,"x":1966.3796501159668,"y":2465.34432220459,"z":"349cd3c6.7ae4ac","wires":[["c9a24ebf.0b46c"]]},{"id":"5ee60164.3bc0a","type":"failure","name":"failure","xml":"<outcome value='failure'>","outputs":1,"x":1908.3797798156738,"y":1999.772689819336,"z":"349cd3c6.7ae4ac","wires":[["c9a24ebf.0b46c"]]},{"id":"eee028af.a5deb8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1266.6526718139648,"y":344.5714454650879,"z":"349cd3c6.7ae4ac","wires":[["6b13034.09e54fc"]]},{"id":"1c016b1c.b5d1e5","type":"not-found","name":"not-found","xml":"<outcome value=\"not-found\">","comments":"","outputs":1,"x":1267.295555114746,"y":417.8571844100952,"z":"349cd3c6.7ae4ac","wires":[["c074e0c3.e9003"]]},{"id":"c95edad7.418dc8","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n\t<parameter name=\"error-code\" value=\"200\" />\n","comments":"","x":234.4741554260254,"y":2420.5018463134766,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"3b05b3c5.afdfac","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1002.0355529785156,"y":1608.4868717193604,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"89b951c4.efe42","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"network-topology-operation\"/>\n<parameter name=\"field3\" value=\"eipam-create-generic-pool\"/>\n<parameter name=\"field4\" value=\"`$network-model.eipam-v4-address-plan`\"/>\n<parameter name=\"field5\" value=\"`$v4FQPN-output.pools[$eipam-ip-block.level - 1].key-value`\"/>\n<parameter name=\"field6\" value=\"Level already exists, SKIP.\"/>\n<parameter name=\"field7\" value=\"`$eipam-ip-block.level`\"/>\n<parameter name=\"field8\" value=\"`$tmp.eipam-pool-row.pool-id`\"/>\n","comments":"","outputs":1,"x":1582.7397842407227,"y":375.5714454650879,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"267f5e4a.4aee02","type":"other","name":"Other","xml":"<outcome value='Other'>","comments":"","outputs":1,"x":1051.8256721496582,"y":657.5000505447388,"z":"349cd3c6.7ae4ac","wires":[["1967a14e.6f32ef"]]},{"id":"c0e8aebf.eced3","type":"switchNode","name":"test:eipam-pool.v4.pre-existing","xml":"<switch test=\"`$eipam-pool.v4.pre-existing`\">","comments":"","outputs":1,"x":810.2509269714355,"y":2010.1727600097656,"z":"349cd3c6.7ae4ac","wires":[["d32b5a06.7f43f8","693b4d5b.834e94"]]},{"id":"4342f9af.5328e8","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":616.2509269714355,"y":2013.4228820800781,"z":"349cd3c6.7ae4ac","wires":[["c0e8aebf.eced3"]]},{"id":"515f275f.47d888","type":"block","name":"block ","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":611.6438751220703,"y":2334.3515272140503,"z":"349cd3c6.7ae4ac","wires":[["1fefac22.b6c6f4"]]},{"id":"1fefac22.b6c6f4","type":"switchNode","name":"test: eipam-pool.v6.pre-existing","xml":"<switch test=\"`$eipam-pool.v6.pre-existing`\">","comments":"","outputs":1,"x":813.5010414123535,"y":2333.3514556884766,"z":"349cd3c6.7ae4ac","wires":[["a4d411ea.2edae","f5ce7b34.bcca48"]]},{"id":"d32b5a06.7f43f8","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":1031.3610191345215,"y":2055.3943481445312,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"693b4d5b.834e94","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":1035.289463043213,"y":1845.6444931030273,"z":"349cd3c6.7ae4ac","wires":[["9cd666e7.72ced8"]]},{"id":"a4d411ea.2edae","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":1066.4322242736816,"y":2454.2872982025146,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"f5ce7b34.bcca48","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":1090.2179489135742,"y":2288.715941429138,"z":"349cd3c6.7ae4ac","wires":[["a9455b72.3c8be8"]]},{"id":"9b4b3a87.ce0398","type":"switchNode","name":"switch: tmp.create-v4-pool-flag","xml":"<switch test=\"`$tmp.create-v4-pool-flag`\">","comments":"","outputs":1,"x":309.80603790283203,"y":1623.3585796356201,"z":"349cd3c6.7ae4ac","wires":[["79659e31.be535","bba0e210.057fc"]]},{"id":"79659e31.be535","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":519.0917472839355,"y":1623.9300775527954,"z":"349cd3c6.7ae4ac","wires":[["629efca9.657ab4"]]},{"id":"ef22703a.ce7a1","type":"switchNode","name":"switch: tmp.create-v6-pool-flag","xml":"<switch test=\"`$tmp.create-v6-pool-flag`\">","comments":"","outputs":1,"x":407.0202827453613,"y":1749.3227548599243,"z":"349cd3c6.7ae4ac","wires":[["fe3d8960.5d3ed8"]]},{"id":"fe3d8960.5d3ed8","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":618.4285621643066,"y":1751.0581455230713,"z":"349cd3c6.7ae4ac","wires":[["629efca9.657ab4"]]},{"id":"148249f9.846256","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"network-topology-operation\"/>\n<parameter name=\"field3\" value=\"eipam-create-generic-pool\"/>\n<parameter name=\"field4\" value=\"`$network-model.eipam-v4-address-plan`\"/>\n<parameter name=\"field5\" value=\"`$key-name`\"/>\n<parameter name=\"field6\" value=\"`$key-value`\"/>\n<parameter name=\"field7\" value=\"`$tmp.network_instance_group_id`\"/>\n<parameter name=\"field8\" value=\"`$eipam-ip-block.level`\"/>\n<parameter name=\"field9\" value=\"`$network-model.network-role`\"/>\n<parameter name=\"field10\" value=\"`$tmp.network-id`\"/>\n<parameter name=\"field11\" value=\"Saving to EIPAM_IP_POOLS table.\"/>\n","comments":"","outputs":1,"x":1207.8330917358398,"y":1992.5449447631836,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"2e3df561.44defa","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1418.4905166625977,"y":380.5714454650879,"z":"349cd3c6.7ae4ac","wires":[["89b951c4.efe42","802a8043.cc9aa"]]},{"id":"802a8043.cc9aa","type":"set","name":"set eipam-pool.v4.pre-existing to Y","xml":"<set>\n\t<parameter name=\"eipam-pool.v4.pre-existing\" value=\"Y\"/>\n","comments":"","x":1651.4905014038086,"y":415.8214473724365,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"6d156273.b7a25c","type":"set","name":"set EIPAM plan info for createPool","xml":"<set>\n\t<parameter name=\"network-topology-identifier-structure.eipam-v4-address-plan\" value=\"`$network-model.eipam-v4-address-plan`\"/>\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].plan-name\" value=\"`$network-model.eipam-v4-address-plan`\"/>\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].requests_length\" value=\"1\"/>\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].allocate-subnet-flag\" value=\"`$tmp.allocate-subnet-flag`\"/>\t\n\t<!-- Number of Pool Levels -->\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].requests[0].pools_length\" value=\"`$eipam-ip-block.level`\"/>\n","comments":"subnet and subnet_keys are deleted in the EIPAMPlugin","x":1847.6786270141602,"y":614.2857093811035,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"99a858ec.71d5a8","type":"comment","name":"Required INPUTS","info":"Pre-requisites: \n\tThe levels are called in sequence starting at level 1,2,...\n\tso that the previous levels are created already.\n\tWorking with current plan: eipam-ip-block.plans[$eipam-ip-block.plans_length]\n\t\nOptional INPUTS:\n\ttmp.qip-pool - for level 1 if needed\n\ttmp.allocate-subnet-flag - set to if EIPAM should allocate subnet automatically or N (Default to Y)\t\n\ttmp.network-instance-group-id\n\t\nrequired INPUTS:\n\n\tnetwork-model - for Tosca model\n\ttmp.skip-first-level - set to Y if already created in EIPAM\n\teipam-ip-block.level - the level for createPool\n\ttmp.network-id\n\nSet the necessary values as inputs for the key_values \nfor 1 to current level as needed for EIPAM operations:\n\nv4FQPN-output.pools[].key-name\nv4FQPN-output.pools[].key-value\nv6FQPN-output.pools[].key-name\nv6FQPN-output.pools[].key-value\n\n(ie - Calling DG should set v[4|6]FQPN-output = generate-FQPN-output)\n\n\n","comments":"","x":650.0000076293945,"y":88.75000190734863,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"cc4c7f39.1f5b3","type":"for","name":"for l4-idx: eipam-ip-block.level","xml":"<for index=\"l4-idx\" start=\"0\" end=\"`$eipam-ip-block.level`\">","comments":"","outputs":1,"x":1836.9643020629883,"y":712.6785888671875,"z":"349cd3c6.7ae4ac","wires":[["12ba335c.d69add"]]},{"id":"12ba335c.d69add","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2028.4127922058105,"y":709.9483642578125,"z":"349cd3c6.7ae4ac","wires":[["6f8e94f6.a5cbcc","b036d114.4c11"]]},{"id":"16f1102a.b3604","type":"set","name":"set create-v4-pool-flag to Y","xml":"<set>\n\t<parameter name=\"tmp.create-v4-pool-flag\" value=\"Y\" />","comments":"subnet and subnet_keys are deleted in the EIPAMPlugin","x":1829.4642944335938,"y":652.6786365509033,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"39949545.ce2a6a","type":"switchNode","name":"switch: tmp.skip-first-level","xml":"<switch test=\"`$tmp.skip-first-level`\">","comments":"","outputs":1,"x":1373.0357818603516,"y":559.6428918838501,"z":"349cd3c6.7ae4ac","wires":[["12fbf51.44ff80b","fa9f3f47.e86f6","f9db9f93.178c"]]},{"id":"12fbf51.44ff80b","type":"other","name":"NULL","xml":"<outcome value=\"\">","comments":"","outputs":1,"x":1529.3215255737305,"y":589.6071681976318,"z":"349cd3c6.7ae4ac","wires":[["1967a14e.6f32ef"]]},{"id":"1967a14e.6f32ef","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1638.571678161621,"y":653.1786603927612,"z":"349cd3c6.7ae4ac","wires":[["16f1102a.b3604","cc4c7f39.1f5b3","60344065.a233","6d156273.b7a25c"]]},{"id":"fa9f3f47.e86f6","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":1486.3930053710938,"y":626.1184854507446,"z":"349cd3c6.7ae4ac","wires":[["1967a14e.6f32ef"]]},{"id":"d0744c26.6d381","type":"switchNode","name":"test: tmp.allocate-subnet-flag","xml":"<switch test=\"`$tmp.allocate-subnet-flag`\">","comments":"","outputs":1,"x":393.75,"y":223.75,"z":"349cd3c6.7ae4ac","wires":[["79aa4ca5.9b2464","350961c1.54fbfe","aca7f525.668318"]]},{"id":"350961c1.54fbfe","type":"other","name":"NULL","xml":"<outcome value=\"\">","comments":"","outputs":1,"x":607.0000686645508,"y":193.00003337860107,"z":"349cd3c6.7ae4ac","wires":[["40365c01.9fc214"]]},{"id":"79aa4ca5.9b2464","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":602.2501316070557,"y":239.00000381469727,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"40365c01.9fc214","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":758.7500610351562,"y":191.75000381469727,"z":"349cd3c6.7ae4ac","wires":[["9883bb21.fa3008"]]},{"id":"aca7f525.668318","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":606.7500610351562,"y":274.68993759155273,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"9883bb21.fa3008","type":"set","name":"set tmp.allocate-subnet-flag to Y","xml":"<set>\n\t<parameter name=\"tmp.allocate-subnet-flag\" value=\"Y\"/>\t\n","comments":"subnet and subnet_keys are deleted in the EIPAMPlugin","x":983.75,"y":193.75,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"749d6519.db75ac","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1182.857192993164,"y":514.2857837677002,"z":"349cd3c6.7ae4ac","wires":[["39949545.ce2a6a","2b778ea.2707c72"]]},{"id":"e579441a.7f47b8","type":"set","name":"set EIPAM parent pool","xml":"<set>\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].parent-pool\" value=\"`$tmp.qip-pool`\"/>\n\t<parameter name=\"tmp.v4-qip-pool\" value=\"`$tmp.qip-pool`\" />","comments":"subnet and subnet_keys are deleted in the EIPAMPlugin","x":1686.9643859863281,"y":511.07141876220703,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"2b778ea.2707c72","type":"switchNode","name":"test: tmp.qip-pool","xml":"<switch test=\"`$tmp.qip-pool`\">","comments":"","outputs":1,"x":1350.357177734375,"y":504.4642868041992,"z":"349cd3c6.7ae4ac","wires":[["4e871e70.f869b","a9ca5136.ec129"]]},{"id":"4e871e70.f869b","type":"other","name":"Other","xml":"<outcome value='Other'>","comments":"","outputs":1,"x":1511.893211364746,"y":511.8571548461914,"z":"349cd3c6.7ae4ac","wires":[["e579441a.7f47b8"]]},{"id":"6f7e9759.3b93f8","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"network-topology-operation\"/>\n<parameter name=\"field3\" value=\"eipam-create-generic-pool\"/>\n<parameter name=\"field4\" value=\"`$eipam-ip-block.plans[$eipam-ip-block.plans_length].plan-name`\"/>\n<parameter name=\"field5\" value=\"`$eipam-ip-block.plans[$eipam-ip-block.plans_length].requests[0].pools[$l6-idx].key-name`\"/>\n<parameter name=\"field6\" value=\"`$eipam-ip-block.plans[$eipam-ip-block.plans_length].requests[0].pools[$l6-idx].key-value`\"/>\n<parameter name=\"field7\" value=\"`$l6-idx`\"/>\n","comments":"","outputs":1,"x":2278.2092895507812,"y":1451.4285888671875,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"5960258c.27786c","type":"set","name":"set EIPAM pool info at each Level","xml":"<set>\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].requests[0].pools[$l6-idx].key-name\" value=\"`$v6FQPN-output.pools[$l6-idx].key-name`\"/>\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].requests[0].pools[$l6-idx].key-value\" value=\"`$v6FQPN-output.pools[$l6-idx].key-value`\"/>\n","comments":"subnet and subnet_keys are deleted in the EIPAMPlugin","x":2353.0213108062744,"y":1406.9743022918701,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"8ef01746.1df9e8","type":"set","name":"set: eipam-ip-block.plans[]++","xml":"<set>\n\t<parameter name=\"eipam-ip-block.plans_length\" value=\"`$eipam-ip-block.plans_length + 1`\" />","comments":"","x":1927.280174255371,"y":1468.0415649414062,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"8245ad31.919cc","type":"get-resource","name":"DB - validate if pool exists for level already","xml":"<get-resource\n        plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n        resource='SQL'\n        key=\"SELECT * FROM EIPAM_IP_POOLS where plan_name = $network-model.eipam-v6-address-plan and level = $eipam-ip-block.level and key_value = $v6FQPN-output.pools[$level].key-value ;\"\n        pfx='tmp.eipam-pool-row'>\n\n","comments":"","outputs":1,"x":1051.0260543823242,"y":1042.1170129776,"z":"349cd3c6.7ae4ac","wires":[["a035950c.4940f8","6572ecde.eb0774","d68a80a0.6237a"]]},{"id":"99ab26ae.ab8458","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"tmp.eipam-error\" value=\"true\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"Query to DB table EIPAM_IP_POOLS failed.\" />\n\t","comments":"","x":1518.0616607666016,"y":1052.295566558838,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"a035950c.4940f8","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1371.3117446899414,"y":1090.295566558838,"z":"349cd3c6.7ae4ac","wires":[["43a92726.c8e168"]]},{"id":"b17f7caf.12201","type":"switchNode","name":"test: eipam-ip-block.level","xml":"<switch test=\"`$l-idx`\">","comments":"","outputs":1,"x":969.2856597900391,"y":1220.6885433197021,"z":"349cd3c6.7ae4ac","wires":[["6279ea9f.3b4084","c8dd7ca.3d7fd8","6e576d4d.d27f54"]]},{"id":"6279ea9f.3b4084","type":"other","name":"level 1","xml":"<outcome value='1'>","comments":"","outputs":1,"x":1158.1072998046875,"y":1223.474190711975,"z":"349cd3c6.7ae4ac","wires":[["273ff0a5.5e023"]]},{"id":"c8dd7ca.3d7fd8","type":"other","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1160.6787109375,"y":1325.3313083648682,"z":"349cd3c6.7ae4ac","wires":[["df65eb6a.a8e218"]]},{"id":"df65eb6a.a8e218","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"tmp.eipam-error\" value=\"true\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"Please set the eipam-ip-block.level for appropriate EIPAM request.\" />\n\t","comments":"","x":1287.9286079406738,"y":1324.3313336372375,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"6572ecde.eb0774","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1370.1735305786133,"y":1054.295566558838,"z":"349cd3c6.7ae4ac","wires":[["99ab26ae.ab8458"]]},{"id":"d68a80a0.6237a","type":"not-found","name":"not-found","xml":"<outcome value=\"not-found\">","comments":"","outputs":1,"x":1370.8164138793945,"y":1127.5813055038452,"z":"349cd3c6.7ae4ac","wires":[["b17f7caf.12201"]]},{"id":"b25437a6.8dc228","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"network-topology-operation\"/>\n<parameter name=\"field3\" value=\"eipam-create-generic-pool\"/>\n<parameter name=\"field4\" value=\"`$network-model.eipam-v6-address-plan`\"/>\n<parameter name=\"field5\" value=\"`$v6FQPN-output.pools[$eipam-ip-block.level - 1].key-value`\"/>\n<parameter name=\"field6\" value=\"Level already exists, SKIP.\"/>\n<parameter name=\"field7\" value=\"`$eipam-ip-block.level`\"/>\n<parameter name=\"field8\" value=\"`$tmp.eipam-pool-row.pool-id`\"/>\n","comments":"","outputs":1,"x":1686.260643005371,"y":1085.295566558838,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"6e576d4d.d27f54","type":"other","name":"Other","xml":"<outcome value='Other'>","comments":"","outputs":1,"x":1155.3465309143066,"y":1367.2241716384888,"z":"349cd3c6.7ae4ac","wires":[["d64c9608.18e318"]]},{"id":"43a92726.c8e168","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1522.011375427246,"y":1090.295566558838,"z":"349cd3c6.7ae4ac","wires":[["b25437a6.8dc228","27947b52.6e6eb4"]]},{"id":"27947b52.6e6eb4","type":"set","name":"set eipam-pool.v6.pre-existing to Y","xml":"<set>\n\t<parameter name=\"eipam-pool.v6.pre-existing\" value=\"Y\"/>\n","comments":"","x":1755.011360168457,"y":1125.5455684661865,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"ecaefc12.01692","type":"set","name":"set EIPAM v6 plan info for createPool","xml":"<set>\n\t<parameter name=\"network-topology-identifier-structure.eipam-v6-address-plan\" value=\"`$network-model.eipam-v6-address-plan`\"/>\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].plan-name\" value=\"`$network-model.eipam-v6-address-plan`\"/>\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].requests_length\" value=\"1\"/>\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].allocate-subnet-flag\" value=\"`$tmp.allocate-subnet-flag`\"/>\t\n\t<!-- Number of Pool Levels -->\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].requests[0].pools_length\" value=\"`$eipam-ip-block.level`\"/>\n","comments":"subnet and subnet_keys are deleted in the EIPAMPlugin","x":1969.7708435058594,"y":1319.7241830825806,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"ca1ca600.0912e8","type":"for","name":"for l6-idx: eipam-ip-block.level","xml":"<for index=\"l6-idx\" start=\"0\" end=\"`$eipam-ip-block.level`\">","comments":"","outputs":1,"x":1940.4851608276367,"y":1422.4027099609375,"z":"349cd3c6.7ae4ac","wires":[["44d24717.ee3398"]]},{"id":"44d24717.ee3398","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2131.933650970459,"y":1419.6724853515625,"z":"349cd3c6.7ae4ac","wires":[["5960258c.27786c","6f7e9759.3b93f8"]]},{"id":"d8e2213f.4e9bf","type":"set","name":"set create-v6-pool-flag to Y","xml":"<set>\n\t<parameter name=\"tmp.create-v6-pool-flag\" value=\"Y\" />","comments":"subnet and subnet_keys are deleted in the EIPAMPlugin","x":1932.9851531982422,"y":1362.4027576446533,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"2fe5d369.146c8c","type":"switchNode","name":"switch: tmp.skip-first-level","xml":"<switch test=\"`$tmp.skip-first-level`\">","comments":"","outputs":1,"x":1476.556640625,"y":1269.3670129776,"z":"349cd3c6.7ae4ac","wires":[["3c832833.fedcd8","924a97ca.3aa518","ea85d22d.b1c9"]]},{"id":"3c832833.fedcd8","type":"other","name":"NULL","xml":"<outcome value=\"\">","comments":"","outputs":1,"x":1628.5567169189453,"y":1303.6169919967651,"z":"349cd3c6.7ae4ac","wires":[["d64c9608.18e318"]]},{"id":"d64c9608.18e318","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1742.0925369262695,"y":1362.9027814865112,"z":"349cd3c6.7ae4ac","wires":[["d8e2213f.4e9bf","ca1ca600.0912e8","8ef01746.1df9e8","ecaefc12.01692"]]},{"id":"924a97ca.3aa518","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":1589.913948059082,"y":1340.128291130066,"z":"349cd3c6.7ae4ac","wires":[["d64c9608.18e318"]]},{"id":"273ff0a5.5e023","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1286.3780517578125,"y":1224.0099048614502,"z":"349cd3c6.7ae4ac","wires":[["2fe5d369.146c8c","aa66ddb2.84543"]]},{"id":"f9459ac1.0b5ea8","type":"set","name":"set EIPAM parent pool","xml":"<set>\n\t<parameter name=\"eipam-ip-block.plans[$eipam-ip-block.plans_length].parent-pool\" value=\"`$tmp.qip-pool`\"/>\n\t<parameter name=\"tmp.v6-qip-pool\" value=\"`$tmp.qip-pool`\" />","comments":"subnet and subnet_keys are deleted in the EIPAMPlugin","x":1790.4852447509766,"y":1220.795539855957,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"aa66ddb2.84543","type":"switchNode","name":"test: tmp.qip-pool","xml":"<switch test=\"`$tmp.qip-pool`\">","comments":"","outputs":1,"x":1453.8780364990234,"y":1214.1884078979492,"z":"349cd3c6.7ae4ac","wires":[["5237408e.f3ce4","8ead477f.65c058"]]},{"id":"ea85d22d.b1c9","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":1676.8426780700684,"y":1268.7241878509521,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"5d7e9df0.a4b464","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"network-topology-operation\"/>\n<parameter name=\"field3\" value=\"eipam-create-network-role-pool\"/>\n<parameter name=\"field4\" value=\"`$network-model.eipam-v6-address-plan`\"/>\n<parameter name=\"field5\" value=\"`$v6FQPN-output.pools[$level].key-name`\"/>\n<parameter name=\"field6\" value=\"`$v6FQPN-output.pools[$level].key-value`\"/>\n<parameter name=\"field7\" value=\"`$tmp.network_instance_group_id`\"/>\n<parameter name=\"field8\" value=\"`$eipam-ip-block.level`\"/>\n<parameter name=\"field9\" value=\"`$network-model.network-role`\"/>\n<parameter name=\"field10\" value=\"`$tmp.network-id`\"/>\n<parameter name=\"field11\" value=\"Saving to EIPAM_IP_POOLS table.\"/>\n","comments":"","outputs":1,"x":1258.214454650879,"y":2434.642780303955,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"a9ca5136.ec129","type":"other","name":"NULL","xml":"<outcome value=\"\">","comments":"","outputs":1,"x":1511.4285888671875,"y":471.4285888671875,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"f9db9f93.178c","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":1564.2857666015625,"y":555.7142944335938,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"8ead477f.65c058","type":"other","name":"Other","xml":"<outcome value='Other'>","comments":"","outputs":1,"x":1611.4285278320312,"y":1225.7143173217773,"z":"349cd3c6.7ae4ac","wires":[["f9459ac1.0b5ea8"]]},{"id":"5237408e.f3ce4","type":"other","name":"NULL","xml":"<outcome value=\"\">","comments":"","outputs":1,"x":1612.3925857543945,"y":1189.5714778900146,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"bba0e210.057fc","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":504.2857131958008,"y":1675.7144141197205,"z":"349cd3c6.7ae4ac","wires":[["ef22703a.ce7a1"]]},{"id":"69e98e43.ccaf","type":"set","name":"set: parent_pool","xml":"<set>\n\t<parameter name=\"parent_pool\" value=\"`$tmp.v4-qip-pool`\" />\n\t<parameter name=\"level\" value=\"`$eipam-ip-block.level - 1`\" />\n","comments":"","x":1718.5716094970703,"y":1860.7147188186646,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"8a435f40.685a8","type":"set","name":"set: parent_pool","xml":"<set>\n\t<parameter name=\"parent_pool\" value=\"`$v4FQPN-output.pools[$eipam-ip-block.level - 2].key-value`\" />\n\t\t<parameter name=\"level\" value=\"`$eipam-ip-block.level - 1`\" />\t","comments":"","x":1721.5279693603516,"y":1932.8572692871094,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"67dc159b.560f4c","type":"switchNode","name":"test: subnet-use","xml":"<switch test=\"`$network-instance-group-data.subnet-assignment-policy.subnet-use`\">","comments":"","outputs":1,"x":1228.0356979370117,"y":2046.6071891784668,"z":"349cd3c6.7ae4ac","wires":[["8e2c4f29.bc129","69384818.7951d8","2232c618.935bda"]]},{"id":"8e2c4f29.bc129","type":"other","name":"shared","xml":"<outcome value='shared'>","comments":"","outputs":1,"x":1428.5715084075928,"y":1992.8571434020996,"z":"349cd3c6.7ae4ac","wires":[["b76edc1c.d7929"]]},{"id":"fcf7941a.f817c8","type":"save","name":"insert EIPAM_IP_POOLS for V4","xml":"<save\n        plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n        resource='SQL'\n        key=\"INSERT EIPAM_IP_POOLS\n             SET\n             key_name = $key-name ,\n             key_value = $key-value ,\n             level = $eipam-ip-block.level ,\n             plan_name = $network-model.eipam-v4-address-plan ,\n             address_family = $network-model.ipv4-ip-version ,\n             parent_pool = $parent_pool ,\n             service_instance_id = $network-topology-operation-input.service-information.service-instance-id ,\n             network_id = $tmp.network-id ; \"\n    force='true'\n        pfx='pfx.eipam-v4pool-row'>\n","comments":"","outputs":1,"x":1671.4285736083984,"y":2041.428379058838,"z":"349cd3c6.7ae4ac","wires":[["5ee60164.3bc0a"]]},{"id":"69384818.7951d8","type":"other","name":"Other","xml":"<outcome value='Other'>","comments":"","outputs":1,"x":1428.5714111328125,"y":2037.1429443359375,"z":"349cd3c6.7ae4ac","wires":[["fcf7941a.f817c8"]]},{"id":"a8eaf985.0af738","type":"switchNode","name":"test: subnet-use","xml":"<switch test=\"`$network-instance-group-data.subnet-assignment-policy.subnet-use`\">","comments":"","outputs":1,"x":1281.7859420776367,"y":2490.7143983840942,"z":"349cd3c6.7ae4ac","wires":[["c28f894c.7c5c68","11fb77d9.c1dd48","7284f4.36a8db0c"]]},{"id":"45c1f421.d35afc","type":"save","name":"insert EIPAM_IP_POOLS for other level V6","xml":"<save\n        plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n        resource='SQL'\n        key=\"INSERT EIPAM_IP_POOLS\n             SET\n             key_name = $v6FQPN-output.pools[$level].key-name ,\n             key_value = $v6FQPN-output.pools[$level].key-value ,\n             level = $eipam-ip-block.level ,\n             plan_name = $network-model.eipam-v6-address-plan ,\n             address_family = $network-model.ipv6-ip-version ,\n             parent_pool = $parent_pool ,\n             service_instance_id = $network-topology-operation-input.service-information.service-instance-id ,\n             network_id = $tmp.network-id ,\n             network_instance_group_id = $tmp.network-instance-group-id ; \"\n    force='true'\n        pfx='pfx.eipam-v6pool-row'>\n","comments":"","outputs":1,"x":1708.571548461914,"y":2435.7147178649902,"z":"349cd3c6.7ae4ac","wires":[["9ad840a2.e8024"]]},{"id":"c28f894c.7c5c68","type":"other","name":"shared","xml":"<outcome value='shared'>","comments":"","outputs":1,"x":1460.0000610351562,"y":2437.1430492401123,"z":"349cd3c6.7ae4ac","wires":[["45c1f421.d35afc"]]},{"id":"11fb77d9.c1dd48","type":"other","name":"Other","xml":"<outcome value='Other'>","comments":"","outputs":1,"x":1459.999963760376,"y":2481.42885017395,"z":"349cd3c6.7ae4ac","wires":[["d035f4fd.cdd6f8"]]},{"id":"d035f4fd.cdd6f8","type":"save","name":"insert EIPAM_IP_POOLS for other level V6","xml":"<save\n        plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n        resource='SQL'\n        key=\"INSERT EIPAM_IP_POOLS\n             SET\n             key_name = $v6FQPN-output.pools[$level].key-name ,\n             key_value = $v6FQPN-output.pools[$level].key-value ,\n             level = $eipam-ip-block.level ,\n             plan_name = $network-model.eipam-v6-address-plan ,\n             address_family = $network-model.ipv6-ip-version ,\n             parent_pool = $parent_pool ,\n             service_instance_id = $network-topology-operation-input.service-information.service-instance-id ,\n             network_id = $tmp.network-id ; \"\n    force='true'\n        pfx='pfx.eipam-v6pool-row'>\n","comments":"","outputs":1,"x":1702.8571166992188,"y":2480.0002269744873,"z":"349cd3c6.7ae4ac","wires":[["9ad840a2.e8024"]]},{"id":"33c3acd0.2d0594","type":"set","name":"set: parent_pool","xml":"<set>\n\t<parameter name=\"parent_pool\" value=\"`$tmp.v6-qip-pool`\" />\n\t<parameter name=\"level\" value=\"`$eipam-ip-block.level - 1`\" />","comments":"","x":1657.1428833007812,"y":2314.2858715057373,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"90e8ec58.75872","type":"set","name":"set: parent_pool","xml":"<set>\n\t<parameter name=\"parent_pool\" value=\"`$v6FQPN-output.pools[$eipam-ip-block.level - 2].key-value`\" />\n\t<parameter name=\"level\" value=\"`$eipam-ip-block.level - 1`\" />","comments":"","x":1661.4285316467285,"y":2351.428692817688,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"2232c618.935bda","type":"other","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1428.5714111328125,"y":2080,"z":"349cd3c6.7ae4ac","wires":[["fcf7941a.f817c8"]]},{"id":"7284f4.36a8db0c","type":"other","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1462.8571166992188,"y":2527.1430492401123,"z":"349cd3c6.7ae4ac","wires":[["d035f4fd.cdd6f8"]]},{"id":"d77f382b.bfda98","type":"set","name":"set: key-name/key-value","xml":"<set>\n\t<parameter name=\"key-name\" value=\"`$v4FQPN-output.pools[$eipam-ip-block.level - 1].key-name`\" />\t\n\t<parameter name=\"key-value\" value=\"`$v4FQPN-output.pools[$eipam-ip-block.level - 1].key-value`\" />\t","comments":"","x":1254.035701751709,"y":1835.1905822753906,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"87c2ca4a.4911b8","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1564.1904888153076,"y":1865.7502603530884,"z":"349cd3c6.7ae4ac","wires":[["69e98e43.ccaf"]]},{"id":"9f65900e.a4ec6","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1562.583309173584,"y":1933.2499752044678,"z":"349cd3c6.7ae4ac","wires":[["8a435f40.685a8"]]},{"id":"8aaeaea5.5564","type":"set","name":"set: key-name/key-value","xml":"<set>\n\t<parameter name=\"key-name\" value=\"`$v6FQPN-output.pools[$eipam-ip-block.level - 1].key-name`\" />\t\n\t<parameter name=\"key-value\" value=\"`$v6FQPN-output.pools[$eipam-ip-block.level - 1].key-value`\" />\t","comments":"","x":1309.2742004394531,"y":2283.4284524917603,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"f6d96e24.6539e","type":"save","name":"insert EIPAM_IP_SUBNETS for V4","xml":"<save\n        plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n        resource='SQL'\n        key=\"INSERT EIPAM_IP_SUBNETS\n             SET\n             entity_id = $eipam-ip-block.createPoolResponse.CreatePoolPlans.CreatePoolPlan[$i].PoolItem.IPDataBlock.IpamPoolAllocId ,\n             service_type = $tmp.service-type ,\n             ip_address = $eipam-ip-block.createPoolResponse.CreatePoolPlans.CreatePoolPlan[$i].PoolItem.IPDataBlock.IPAddress ,\n             prefix_length = $eipam-ip-block.createPoolResponse.CreatePoolPlans.CreatePoolPlan[$i].PoolItem.IPDataBlock.Mask ,\n             plan_name = $network-model.eipam-v4-address-plan ,\n             status = 'ALLOCATED' ,\n             pool_id = $tmp.eipam-pool-row.pool-id ,\n             address_family = $network-model.ipv4-ip-version ,\n             network_id = $tmp.network-id ; \"\n    force='true'\n        pfx='pfx.eipam-subnet-row'>\n","comments":"","outputs":1,"x":3160.4780883789062,"y":2205.870002746582,"z":"349cd3c6.7ae4ac","wires":[["e9053df.f0604c","6375c043.7adc4"]]},{"id":"cafa4b39.a1af78","type":"save","name":"insert EIPAM_IP_SUBNET_KEYS for V4","xml":"<save\n        plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n        resource='SQL'\n        key=\"INSERT EIPAM_IP_SUBNET_KEYS\n             SET\n             entity_id = $eipam-ip-block.createPoolResponse.CreatePoolPlans.CreatePoolPlan[$i].PoolItem.IPDataBlock.IpamPoolAllocId ,\n             key_name = $key-name ,\n             key_value = $key-value ,\n             level = $eipam-ip-block.level ; \"\n    force='true'\n        pfx='pfx.eipam-v4subnet-key-row'>\n","comments":"","outputs":1,"x":3177.2042541503906,"y":2268.1323432922363,"z":"349cd3c6.7ae4ac","wires":[["6375c043.7adc4","2487c99c.f9fd46"]]},{"id":"97205152.6b6c3","type":"other","name":"true","xml":"<outcome value='true'>","comments":"","outputs":1,"x":1329.4885482788086,"y":2125.8693132400513,"z":"349cd3c6.7ae4ac","wires":[["8ed89f0a.ac09a"]]},{"id":"a5ab262c.107d28","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1705.968864440918,"y":2143.8970165252686,"z":"349cd3c6.7ae4ac","wires":[["5111f0a2.85eb1","4d28742f.b33f5c"]]},{"id":"b9aa3822.9ae098","type":"switchNode","name":"switch: leaf level","xml":"<switch test=\"`$eipam-ip-block.level == $eipam-ip-block.getPlanTopologyResponse.TopologyDetails_length`\">","comments":"","outputs":1,"x":1177.583309173584,"y":2128.4999117851257,"z":"349cd3c6.7ae4ac","wires":[["97205152.6b6c3"]]},{"id":"d0edbeb4.e9de1","type":"save","name":"insert EIPAM_IP_SUBNETS for V6","xml":"<save\n        plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n        resource='SQL'\n        key=\"INSERT EIPAM_IP_SUBNETS\n             SET\n             entity_id = $eipam-ip-block.createPoolResponse.CreatePoolPlans.CreatePoolPlan[$i].PoolItem.IPDataBlock.IpamPoolAllocId ,\n             service_type = $tmp.service-type ,\n             ip_address = $eipam-ip-block.createPoolResponse.CreatePoolPlans.CreatePoolPlan[$i].PoolItem.IPDataBlock.IPAddress ,\n             prefix_length = $eipam-ip-block.createPoolResponse.CreatePoolPlans.CreatePoolPlan[$i].PoolItem.IPDataBlock.Mask ,\n             plan_name = $network-model.eipam-v6-address-plan ,\n             status = 'ALLOCATED' ,\n             pool_id = $tmp.eipam-pool-row.pool-id ,\n             address_family = $network-model.ipv6-ip-version ,\n             network_id = $tmp.network-id ; \"\n    force='true'\n        pfx='pfx.eipam-subnet-row'>\n","comments":"","outputs":1,"x":3173.416717529297,"y":2631.166714668274,"z":"349cd3c6.7ae4ac","wires":[["56144445.a583bc","be66d1a6.069a6"]]},{"id":"2446c5b3.dabaca","type":"save","name":"insert EIPAM_IP_SUBNET_KEYS for V4","xml":"<save\n        plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n        resource='SQL'\n        key=\"INSERT EIPAM_IP_SUBNET_KEYS\n             SET\n             entity_id = $eipam-ip-block.createPoolResponse.CreatePoolPlans.CreatePoolPlan[$i].PoolItem.IPDataBlock.IpamPoolAllocId ,\n             key_name = $key-name ,\n             key_value = $key-value ,\n             level = $eipam-ip-block.level ; \"\n    force='true'\n        pfx='pfx.eipam-v4subnet-key-row'>\n","comments":"","outputs":1,"x":3190.5595474243164,"y":2672.595308303833,"z":"349cd3c6.7ae4ac","wires":[["941f0eab.7d1d5","be66d1a6.069a6"]]},{"id":"65c9e356.4fdc0c","type":"other","name":"true","xml":"<outcome value='true'>","comments":"","outputs":1,"x":1338.6788482666016,"y":2584.9170866012573,"z":"349cd3c6.7ae4ac","wires":[["13e55d70.ced513"]]},{"id":"a98ff550.c4df58","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1707.6589889526367,"y":2597.9445333480835,"z":"349cd3c6.7ae4ac","wires":[["6f08cc60.c79504","63f21221.7db1cc"]]},{"id":"6dead66c.9a7628","type":"switchNode","name":"switch: leaf level","xml":"<switch test=\"`$eipam-ip-block.level == $eipam-ip-block.getPlanTopologyResponse.TopologyDetails_length`\">","comments":"","outputs":1,"x":1188.0235061645508,"y":2585.047540664673,"z":"349cd3c6.7ae4ac","wires":[["65c9e356.4fdc0c"]]},{"id":"5111f0a2.85eb1","type":"for","name":"for i: CreatePoolPlan_length","xml":"<for index=\"i\" start=\"0\" end=\"`$eipam-ip-block.createPoolResponse.CreatePoolPlans.CreatePoolPlan_length`\">","comments":"","outputs":1,"x":1942.583351135254,"y":2097.666543006897,"z":"349cd3c6.7ae4ac","wires":[["65f04afd.675004"]]},{"id":"65f04afd.675004","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2135.2819442749023,"y":2097.436333656311,"z":"349cd3c6.7ae4ac","wires":[["2988e93c.4f05f6"]]},{"id":"2988e93c.4f05f6","type":"switchNode","name":"test: same plan ","xml":"<switch test=\"`$network-model.eipam-v4-address-plan == $eipam-ip-block.createPoolResponse.CreatePoolPlans.CreatePoolPlan[$i].PlanName`\">","comments":"","outputs":1,"x":2315.0837059020996,"y":2095.749746322632,"z":"349cd3c6.7ae4ac","wires":[["8483e388.9e957"]]},{"id":"8483e388.9e957","type":"other","name":"true","xml":"<outcome value='true'>","comments":"","outputs":1,"x":2498.833251953125,"y":2096.999755859375,"z":"349cd3c6.7ae4ac","wires":[["50475eee.83591"]]},{"id":"7d1a8415.9aa22c","type":"returnSuccess","name":"CATCH BREAK","xml":"<return status='success'>","comments":"","x":3169.8330688476562,"y":2416.5836839675903,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"6f08cc60.c79504","type":"for","name":"for i: CreatePoolPlan_length","xml":"<for index=\"i\" start=\"0\" end=\"`$eipam-ip-block.createPoolResponse.CreatePoolPlans.CreatePoolPlan_length`\">","comments":"","outputs":1,"x":1926.9165954589844,"y":2514.833553314209,"z":"349cd3c6.7ae4ac","wires":[["4e4c05cd.ebc9bc"]]},{"id":"4e4c05cd.ebc9bc","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2157.1150970458984,"y":2515.853042602539,"z":"349cd3c6.7ae4ac","wires":[["c96dbc73.d1499"]]},{"id":"c96dbc73.d1499","type":"switchNode","name":"test: same plan ","xml":"<switch test=\"`$network-model.eipam-v6-address-plan == $eipam-ip-block.createPoolResponse.CreatePoolPlans.CreatePoolPlan[$i].PlanName`\">","comments":"","outputs":1,"x":2336.9168586730957,"y":2514.16645526886,"z":"349cd3c6.7ae4ac","wires":[["bd1e309b.c1fb3"]]},{"id":"bd1e309b.c1fb3","type":"other","name":"true","xml":"<outcome value='true'>","comments":"","outputs":1,"x":2520.666404724121,"y":2515.416464805603,"z":"349cd3c6.7ae4ac","wires":[["6469b539.0338cc"]]},{"id":"410f3ee.58550c","type":"returnFailure","name":"BREAK","xml":"<return status='failure'>\n","comments":"","x":3214.999988555908,"y":2455.4165897369385,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"e8f56ba7.3673b8","type":"break","name":"break","xml":"<break>\n","comments":"","x":2753.5843200683594,"y":2093.5837326049805,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"1951f009.0aa1a","type":"set","name":"set: index_found","xml":"<set>\n\t<parameter name=\"index_found\" value=\"true\" />\n\t\t","comments":"","x":2783.166534423828,"y":2056.166675567627,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"4d28742f.b33f5c","type":"switchNode","name":"switch: index_found","xml":"<switch test=\"`$index_found`\">","comments":"","outputs":1,"x":1936.91650390625,"y":2162.833251953125,"z":"349cd3c6.7ae4ac","wires":[["3c39e0a.1258f2","5088803d.d1b25","a544f528.31e728"]]},{"id":"45b355f2.ef833c","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2221.916633605957,"y":2162.8333778381348,"z":"349cd3c6.7ae4ac","wires":[["7ba44dde.a58364"]]},{"id":"3c39e0a.1258f2","type":"other","name":"true","xml":"<outcome value='true'>","comments":"","outputs":1,"x":2096.91650390625,"y":2161.583251953125,"z":"349cd3c6.7ae4ac","wires":[["45b355f2.ef833c"]]},{"id":"379eb126.caccae","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value='failed to find plan name in CreatePoolResponse.' />\n","comments":"","x":2266.91650390625,"y":2265.333251953125,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"5088803d.d1b25","type":"other","name":"Other","xml":"<outcome value='Other'>","comments":"","outputs":1,"x":2100.66650390625,"y":2215.333251953125,"z":"349cd3c6.7ae4ac","wires":[["379eb126.caccae"]]},{"id":"a544f528.31e728","type":"other","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":2099.41650390625,"y":2265.333251953125,"z":"349cd3c6.7ae4ac","wires":[["379eb126.caccae"]]},{"id":"63f21221.7db1cc","type":"switchNode","name":"switch: index_found","xml":"<switch test=\"`$index_found`\">","comments":"","outputs":1,"x":1904.41650390625,"y":2596.083251953125,"z":"349cd3c6.7ae4ac","wires":[["a9b096ed.aa1bb8","dc89ff61.e00bc","c1e32151.92a79"]]},{"id":"963711ae.b1054","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2189.416633605957,"y":2596.0833778381348,"z":"349cd3c6.7ae4ac","wires":[["8ea994ce.0783e8"]]},{"id":"a9b096ed.aa1bb8","type":"other","name":"true","xml":"<outcome value='true'>","comments":"","outputs":1,"x":2064.41650390625,"y":2594.833251953125,"z":"349cd3c6.7ae4ac","wires":[["963711ae.b1054"]]},{"id":"b80008cb.7e7ed8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value='failed to find plan name in CreatePoolResponse.' />\n","comments":"","x":2234.41650390625,"y":2698.583251953125,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"dc89ff61.e00bc","type":"other","name":"Other","xml":"<outcome value='Other'>","comments":"","outputs":1,"x":2068.16650390625,"y":2648.583251953125,"z":"349cd3c6.7ae4ac","wires":[["b80008cb.7e7ed8"]]},{"id":"c1e32151.92a79","type":"other","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":2066.91650390625,"y":2698.583251953125,"z":"349cd3c6.7ae4ac","wires":[["b80008cb.7e7ed8"]]},{"id":"28a4cc6b.177c34","type":"break","name":"break","xml":"<break>\n","comments":"","x":2754.4166107177734,"y":2554.833335876465,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"4cf4a1cd.5e6d3","type":"set","name":"set: index_found","xml":"<set>\n\t<parameter name=\"index_found\" value=\"true\" />\n\t\t","comments":"","x":2785.6662979125977,"y":2519.083209991455,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"50475eee.83591","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2628.6665573120117,"y":2093.583360671997,"z":"349cd3c6.7ae4ac","wires":[["1951f009.0aa1a","e8f56ba7.3673b8"]]},{"id":"6469b539.0338cc","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2638.6665573120117,"y":2519.9165382385254,"z":"349cd3c6.7ae4ac","wires":[["4cf4a1cd.5e6d3","28a4cc6b.177c34"]]},{"id":"7ba44dde.a58364","type":"get-resource","name":"DB - validate if pool exists for level already","xml":"<get-resource\n        plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n        resource='SQL'\n        key=\"SELECT * FROM EIPAM_IP_POOLS where plan_name = $network-model.eipam-v4-address-plan and level = $eipam-ip-block.level and key_value = $v4FQPN-output.pools[$level].key-value ;\"\n        pfx='tmp.eipam-pool-row'>\n\n","comments":"","outputs":1,"x":2462.777862548828,"y":2160.3332233428955,"z":"349cd3c6.7ae4ac","wires":[["5780d366.3c2fdc","bddfe5de.08ae38","f3076ad8.20d1a8"]]},{"id":"84ec1768.fb34c8","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"tmp.eipam-error\" value=\"true\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"Query to DB table EIPAM_IP_POOLS failed.\" />\n\t","comments":"","x":2929.8134689331055,"y":2170.5117769241333,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"5780d366.3c2fdc","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":2783.0635528564453,"y":2208.5117769241333,"z":"349cd3c6.7ae4ac","wires":[["d4ee2001.3b0fa"]]},{"id":"bddfe5de.08ae38","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2781.925338745117,"y":2172.5117769241333,"z":"349cd3c6.7ae4ac","wires":[["84ec1768.fb34c8"]]},{"id":"f3076ad8.20d1a8","type":"not-found","name":"not-found","xml":"<outcome value=\"not-found\">","comments":"","outputs":1,"x":2782.5682220458984,"y":2245.7975158691406,"z":"349cd3c6.7ae4ac","wires":[["84ec1768.fb34c8"]]},{"id":"d4ee2001.3b0fa","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2933.76318359375,"y":2208.5117769241333,"z":"349cd3c6.7ae4ac","wires":[["f6d96e24.6539e","cafa4b39.a1af78"]]},{"id":"8ea994ce.0783e8","type":"get-resource","name":"DB - validate if pool exists for level already","xml":"<get-resource\n        plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n        resource='SQL'\n        key=\"SELECT * FROM EIPAM_IP_POOLS where plan_name = $network-model.eipam-v6-address-plan and level = $eipam-ip-block.level and key_value = $v6FQPN-output.pools[$level].key-value ;\"\n        pfx='tmp.eipam-pool-row'>\n\n","comments":"","outputs":1,"x":2422.555419921875,"y":2595.3330078125,"z":"349cd3c6.7ae4ac","wires":[["b0e89be8.34a638","753e30ac.c3387","71a03662.0cf688"]]},{"id":"4d827f56.0b774","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"tmp.eipam-error\" value=\"true\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"Query to DB table EIPAM_IP_POOLS failed.\" />\n\t","comments":"","x":2889.5910263061523,"y":2605.511561393738,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"b0e89be8.34a638","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":2742.841110229492,"y":2643.511561393738,"z":"349cd3c6.7ae4ac","wires":[["1f4ce9be.57d4b6"]]},{"id":"753e30ac.c3387","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2741.702896118164,"y":2607.511561393738,"z":"349cd3c6.7ae4ac","wires":[["4d827f56.0b774"]]},{"id":"71a03662.0cf688","type":"not-found","name":"not-found","xml":"<outcome value=\"not-found\">","comments":"","outputs":1,"x":2742.3457794189453,"y":2680.797300338745,"z":"349cd3c6.7ae4ac","wires":[["4d827f56.0b774"]]},{"id":"1f4ce9be.57d4b6","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2893.540740966797,"y":2643.511561393738,"z":"349cd3c6.7ae4ac","wires":[["d0edbeb4.e9de1","2446c5b3.dabaca"]]},{"id":"61f684a6.11baac","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value='failed to update EIPAM_IP_SUBNETS .' />\n","comments":"","x":3561.555679321289,"y":2199.7781715393066,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"6375c043.7adc4","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":3426.55558013916,"y":2244.777997970581,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"e9053df.f0604c","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":3422.084129333496,"y":2200.444318294525,"z":"349cd3c6.7ae4ac","wires":[["61f684a6.11baac"]]},{"id":"e2590f90.0c809","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value='failed to update EIPAM_IP_SUBNET_KEYS .' />\n","comments":"","x":3566.55517578125,"y":2284.777587890625,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"2487c99c.f9fd46","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":3427.083625793457,"y":2285.4437346458435,"z":"349cd3c6.7ae4ac","wires":[["e2590f90.0c809"]]},{"id":"40a9bbf6.a7ac64","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value='failed to update EIPAM_IP_SUBNETS .' />\n","comments":"","x":3588.221923828125,"y":2604.999755859375,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"be66d1a6.069a6","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":3453.221824645996,"y":2649.9995822906494,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"56144445.a583bc","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":3448.750373840332,"y":2605.6659026145935,"z":"349cd3c6.7ae4ac","wires":[["40a9bbf6.a7ac64"]]},{"id":"c2355c4a.b14c4","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value='failed to update EIPAM_IP_SUBNET_KEYS .' />\n","comments":"","x":3593.221420288086,"y":2689.9991722106934,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"941f0eab.7d1d5","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":3457.083185195923,"y":2682.3322582244873,"z":"349cd3c6.7ae4ac","wires":[["c2355c4a.b14c4"]]},{"id":"a25e067a.946038","type":"comment","name":"For VLAN Tagging","info":"Network Collection\n\nIf leaf level also insert in EIPAM_IP_SUBNETS &\nEIPAM_IP_SUBNET_KEYS tables, since EIPAM automatically\nallocates subnet when createPool is called.\n(tmp.allocate-subnet-flag=Y)","comments":"","x":1247.4167404174805,"y":2655.416820526123,"z":"349cd3c6.7ae4ac","wires":[]},{"id":"219778d6.5df5d8","type":"switchNode","name":"switch: tmp.allocate-subnet-flag","xml":"<switch test=\"`$tmp.allocate-subnet-flag`\">","comments":"","outputs":1,"x":1559.8333053588867,"y":2657.9165592193604,"z":"349cd3c6.7ae4ac","wires":[["640e63f2.6e77ec","3fe72424.12ba8c"]]},{"id":"13e55d70.ced513","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1458.583417892456,"y":2585.4168252944946,"z":"349cd3c6.7ae4ac","wires":[["219778d6.5df5d8"]]},{"id":"640e63f2.6e77ec","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":1764.833251953125,"y":2656.66650390625,"z":"349cd3c6.7ae4ac","wires":[["a98ff550.c4df58"]]},{"id":"3fe72424.12ba8c","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":1762.5273399353027,"y":2705.951202392578,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"b9da493c.a973c8","type":"switchNode","name":"switch: tmp.allocate-subnet-flag","xml":"<switch test=\"`$tmp.allocate-subnet-flag`\">","comments":"","outputs":1,"x":1417.9166259765625,"y":2187.083251953125,"z":"349cd3c6.7ae4ac","wires":[["b711d279.a11f5","cd54b658.f3a078"]]},{"id":"b711d279.a11f5","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":1622.9165725708008,"y":2185.8331966400146,"z":"349cd3c6.7ae4ac","wires":[["a5ab262c.107d28"]]},{"id":"cd54b658.f3a078","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":1620.6106605529785,"y":2235.117895126343,"z":"349cd3c6.7ae4ac","wires":[[]]},{"id":"8ed89f0a.ac09a","type":"block","name":"block","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1462.9166259765625,"y":2123.333251953125,"z":"349cd3c6.7ae4ac","wires":[["b9da493c.a973c8"]]}]