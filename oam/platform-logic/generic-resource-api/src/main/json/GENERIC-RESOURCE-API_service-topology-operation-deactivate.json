[{"id":"ac6c9328.cb9de","type":"switchNode","name":"switch request-action","xml":"<switch test='`$service-topology-operation-input.request-information.request-action`'>\n","comments":"","outputs":1,"x":561.4285888671875,"y":313.8422031402588,"z":"e671ca2.5776e38","wires":[["d328c35a.3c021","ae874303.d6a1c"]]},{"id":"d328c35a.3c021","type":"outcome","name":"DeleteServiceInstance","xml":"<outcome value='DeleteServiceInstance'>\n","comments":"","outputs":1,"x":798.571403503418,"y":288.127911567688,"z":"e671ca2.5776e38","wires":[["bba20dc8.38088"]]},{"id":"ae874303.d6a1c","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":748.5713691711426,"y":333.8422393798828,"z":"e671ca2.5776e38","wires":[["ee86807.3fe678"]]},{"id":"bba20dc8.38088","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":977.1428604125977,"y":288.1279468536377,"z":"e671ca2.5776e38","wires":[[]]},{"id":"ee86807.3fe678","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"If svc-action is 'deactivate' then request-action must be 'DeleteServiceInstance'\" />\n","comments":"","x":994.2857055664062,"y":333.8422031402588,"z":"e671ca2.5776e38","wires":[]},{"id":"88fbe75d.9b3ff8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":287.380916595459,"y":404.5564498901367,"z":"e671ca2.5776e38","wires":[["ac6c9328.cb9de","27cf51a4.0a0a4e","83ae40b9.3c13f","e15b18de.b91818","833124b5.3b61f8"]]},{"id":"958fbc28.f9e47","type":"dgstart","name":"DGSTART","outputs":1,"x":125.23812103271484,"y":80.98508262634277,"z":"e671ca2.5776e38","wires":[["f771cbe7.3f9578"]]},{"id":"f771cbe7.3f9578","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":240.52383422851562,"y":121.2231912612915,"z":"e671ca2.5776e38","wires":[["7176e99f.147988"]]},{"id":"7176e99f.147988","type":"method","name":"method service-topology-operation-deactivate","xml":"<method rpc='service-topology-operation-deactivate' mode='sync'>\n","comments":"","outputs":1,"x":238.47626495361328,"y":162.65175247192383,"z":"e671ca2.5776e38","wires":[["88fbe75d.9b3ff8"]]},{"id":"e4213136.1b25d","type":"comment","name":"service-topology-operation-deactivate","info":"","comments":"","x":519.5829772949219,"y":28.571426391601562,"z":"e671ca2.5776e38","wires":[]},{"id":"27cf51a4.0a0a4e","type":"switchNode","name":"switch service-data service-instance-id","xml":"<switch test='`$service-data.service-topology.service-topology-identifier.service-instance-id`'>\n","comments":"","outputs":1,"x":616.90478515625,"y":239.0803050994873,"z":"e671ca2.5776e38","wires":[["8551717b.ecca3"]]},{"id":"8551717b.ecca3","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":846.666690826416,"y":239.08032512664795,"z":"e671ca2.5776e38","wires":[["ad471b62.9ef058"]]},{"id":"ad471b62.9ef058","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"`'Service ' + $service-topology-operation-input.service-information.service-instance-id + ' is not found'`\" />\n","comments":"","x":1002.3809356689453,"y":239.08032035827637,"z":"e671ca2.5776e38","wires":[]},{"id":"83ae40b9.3c13f","type":"update","name":"update AAI service instance","xml":"<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"service-instance\" \n\t\tkey=\"customer.global-customer-id = $service-data.service-topology.service-topology-identifier.global-customer-id AND\n\t\t\tservice-subscription.service-type = $service-data.service-topology.service-topology-identifier.service-type AND\n\t\t\tservice-instance.service-instance-id = $service-topology-operation-input.service-information.service-instance-id\"\n        pfx='pfx' local-only='false' force='false'>\n\t<parameter name=\"orchestration-status\" value=\"PendingDelete\" />\n","comments":"","outputs":1,"x":583.1904907226562,"y":524.080322265625,"z":"e671ca2.5776e38","wires":[["1ab67983.459ba6","d889670b.278868"]]},{"id":"1ab67983.459ba6","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":795.9523582458496,"y":499.3184766769409,"z":"e671ca2.5776e38","wires":[["655cf69a.4a38f8"]]},{"id":"655cf69a.4a38f8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"AAI failed\" />\n","comments":"","x":945.9523239135742,"y":499.31855487823486,"z":"e671ca2.5776e38","wires":[]},{"id":"d889670b.278868","type":"failure","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":802.2617874145508,"y":547.8898944854736,"z":"e671ca2.5776e38","wires":[["186fbfe4.0478f"]]},{"id":"e15b18de.b91818","type":"set","name":"set service-level-oper-status to PendingDelete","xml":"<set>\n<parameter name='service-data.service-level-oper-status.order-status' value='PendingDelete' />\n<parameter name='service-data.service-level-oper-status.last-rpc-action' value='deactivate' />\n<parameter name='service-data.service-level-oper-status.last-action' value='DeleteServiceInstance' />\n","comments":"","x":639.1904525756836,"y":593.8422164916992,"z":"e671ca2.5776e38","wires":[]},{"id":"186fbfe4.0478f","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":930.2380867004395,"y":547.6517562866211,"z":"e671ca2.5776e38","wires":[[]]},{"id":"fc587782.b233d8","type":"comment","name":"Don't treat this as an error","info":"","comments":"","x":1105.2381744384766,"y":547.6517362594604,"z":"e671ca2.5776e38","wires":[]},{"id":"833124b5.3b61f8","type":"switchNode","name":"switch provided-allotted-resource length","xml":"<switch test='`$service-data.provided-allotted-resources.provided-allotted-resource_length`'>\n","comments":"","outputs":1,"x":621.9048385620117,"y":407.6517581939697,"z":"e671ca2.5776e38","wires":[["d9b91153.f78a","9958b478.578c18","5aa73c44.d94584"]]},{"id":"d9b91153.f78a","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":861.9047050476074,"y":409.3183937072754,"z":"e671ca2.5776e38","wires":[["8979ce23.11d1"]]},{"id":"9958b478.578c18","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":861.9048080444336,"y":450.98505210876465,"z":"e671ca2.5776e38","wires":[["10934b9e.fead24"]]},{"id":"10934b9e.fead24","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Cannot deactivate this service because there are provided allotted resources\" />\n","comments":"","x":1014.0476341247559,"y":450.03265953063965,"z":"e671ca2.5776e38","wires":[]},{"id":"8979ce23.11d1","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":998.5713996887207,"y":385.9850597381592,"z":"e671ca2.5776e38","wires":[[]]},{"id":"5aa73c44.d94584","type":"outcome","name":"0","xml":"<outcome value='0'>\n","comments":"","outputs":1,"x":861.9047050476074,"y":367.6517057418823,"z":"e671ca2.5776e38","wires":[["8979ce23.11d1"]]}]