[{"id":"bdeaac7e.eeba5","type":"method","name":"method auto-ip-assignment","xml":"<method rpc='auto-ip-assignment' mode='sync'>\n","comments":"","outputs":1,"x":192.5,"y":86.7261734008789,"z":"1fa209ca.68bcc6","wires":[["1d61830a.caff3d"]]},{"id":"1d61830a.caff3d","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":174.392822265625,"y":145.4045763015747,"z":"1fa209ca.68bcc6","wires":[["ca6c92f6.15a88","94a73311.17b05","e8373374.eb2ed","e7d10438.f3e268","8054687.0b2de98","311925a8.ed57ea","ebb5bed4.21fe4","92fb65d7.62b1e8","f661c9eb.ebf8b8","9572481d.426008","620ae3a1.712f0c","848cc7f8.6ad808","c539ed02.ba3e4","39576ccf.08aa54"]]},{"id":"6d8f285d.2ee468","type":"dgstart","name":"DGSTART","outputs":1,"x":132.64283752441406,"y":22.61903190612793,"z":"1fa209ca.68bcc6","wires":[["efaaa681.a9adf8"]]},{"id":"ca6c92f6.15a88","type":"get-resource","name":"get-resource VF_MODULE_MODEL","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n  key='SELECT * from VF_MODULE_MODEL WHERE customization_uuid = $auto-ip-assignment-input.vf-module.model-customization-uuid'\n  pfx='db1.vf-module-model'>\n\n","comments":"","outputs":1,"x":483.60704040527344,"y":385.4762716293335,"z":"1fa209ca.68bcc6","wires":[["ec4f7188.2ce47","e3fd6f30.c323f"]]},{"id":"311925a8.ed57ea","type":"for","name":"for each vm-type","xml":"<for index='vm-type-index' start='0' end='`$db1.vf-module-to-vfc-mapping_length`' >\n","comments":"","outputs":1,"x":400.82141876220703,"y":1281.429196357727,"z":"1fa209ca.68bcc6","wires":[["73db199f.b7b378"]]},{"id":"ec4f7188.2ce47","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":756.5356140136719,"y":365.8571071624756,"z":"1fa209ca.68bcc6","wires":[["382de90f.6812e6"]]},{"id":"e3fd6f30.c323f","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":765.1070442199707,"y":410.14282035827637,"z":"1fa209ca.68bcc6","wires":[["65e64946.838a18"]]},{"id":"3593ee13.1daa82","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":836.21435546875,"y":454.01176166534424,"z":"1fa209ca.68bcc6","wires":[["1dbed7a1.44f198"]]},{"id":"d347b8fb.2d6ba8","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":844.7857856750488,"y":498.297474861145,"z":"1fa209ca.68bcc6","wires":[["c897c5db.f03b08"]]},{"id":"73db199f.b7b378","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":598.2499160766602,"y":1281.9168405532837,"z":"1fa209ca.68bcc6","wires":[["c18d23f9.dfb6a","69acb259.3743cc","f885dc5b.e1297","2849b46c.06d7ac","39e9f916.d84206","24dba145.3374ae"]]},{"id":"382de90f.6812e6","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VF_MODULE_MODEL table\" />\n","comments":"","x":931.5355453491211,"y":365.00000762939453,"z":"1fa209ca.68bcc6","wires":[]},{"id":"65e64946.838a18","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"`'No model found for VF module customization UUID ' + $vnf-topology-operation-input.vnf-request-information.model-customization-uuid`\" />\n","comments":"","x":932.1783447265625,"y":409.904748916626,"z":"1fa209ca.68bcc6","wires":[]},{"id":"1dbed7a1.44f198","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VF_MODULE_TO_VFC_MAPPING table\" />\n","comments":"","x":1011.2142868041992,"y":453.1546621322632,"z":"1fa209ca.68bcc6","wires":[]},{"id":"c897c5db.f03b08","type":"set","name":"set vf-module-to-vfc-mapping length to 0","xml":"<set>\n<parameter name='db1.vf-module-to-vfc-mapping_length' value='0' />\n","comments":"","x":1098.0000762939453,"y":497.9161376953125,"z":"1fa209ca.68bcc6","wires":[]},{"id":"5a553f67.c7601","type":"switchNode","name":"switch ipv4-ip-version","xml":"<switch test='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-ip-version`'>\n","comments":"","outputs":1,"x":2397.0757217407227,"y":2713.762487888336,"z":"1fa209ca.68bcc6","wires":[["fab0b697.cf8cf8"]]},{"id":"fab0b697.cf8cf8","type":"other","name":"4","xml":"<outcome value='4'>\n","comments":"","outputs":1,"x":2588.0755157470703,"y":2713.8576607704163,"z":"1fa209ca.68bcc6","wires":[["fe994d35.8cfd5"]]},{"id":"fe994d35.8cfd5","type":"switchNode","name":"switch ipv4-use-dhcp","xml":"<switch test='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-use-dhcp`'>\n","comments":"","outputs":1,"x":2783.38077545166,"y":2714.9407086372375,"z":"1fa209ca.68bcc6","wires":[["b3ff62a2.75876"]]},{"id":"b3ff62a2.75876","type":"outcome","name":"N","xml":"<outcome value='N'>\n","comments":"","outputs":1,"x":2979.630657196045,"y":2715.2623019218445,"z":"1fa209ca.68bcc6","wires":[["e5e94945.c9a578"]]},{"id":"4b46311e.8a97","type":"comment","name":"REQUIRED INPUTS","info":"auto-ip-assignment-input.vf-module.model-customization-uuid\n - used to get VF_MODULE_MODEL and related vfc-customization-uuids\nauto-ip-assignment-input.vf-module-id\n - pass to include in eipam-ip-block.plans.[].info\nauto-ip-assignment-input.aic-cloud-region\n - pass to generate FQPN to get clli and complex.region\n - pass to query-aai-l3-network-by network-role as 1st filter\nauto-ip-assignment-input.service-instance-id\n - pass to query-aai-l3-network-by network-role as 2nd filter\nauto-ip-assignment-input.vnf-assignments.vnf-vms[].vm-names[].vnfc-names[].vnfc-name\n - pass to use vnfc-name as part of client-key for ip request\n\t","comments":"","x":584.9524536132812,"y":76.84521675109863,"z":"1fa209ca.68bcc6","wires":[]},{"id":"63355749.999f38","type":"comment","name":"Change History","info":"iTrack 8790\n- fix generate-FQPN-input.location-clli8 (8 was missing)\n- fix typo (signular assignment, no s) in eipam-ip-block.plans[].requests[] SUPPLEMENTAL DATA\n- copy generate-FQPN-output. to eipam-ip-block.plans[].requests[] after ading SUPPLEMENTAL DATA\niTrack 9558\n- fix typo in node 95, 282 to test ipv6-ip-version instead of ipv6-use-dhcp\n- initialize pidx before looping vm-type\n- fixed node 105 for loop end index type, db instead of db1\n\n1802\niTrack 10575 \n\t- added property for cloud-owner, added property for cloud-owner, added property for cloud-owner, added property for cloud-owner, added property for cloud-owner, added property for cloud-owner\niTrack 10846\n\t- node 71, added network-role-tag\n\t- node 41, clear tmp.db1.\n\niTrack 10767\n\t- added node 320 to update GENERIC_RESOURCE_NAME.context_id for client-key\n\t\n\tiTrack 11310\n\t- added network-id as FQPN input\n1806\niTrack 13358\n- set service-type to NA if null","comments":"","x":800.25,"y":64.9404525756836,"z":"1fa209ca.68bcc6","wires":[]},{"id":"94a73311.17b05","type":"switchNode","name":"switch: auto-ip-assignment-input.vf-module.model-customization-uuid","xml":"<switch test='`$auto-ip-assignment-input.vf-module.model-customization-uuid`'>\n","comments":"","outputs":1,"x":585.4286193847656,"y":189.61903762817383,"z":"1fa209ca.68bcc6","wires":[["ffb298a5.f0f0e8"]]},{"id":"ffb298a5.f0f0e8","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":933.4286193847656,"y":189.6190366744995,"z":"1fa209ca.68bcc6","wires":[["501d7832.b9a1c8"]]},{"id":"501d7832.b9a1c8","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"auto-ip-assignment-input.vf-module.model-customization-uuid is null\" />\n","comments":"","x":1095.3452911376953,"y":189.73013544082642,"z":"1fa209ca.68bcc6","wires":[]},{"id":"e8373374.eb2ed","type":"switchNode","name":"switch: auto-ip-assignment-input.aic-cloud-region","xml":"<switch test='`$auto-ip-assignment-input.aic-cloud-region`'>\n","comments":"","outputs":1,"x":522.1785888671875,"y":145.61902713775635,"z":"1fa209ca.68bcc6","wires":[["5e6658b7.1d20b8"]]},{"id":"5e6658b7.1d20b8","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":785.678596496582,"y":145.11902713775635,"z":"1fa209ca.68bcc6","wires":[["29b82193.3a746e"]]},{"id":"29b82193.3a746e","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"auto-ip-assignment-input.aic-cloud-region is null\" />\n","comments":"","x":940.0952644348145,"y":145.23012399673462,"z":"1fa209ca.68bcc6","wires":[]},{"id":"e7d10438.f3e268","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":390.3695297241211,"y":5296.321459770203,"z":"1fa209ca.68bcc6","wires":[["d7916c77.af658"]]},{"id":"8054687.0b2de98","type":"switchNode","name":"switch: auto-ip-assignment-input.vf-module-id","xml":"<switch test='`$auto-ip-assignment-input.vf-module-id`'>\n","comments":"","outputs":1,"x":512.3571472167969,"y":235.47616958618164,"z":"1fa209ca.68bcc6","wires":[["94e19cf2.8369a"]]},{"id":"94e19cf2.8369a","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":806.8571548461914,"y":234.97616958618164,"z":"1fa209ca.68bcc6","wires":[["7f5c15a8.18707c"]]},{"id":"7f5c15a8.18707c","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"auto-ip-assignment-input.vf-module-id is null\" />\n","comments":"","x":961.2738227844238,"y":235.0872664451599,"z":"1fa209ca.68bcc6","wires":[]},{"id":"12834db5.591062","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1318.225917816162,"y":1416.6784665584564,"z":"1fa209ca.68bcc6","wires":[["29c73eda.7d05a2"]]},{"id":"29c73eda.7d05a2","type":"set","name":"set vfc-to-network-role-mapping length to 0","xml":"<set>\n<parameter name='db1.vfc-to-network-role-mapping_length' value='0' />\n","comments":"","x":1581.6307373046875,"y":1416.6868569850922,"z":"1fa209ca.68bcc6","wires":[]},{"id":"11c41bfb.ee6444","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1311.345043182373,"y":1461.4404199123383,"z":"1fa209ca.68bcc6","wires":[["552ab56d.0b188c"]]},{"id":"552ab56d.0b188c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VFC_TO_NETWORK_ROLE_MAPPING table\" />\n","comments":"","x":1486.3449745178223,"y":1460.5833203792572,"z":"1fa209ca.68bcc6","wires":[]},{"id":"c539ed02.ba3e4","type":"set","name":"set pidx = 0","xml":"<set>\n\t<parameter name='pidx' value = '0' />","comments":"","x":386.44034576416016,"y":1231.1307334899902,"z":"1fa209ca.68bcc6","wires":[]},{"id":"a35d339d.d772a","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":904.6986122131348,"y":616.0595092773438,"z":"1fa209ca.68bcc6","wires":[["14b0cd1a.0ef593"]]},{"id":"14b0cd1a.0ef593","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error retrieving cloud region from AAI\" />\n","comments":"","x":1079.698585510254,"y":616.0595455169678,"z":"1fa209ca.68bcc6","wires":[]},{"id":"36a9187c.6a9578","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":913.6272087097168,"y":567.3452425003052,"z":"1fa209ca.68bcc6","wires":[["f29043a7.1a8ff"]]},{"id":"f29043a7.1a8ff","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"`'aic-cloud-region, '+ $generate-fqpn-input.aic-cloud-region + ' not found in AAI'`\" />\n","comments":"","x":1079.9764862060547,"y":566.6508197784424,"z":"1fa209ca.68bcc6","wires":[]},{"id":"51b64b37.cbe814","type":"for","name":"for relationship list","xml":"<for index='ridx' start='0' end='`$aai.cloud-region.relationship-list.relationship_length`' >\n","comments":"","outputs":1,"x":645.4286270141602,"y":807.165768623352,"z":"1fa209ca.68bcc6","wires":[["84fdeabe.693e68"]]},{"id":"a2a54490.483078","type":"get-resource","name":"get-resource: AAI cloud region","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"cloud-region\" \n\t\tkey=\"cloud-region.cloud-owner = $prop.cloud-region.cloud-owner AND \n\t\t     cloud-region.cloud-region-id = $auto-ip-assignment-input.aic-cloud-region AND\n\t\t     depth = '0'\"\n        pfx='aai.cloud-region' >\n\n","comments":"","outputs":1,"x":685.2024040222168,"y":590.1586618423462,"z":"1fa209ca.68bcc6","wires":[["36a9187c.6a9578","a35d339d.d772a"]]},{"id":"9cb1a25.f1cd86","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2017.8971519470215,"y":1002.8968086242676,"z":"1fa209ca.68bcc6","wires":[["d3347913.1f4b98"]]},{"id":"d3347913.1f4b98","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error retrieving complex from AAI\" />\n","comments":"","x":2184.4327964782715,"y":1002.3968486785889,"z":"1fa209ca.68bcc6","wires":[]},{"id":"6df847f.69579b8","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":2024.3971481323242,"y":958.8968696594238,"z":"1fa209ca.68bcc6","wires":[["fe77ab8.ca0aa58"]]},{"id":"fe77ab8.ca0aa58","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Complex not found in AAI\" />\n","comments":"","x":2192.175075531006,"y":959.2022171020508,"z":"1fa209ca.68bcc6","wires":[]},{"id":"ee9cbe79.9bd6a","type":"get-resource","name":"get-resource complex","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"complex\" \n\t\tkey=\"complex.physical-location-id = $aai.cloud-region.relationship-list.relationship[$ridx].relationship-data[$rdidx].relationship-value\"\n    pfx='aai.complex' >\n        \n\n\n","comments":"","outputs":1,"x":1816.5436248779297,"y":958.8534126281738,"z":"1fa209ca.68bcc6","wires":[["6df847f.69579b8","9cb1a25.f1cd86"]]},{"id":"e028a80d.17a7b8","type":"switchNode","name":"switch: relationship-key","xml":"<switch test='`$aai.cloud-region.relationship-list.relationship[$ridx].relationship-data[$rdidx].relationship-key`'>\n","comments":"","outputs":1,"x":1095.345344543457,"y":806.9526331424713,"z":"1fa209ca.68bcc6","wires":[["8a4be0cf.c0c4c"]]},{"id":"8a4be0cf.c0c4c","type":"other","name":"complex.physical-location-id","xml":"<outcome value='complex.physical-location-id'>\n","comments":"","outputs":1,"x":1351.2740859985352,"y":807.22642827034,"z":"1fa209ca.68bcc6","wires":[["8f808106.51edd"]]},{"id":"2e362ecc.38ca82","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":1763.6426086425781,"y":806.8813190460205,"z":"1fa209ca.68bcc6","wires":[["1cf1acd6.2d9d43","74eb321a.32e84c","fb6c9d13.30d6a"]]},{"id":"1cf1acd6.2d9d43","type":"set","name":"set tmp.aic-clli","xml":"<set>\n<parameter name='tmp.aic-clli' value='`$aai.cloud-region.relationship-list.relationship[$ridx].relationship-data[$rdidx].relationship-value`' />\n\n","comments":"","x":1968.6195220947266,"y":805.2423820495605,"z":"1fa209ca.68bcc6","wires":[]},{"id":"9f220722.b9cdc8","type":"switchNode","name":"switch cloud-region.relationship_length","xml":"<switch test='`$aai.cloud-region.relationship-list.relationship_length`'>\n","comments":"","outputs":1,"x":710.0356864929199,"y":693.6586618423462,"z":"1fa209ca.68bcc6","wires":[["5b7be5d5.ae6adc","fe44cb88.ada2d8"]]},{"id":"5b7be5d5.ae6adc","type":"other","name":"0","xml":"<outcome value='0'>\n","comments":"","outputs":1,"x":960.2857585483125,"y":670.1587487326728,"z":"1fa209ca.68bcc6","wires":[["21477cfd.543464"]]},{"id":"fe44cb88.ada2d8","type":"other","name":"null","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":963.5357551574707,"y":719.1587839126587,"z":"1fa209ca.68bcc6","wires":[["21477cfd.543464"]]},{"id":"21477cfd.543464","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"cloud-region missing relationships in AAI\" />\n","comments":"","x":1135.0357627868652,"y":690.1587829589844,"z":"1fa209ca.68bcc6","wires":[]},{"id":"84fdeabe.693e68","type":"for","name":"for relationship data","xml":"<for silentFailure='false' index='rdidx' start='0' end=\"`$aai.cloud-region.relationship-list.relationship[$ridx].relationship-data_length`\" >\n","comments":"","outputs":1,"x":870.2500228881836,"y":807.0753405094147,"z":"1fa209ca.68bcc6","wires":[["e028a80d.17a7b8"]]},{"id":"ebb5bed4.21fe4","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":409.1666717529297,"y":589.6586980819702,"z":"1fa209ca.68bcc6","wires":[["a2a54490.483078","9f220722.b9cdc8","51b64b37.cbe814","80ea343b.e57cf8"]]},{"id":"74eb321a.32e84c","type":"execute","name":"substring aic-clli to 8 chars","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='substring'>\n   <parameter name='result' value='tmp.truncated.clli8' />\n   <parameter name='string' value='`$tmp.aic-clli`' />\n   <parameter name='begin-index' value='0' />\n   <parameter name='end-index' value='8' />\n","comments":"","outputs":1,"x":2009.1664810180664,"y":853.3928115367889,"z":"1fa209ca.68bcc6","wires":[[]]},{"id":"fb6c9d13.30d6a","type":"set","name":"set generate-FQPN-input.location-clli8","xml":"<set>\n<parameter name='generate-FQPN-input.location-clli8' value='`$tmp.truncated.clli8`' />\n","comments":"","x":2046.5555038452148,"y":900.7260100841522,"z":"1fa209ca.68bcc6","wires":[]},{"id":"a9bd2cf.cf2c0d","type":"set","name":"set generate-FQPN-input.complex-region","xml":"<set>\n<parameter name='generate-FQPN-input.complex-region' value='`$aai.complex.region`' />\n","comments":"","x":1876.5000457763672,"y":1052.3927431106567,"z":"1fa209ca.68bcc6","wires":[]},{"id":"8f808106.51edd","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1584.166576385498,"y":807.0594577789307,"z":"1fa209ca.68bcc6","wires":[["2e362ecc.38ca82","ee9cbe79.9bd6a","a9bd2cf.cf2c0d"]]},{"id":"5b9e9ca4.d8f764","type":"comment","name":"db1.vfc-to-network-role-mapping[]","info":"","comments":"","x":591.3928375244141,"y":1465.6071498394012,"z":"1fa209ca.68bcc6","wires":[]},{"id":"2285643b.9922cc","type":"outcome","name":"6","xml":"<outcome value='6'>\n","comments":"","outputs":1,"x":2583.39310836792,"y":3041.0481295585632,"z":"1fa209ca.68bcc6","wires":[["438426c0.cc0468"]]},{"id":"e5e94945.c9a578","type":"switchNode","name":"switch: ipv4-count > 0","xml":"<switch test='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-count &gt; 0`'>\n","comments":"","outputs":1,"x":3175.11922454834,"y":2714.6307187080383,"z":"1fa209ca.68bcc6","wires":[["d2d209d7.8ed748"]]},{"id":"c269e9.de2c4618","type":"switchNode","name":"switch: ipv6-count > 0","xml":"<switch test='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-count &gt; 0`'>\n","comments":"","outputs":1,"x":3167.6191329956055,"y":3041.4887051582336,"z":"1fa209ca.68bcc6","wires":[["45ccbd96.e468b4"]]},{"id":"45ccbd96.e468b4","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":3366.666702270508,"y":3042.012421131134,"z":"1fa209ca.68bcc6","wires":[["c760b117.8b827"]]},{"id":"d2d209d7.8ed748","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":3370.02396774292,"y":2714.6788535118103,"z":"1fa209ca.68bcc6","wires":[["4266f4eb.802e3c"]]},{"id":"f85e4bcd.6f1478","type":"outcome","name":"N","xml":"<outcome value='N'>\n","comments":"","outputs":1,"x":2974.7621841430664,"y":3041.8219780921936,"z":"1fa209ca.68bcc6","wires":[["c269e9.de2c4618"]]},{"id":"438426c0.cc0468","type":"switchNode","name":"switch ipv6-use-dhcp","xml":"<switch test='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-use-dhcp`'>\n","comments":"","outputs":1,"x":2774.762275695801,"y":3041.155140399933,"z":"1fa209ca.68bcc6","wires":[["f85e4bcd.6f1478"]]},{"id":"9fba10d1.1caf7","type":"for","name":"for vm-index in vm-count","xml":"<for index='vm-index' start='0' end='`$db1.vf-module-to-vfc-mapping[$vm-type-index].vm-count`' >\n","comments":"","outputs":1,"x":3806.45263671875,"y":2981.6785564422607,"z":"1fa209ca.68bcc6","wires":[["bfe01ab7.6c8a88"]]},{"id":"bfe01ab7.6c8a88","type":"for","name":"for ipv4-index in ipv4-ip-count","xml":"<for index='ipv4-index' start='0' end='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-count`' >\n","comments":"","outputs":1,"x":4093.167495727539,"y":2981.3928303718567,"z":"1fa209ca.68bcc6","wires":[["ced3eb0a.3e32f8"]]},{"id":"80ea343b.e57cf8","type":"set","name":"set generate-FQPN-input.aic-cloud-region","xml":"<set>\n<parameter name='generate-FQPN-input.aic-cloud-region' \n\tvalue='`$auto-ip-assignment-input.aic-cloud-region`' />\n","comments":"","x":710.547607421875,"y":972.9165382385254,"z":"1fa209ca.68bcc6","wires":[]},{"id":"28c25d32.2a7872","type":"set","name":"set eipam-ip-block.plans[].requests[] SUPPLEMENTAL DATA","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].vm-type'\n    value='`$db1.vf-module-to-vfc-mapping[$vm-type-index].vm-type`' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].network-role'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].subnet-role'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].subnet-role`' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].ip-type'\n    value='FIXED' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].vnf-vms[$vm-type-index].vm-names[$vm-index].vnfc-names[0].vnfc-name'\n    value='`$auto-ip-assignment-input.vnf-topology.vnf-assignments.vnf-vms[$vm-type-index].vm-names[$vm-index].vnfc-names[0].vnfc-name`' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].vnfc-name'\n    value='`$auto-ip-assignment-input.vnf-topology.vnf-assignments.vnf-vms[$vm-type-index].vm-names[$vm-index].vnfc-names[0].vnfc-name`' />    ","comments":"","x":4946.429328918457,"y":3501.821168422699,"z":"1fa209ca.68bcc6","wires":[]},{"id":"92fb65d7.62b1e8","type":"set","name":"set qridx = 0","xml":"<set>\n\t<parameter name='qridx' value = '0' />","comments":"","x":391.4166946411133,"y":1181.3452701568604,"z":"1fa209ca.68bcc6","wires":[]},{"id":"b31cbbb7.684048","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":4571.095596313477,"y":3439.487681865692,"z":"1fa209ca.68bcc6","wires":[["e83ff5ab.6145c8","b8f985fd.a12bc8","454ab1a0.010a1","28c25d32.2a7872","f04325bc.877968","fad632eb.6a9c1"]]},{"id":"fcd641c6.e94f6","type":"call","name":"call: generate-FQPN","xml":"<call module='GENERIC-RESOURCE-API' rpc='generate-FQPN' mode='sync' >","comments":"","outputs":1,"x":3791.381187438965,"y":3105.6790585517883,"z":"1fa209ca.68bcc6","wires":[["b9a7ef28.c44b6"]]},{"id":"b9a7ef28.c44b6","type":"failure","name":"failure","xml":"<outcome value='failure'>","outputs":1,"x":3987.2264289855957,"y":3106.1195845603943,"z":"1fa209ca.68bcc6","wires":[["ef2f80a6.d9df2"]]},{"id":"ef2f80a6.d9df2","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"`'An error occured while generating FQPN: '+ $error-message`\" />\n","comments":"","x":4148.226428985596,"y":3106.1195845603943,"z":"1fa209ca.68bcc6","wires":[]},{"id":"c760b117.8b827","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":3544.5243759155273,"y":3041.821900844574,"z":"1fa209ca.68bcc6","wires":[["fcd641c6.e94f6","a1756b5f.a813c8","f980c3d4.b9fbc","761e238c.5d346c","af240f9.e382ff","c276cfd9.9bcae"]]},{"id":"a1756b5f.a813c8","type":"set","name":"set generate-FQPN-input.plan-name, network-role, subnet-role, vrf-name","xml":"<set>\n<parameter name='generate-FQPN-input.plan-name'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-address-plan-name`' />\n<parameter name='generate-FQPN-input.network-role'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n<parameter name='generate-FQPN-input.subnet-role'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].subnet-role`' />\n<parameter name='generate-FQPN-input.vrf-name'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-vrf-name`' />\n\n<!--\n<parameter name='generate-FQPN-input.plans-index' value='`$pidx`' />\n<parameter name='generate-FQPN-input.requests-index' value='`$ridx`' />\n-->","comments":"","x":3952.66707611084,"y":3041.5838437080383,"z":"1fa209ca.68bcc6","wires":[]},{"id":"f661c9eb.ebf8b8","type":"for","name":"for each vm-type","xml":"<for index='vm-type-index' start='0' end='`$db1.vf-module-to-vfc-mapping_length`' >\n","comments":"","outputs":1,"x":419.7501907348633,"y":3852.988638162613,"z":"1fa209ca.68bcc6","wires":[["2b988a1b.7f7bd6"]]},{"id":"13900383.cbb11c","type":"for","name":"for each network-role","xml":"<for index='network-role-index' start='0' end='`$db1.vfc-to-network-role-mapping_length`' >\n","comments":"","outputs":1,"x":846.5959014892578,"y":4062.5155210494995,"z":"1fa209ca.68bcc6","wires":[["3ba19fcb.20327"]]},{"id":"3ba19fcb.20327","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1073.4883880615234,"y":4062.1865224838257,"z":"1fa209ca.68bcc6","wires":[["1c79b3e4.57ddbc","e3bac480.22c4f8","b272fd59.bbf0b","91540bf0.cd70b8","b6c1cfe8.74caf"]]},{"id":"3ae51def.6f5252","type":"switchNode","name":"switch ipv4-ip-version","xml":"<switch test='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-ip-version`'>\n","comments":"","outputs":1,"x":2342.576271057129,"y":4877.321943998337,"z":"1fa209ca.68bcc6","wires":[["ba642375.134b4"]]},{"id":"ba642375.134b4","type":"other","name":"4","xml":"<outcome value='4'>\n","comments":"","outputs":1,"x":2533.5760650634766,"y":4877.417116880417,"z":"1fa209ca.68bcc6","wires":[["770e67e8.a971b8"]]},{"id":"770e67e8.a971b8","type":"switchNode","name":"switch ipv4-use-dhcp","xml":"<switch test='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-use-dhcp`'>\n","comments":"","outputs":1,"x":2719.5957794189453,"y":4876.880890607834,"z":"1fa209ca.68bcc6","wires":[["99ffb23a.1b79d"]]},{"id":"99ffb23a.1b79d","type":"outcome","name":"N","xml":"<outcome value='N'>\n","comments":"","outputs":1,"x":2915.84566116333,"y":4877.202483892441,"z":"1fa209ca.68bcc6","wires":[["fdc7524b.4f0ae"]]},{"id":"b272fd59.bbf0b","type":"set","name":"set tmp.network-role.found = false","xml":"<set>\n\t<parameter name='tmp.network-role.found' value = 'false' />","comments":"","x":1366.8337860107422,"y":4167.166709899902,"z":"1fa209ca.68bcc6","wires":[]},{"id":"fdc7524b.4f0ae","type":"switchNode","name":"switch: ipv4-floating-count > 0","xml":"<switch test='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-floating-count &gt; 0`'>\n","comments":"","outputs":1,"x":3150.7387886047363,"y":4876.595235586166,"z":"1fa209ca.68bcc6","wires":[["98938161.3fea8"]]},{"id":"98938161.3fea8","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":3373.786449432373,"y":4876.643157243729,"z":"1fa209ca.68bcc6","wires":[["9dfd2540.737068"]]},{"id":"32938572.9de37a","type":"for","name":"for each q","xml":"<for index='q' start='0' end='`$tmp.network-role-query-results_length`' >\n","comments":"","outputs":1,"x":1670.0479354858398,"y":4277.179706811905,"z":"1fa209ca.68bcc6","wires":[["2b9ad069.c1331","9525c570.063288"]]},{"id":"d16be293.6196a","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2180.4646530151367,"y":4323.596601724625,"z":"1fa209ca.68bcc6","wires":[["da60e692.bfb7a8"]]},{"id":"da60e692.bfb7a8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2343.2146224975586,"y":4323.596543550491,"z":"1fa209ca.68bcc6","wires":[["b918599d.55a5c8","43751108.a7a64","7a257d71.1b3624","d7779888.5f9488"]]},{"id":"b918599d.55a5c8","type":"set","name":"set generate-FQPN-input.network-name","xml":"<set>\n<parameter name='generate-FQPN-input.network-name' \n\tvalue='`$tmp.network-role-query-results[$q].l3-network.network-name`' />\n<parameter name='generate-FQPN-input.network-id' \n\tvalue='`$tmp.network-role-query-results[$q].l3-network.network-id`' />","comments":"","x":2624.9646224975586,"y":4323.846543550491,"z":"1fa209ca.68bcc6","wires":[]},{"id":"43751108.a7a64","type":"set","name":"set tmp.network-role.found = true","xml":"<set>\n\t<parameter name='tmp.network-role.found' value = 'true' />","comments":"","x":2605.7146072387695,"y":4371.346486330032,"z":"1fa209ca.68bcc6","wires":[]},{"id":"2d94833e.63e13c","type":"switchNode","name":"switch tmp.network-role.found","xml":"<switch test='`$tmp.network-role.found`'>\n","comments":"","outputs":1,"x":1559.1431427001953,"y":4617.822324752808,"z":"1fa209ca.68bcc6","wires":[["b76e9a1f.d92a18","2cf6eef6.fd6c52"]]},{"id":"b76e9a1f.d92a18","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1783.809627532959,"y":4617.822783470154,"z":"1fa209ca.68bcc6","wires":[["5fd32b63.2b9584"]]},{"id":"cbd8150c.f07008","type":"comment","name":"Lopping for floating ips","info":"","comments":"","x":518.2620811462402,"y":3807.9170706272125,"z":"1fa209ca.68bcc6","wires":[]},{"id":"276a3823.9093b8","type":"set","name":"set ridx = 0","xml":"<set>\n<parameter name='ridx' value='0' />\n","comments":"","x":2361.833335876465,"y":2622.7740292549133,"z":"1fa209ca.68bcc6","wires":[]},{"id":"e83ff5ab.6145c8","type":"set","name":"increment ridx","xml":"<set>\n<parameter name='ridx' value='`$ridx + 1`' />\n","comments":"","x":4803.250274658203,"y":3839.4991660118103,"z":"1fa209ca.68bcc6","wires":[]},{"id":"b8f985fd.a12bc8","type":"set","name":"set eipam-ip-block.plans[].requests_length","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].requests_length' value='`$ridx`' />\n","comments":"","x":4890.250595092773,"y":3902.356273174286,"z":"1fa209ca.68bcc6","wires":[]},{"id":"cac0d7fa.ff6178","type":"call","name":"call: generate-FQPN","xml":"<call module='GENERIC-RESOURCE-API' rpc='generate-FQPN' mode='sync' >","comments":"","outputs":1,"x":3795.928970336914,"y":4934.489298343658,"z":"1fa209ca.68bcc6","wires":[["8d739f0d.2f3e9"]]},{"id":"8d739f0d.2f3e9","type":"failure","name":"failure","xml":"<outcome value='failure'>","outputs":1,"x":3991.774211883545,"y":4934.929824352264,"z":"1fa209ca.68bcc6","wires":[["c853a009.e46a3"]]},{"id":"c853a009.e46a3","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"`'An error occured while generating FQPN: '+ $error-message`\" />\n","comments":"","x":4152.774211883545,"y":4934.929824352264,"z":"1fa209ca.68bcc6","wires":[]},{"id":"9dfd2540.737068","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":3545.2148780822754,"y":4876.775269269943,"z":"1fa209ca.68bcc6","wires":[["cac0d7fa.ff6178","1cd5a66.7711b5a","2c1c79b7.b28ea6","267fa7c8.b7bda8","f9459525.385678","c0a42027.da922"]]},{"id":"1cd5a66.7711b5a","type":"set","name":"set generate-FQPN-input.plan-name, network-role, subnet-role, vrf-name","xml":"<set>\n<parameter name='generate-FQPN-input.plan-name'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-address-plan-name`' />\n<parameter name='generate-FQPN-input.subnet-role'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].subnet-role`' />\n<parameter name='generate-FQPN-input.network-role'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n<parameter name='generate-FQPN-input.vrf-name'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-vrf-name`' />\n\n<!--\n<parameter name='generate-FQPN-input.plans-index' value='`$pidx`' />\n<parameter name='generate-FQPN-input.requests-index' value='`$ridx`' />\n-->","comments":"","x":3957.2144775390625,"y":4877.060610294342,"z":"1fa209ca.68bcc6","wires":[]},{"id":"8e6077b8.e4d448","type":"call","name":"call: generate-FQPN","xml":"<call module='GENERIC-RESOURCE-API' rpc='generate-FQPN' mode='sync' >","comments":"","outputs":1,"x":3802.5956497192383,"y":5245.894829750061,"z":"1fa209ca.68bcc6","wires":[["9bef6d5.5154c9"]]},{"id":"9bef6d5.5154c9","type":"failure","name":"failure","xml":"<outcome value='failure'>","outputs":1,"x":3994.440891265869,"y":5246.335355758667,"z":"1fa209ca.68bcc6","wires":[["29bd829e.c1928e"]]},{"id":"29bd829e.c1928e","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"`'An error occured while generating FQPN: '+ $error-message`\" />\n","comments":"","x":4155.440891265869,"y":5246.335355758667,"z":"1fa209ca.68bcc6","wires":[]},{"id":"734bf358.b8c19c","type":"set","name":"set eipam-ip-block.plans[].plan-name, address-family","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].plan-name'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-address-plan-name`' />\n<parameter name='eipam-ip-block.plans[$pidx].address-family'\n    value=\"`'ipv' + $db1.vfc-to-network-role-mapping[$network-role-index].ipv6-ip-version`\" />","comments":"","x":3904.2145042419434,"y":5350.704384326935,"z":"1fa209ca.68bcc6","wires":[]},{"id":"b4e09caf.66c66","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":3532.2147521972656,"y":5183.18058514595,"z":"1fa209ca.68bcc6","wires":[["8e6077b8.e4d448","b2920be2.27bef8","734bf358.b8c19c","80af71b0.d1d94","f9459525.385678","71ccdccd.6f3db4"]]},{"id":"b2920be2.27bef8","type":"set","name":"set generate-FQPN-input.plan-name, network-role, subnet-role, vrf-name","xml":"<set>\n<parameter name='generate-FQPN-input.plan-name'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-address-plan-name`' />\n<parameter name='generate-FQPN-input.vrf-name'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-vrf-name`' />\n<parameter name='generate-FQPN-input.subnet-role' \n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].subnet-role`' />\n<parameter name='generate-FQPN-input.network-role'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n\n<!--\n<parameter name='generate-FQPN-input.plans-index' value='`$pidx`' />\n<parameter name='generate-FQPN-input.requests-index' value='`$ridx`' />\n-->","comments":"","x":3965.214511871338,"y":5184.132459640503,"z":"1fa209ca.68bcc6","wires":[]},{"id":"780bb10d.855f4","type":"set","name":"increment ridx","xml":"<set>\n<parameter name='ridx' value='`$ridx + 1`' />\n","comments":"","x":3982.667449951172,"y":5831.13201212883,"z":"1fa209ca.68bcc6","wires":[]},{"id":"7dfc98af.30f1d8","type":"set","name":"set eipam-ip-block.plans[].requests_length","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].requests_length' value='`$ridx`' />\n","comments":"","x":4069.667434692383,"y":5895.607931852341,"z":"1fa209ca.68bcc6","wires":[]},{"id":"2c1c79b7.b28ea6","type":"set","name":"set ip-version, use-dhcp","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].ip-version'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-ip-version`' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].use-dhcp'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-use-dhcp`' />","comments":"","x":3811.3101196289062,"y":5089.6318254470825,"z":"1fa209ca.68bcc6","wires":[]},{"id":"6c18c680.514658","type":"set","name":"set ridx = 0","xml":"<set>\n<parameter name='ridx' value='0' />\n","comments":"","x":2314.3577880859375,"y":4760.751270055771,"z":"1fa209ca.68bcc6","wires":[]},{"id":"b2c848c5.019c18","type":"switchNode","name":"switch ipv6-ip-version","xml":"<switch test='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-ip-version`'>\n","comments":"","outputs":1,"x":2350.548126220703,"y":5183.489090204239,"z":"1fa209ca.68bcc6","wires":[["e37bbb38.1d0cf8"]]},{"id":"e37bbb38.1d0cf8","type":"other","name":"6","xml":"<outcome value='6'>\n","comments":"","outputs":1,"x":2541.547920227051,"y":5183.584263086319,"z":"1fa209ca.68bcc6","wires":[["e631b133.609ed"]]},{"id":"e631b133.609ed","type":"switchNode","name":"switch ipv6-use-dhcp","xml":"<switch test='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-use-dhcp`'>\n","comments":"","outputs":1,"x":2727.5676345825195,"y":5183.048036813736,"z":"1fa209ca.68bcc6","wires":[["b5b2cf39.285c2"]]},{"id":"b5b2cf39.285c2","type":"outcome","name":"N","xml":"<outcome value='N'>\n","comments":"","outputs":1,"x":2923.8175163269043,"y":5183.369630098343,"z":"1fa209ca.68bcc6","wires":[["f59678a.6d15988"]]},{"id":"f59678a.6d15988","type":"switchNode","name":"switch: ipv6-floating-count > 0","xml":"<switch test='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-floating-count &gt; 0`'>\n","comments":"","outputs":1,"x":3151.3773040771484,"y":5182.929894685745,"z":"1fa209ca.68bcc6","wires":[["efdbdf0e.b28f6"]]},{"id":"efdbdf0e.b28f6","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":3364.424964904785,"y":5182.9778163433075,"z":"1fa209ca.68bcc6","wires":[["b4e09caf.66c66"]]},{"id":"ec903613.4cc188","type":"execute","name":"call EIPAM assignIPAddress","xml":"<execute plugin=\"com.att.sdnctl.sli.plugin.eipam.EIPAMPlugin\" method=\"assignIPAddress\">","comments":"","outputs":1,"x":1315.5126495361328,"y":5343.618245124817,"z":"1fa209ca.68bcc6","wires":[["4ccc4394.028a0c"]]},{"id":"4ccc4394.028a0c","type":"failure","name":"failure","xml":"<outcome value='failure'>","outputs":1,"x":1529.5126495361328,"y":5343.618245124817,"z":"1fa209ca.68bcc6","wires":[["dccc6100.bb124"]]},{"id":"dccc6100.bb124","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"`'An error occured while obtaining ip addresses from EIPAM: ' + $error-message`\" />\n","comments":"","x":1690.5126495361328,"y":5343.618245124817,"z":"1fa209ca.68bcc6","wires":[]},{"id":"d7916c77.af658","type":"switchNode","name":"switch: eipam-ip-block.plans_length >0","xml":"<switch test='`$eipam-ip-block.plans_length &gt; 0`'>\n","comments":"","outputs":1,"x":663.8218536376953,"y":5295.653888702393,"z":"1fa209ca.68bcc6","wires":[["9e541539.767c98"]]},{"id":"9e541539.767c98","type":"other","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":910.6196784973145,"y":5295.677324295044,"z":"1fa209ca.68bcc6","wires":[["f195efcb.8c3b5"]]},{"id":"37e47319.7ebcac","type":"comment","name":"generate-FQPN-input","info":"","comments":"","x":901.7381057739258,"y":991.4879360198975,"z":"1fa209ca.68bcc6","wires":[]},{"id":"f281ac4a.e7a7c","type":"comment","name":"generate-FQPN-input","info":"","comments":"","x":2273.1666259765625,"y":891.7261304855347,"z":"1fa209ca.68bcc6","wires":[]},{"id":"a22f243a.0b3c48","type":"comment","name":"generate-FQPN-input","info":"","comments":"","x":1976.499870300293,"y":1076.726095199585,"z":"1fa209ca.68bcc6","wires":[]},{"id":"5684a644.981d58","type":"comment","name":"generate-FQPN-input","info":"","comments":"","x":2039.5953674316406,"y":2511.7261209487915,"z":"1fa209ca.68bcc6","wires":[]},{"id":"cfd2ef69.0e48f","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2150.8570976257324,"y":2565.0676975250244,"z":"1fa209ca.68bcc6","wires":[["5a553f67.c7601","276a3823.9093b8","44068065.7c3bf","99c83f4.d51ddc","4ac0f04f.defe"]]},{"id":"7794aa4e.66c1c4","type":"call","name":"call: generate-FQPN","xml":"<call module='GENERIC-RESOURCE-API' rpc='generate-FQPN' mode='sync' >","comments":"","outputs":1,"x":3798.833808898926,"y":2766.6313948631287,"z":"1fa209ca.68bcc6","wires":[["c7e2ac3f.4c94f"]]},{"id":"c7e2ac3f.4c94f","type":"failure","name":"failure","xml":"<outcome value='failure'>","outputs":1,"x":3993.6790504455566,"y":2767.0719208717346,"z":"1fa209ca.68bcc6","wires":[["b7d8934d.12e39"]]},{"id":"b7d8934d.12e39","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"`'An error occured while generating FQPN: '+ $error-message`\" />\n","comments":"","x":4154.679050445557,"y":2767.0719208717346,"z":"1fa209ca.68bcc6","wires":[]},{"id":"aeda21f6.f8222","type":"set","name":"set generate-FQPN-input.plan-name, network-role, subnet-role,vrf-name","xml":"<set>\n<parameter name='generate-FQPN-input.plan-name'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-address-plan-name`' />\n<parameter name='generate-FQPN-input.network-role'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n<parameter name='generate-FQPN-input.subnet-role'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].subnet-role`' />\n<parameter name='generate-FQPN-input.vrf-name'\n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-vrf-name`' />\n\t\n<!--\n<parameter name='generate-FQPN-input.plans-index' value='`$pidx`' />\n<parameter name='generate-FQPN-input.requests-index' value='`$ridx`' />\n-->\n","comments":"","x":3958.5478515625,"y":2713.8689494132996,"z":"1fa209ca.68bcc6","wires":[]},{"id":"4266f4eb.802e3c","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":3550.9766159057617,"y":2713.440763950348,"z":"1fa209ca.68bcc6","wires":[["aeda21f6.f8222","7794aa4e.66c1c4","9fba10d1.1caf7","b63d91fd.67a5d","86e1d7f6.faf318","b8156cb0.f8602"]]},{"id":"454ab1a0.010a1","type":"set","name":"set pools[] to generate-FQPN-output","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].'\n    value='generate-FQPN-output.' />\n","comments":"","x":4872.000450134277,"y":3439.821309566498,"z":"1fa209ca.68bcc6","wires":[]},{"id":"f980c3d4.b9fbc","type":"set","name":"set eipam-ip-block.plans[].plan-name, address-family (ipv6)","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].plan-name'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-address-plan-name`' />\n<parameter name='eipam-ip-block.plans[$pidx].address-family'\n    value=\"`'ipv' + $db1.vfc-to-network-role-mapping[$network-role-index].ipv6-ip-version`\" />","comments":"","x":3910.3331718444824,"y":3159.0597863197327,"z":"1fa209ca.68bcc6","wires":[]},{"id":"b63d91fd.67a5d","type":"set","name":"set eipam-ip-block.plans[].plan-name, address-family (ipv4)","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].plan-name'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-address-plan-name`' />\n<parameter name='eipam-ip-block.plans[$pidx].address-family'\n    value=\"`'ipv' + $db1.vfc-to-network-role-mapping[$network-role-index].ipv4-ip-version`\" />","comments":"","x":3918.5001831054688,"y":2820.059724330902,"z":"1fa209ca.68bcc6","wires":[]},{"id":"761e238c.5d346c","type":"for","name":"for vm-index in vm-count","xml":"<for index='vm-index' start='0' end='`$db1.vf-module-to-vfc-mapping[$vm-type-index].vm-count`' >\n","comments":"","outputs":1,"x":3808.47615814209,"y":3323.6309628486633,"z":"1fa209ca.68bcc6","wires":[["85701c73.74435"]]},{"id":"85701c73.74435","type":"for","name":"for ipv6-index in ipv6-count","xml":"<for index='ipv6-index' start='0' end='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-count`' >\n","comments":"","outputs":1,"x":4084.1430282592773,"y":3323.8214869499207,"z":"1fa209ca.68bcc6","wires":[["a2a2550d.0dbb68"]]},{"id":"267fa7c8.b7bda8","type":"set","name":"set eipam-ip-block.plans[].plan-name, address-family","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].plan-name'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-address-plan-name`' />\n<parameter name='eipam-ip-block.plans[$pidx].address-family'\n    value=\"`'ipv' + $db1.vfc-to-network-role-mapping[$network-role-index].ipv4-ip-version`\" />","comments":"","x":3897.833740234375,"y":4988.060574054718,"z":"1fa209ca.68bcc6","wires":[]},{"id":"ced3eb0a.3e32f8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":4359.642631530762,"y":2981.0122776031494,"z":"1fa209ca.68bcc6","wires":[["288a64fb.4485cc","b31cbbb7.684048","54f2b045.0b32"]]},{"id":"288a64fb.4485cc","type":"set","name":"set ip-version, use-dhcp","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].ip-version'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-ip-version`' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].use-dhcp'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv4-use-dhcp`' />","comments":"","x":4598.9763107299805,"y":2981.0122985839844,"z":"1fa209ca.68bcc6","wires":[]},{"id":"4cd8a5e7.d7793c","type":"set","name":"set ip-version, use-dhcp","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].ip-version'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-ip-version`' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].use-dhcp'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-use-dhcp`' />","comments":"","x":4592.33349609375,"y":3323.3930830955505,"z":"1fa209ca.68bcc6","wires":[]},{"id":"a2a2550d.0dbb68","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":4329.000061035156,"y":3323.3930888175964,"z":"1fa209ca.68bcc6","wires":[["4cd8a5e7.d7793c","b31cbbb7.684048","e26be7e0.c31918"]]},{"id":"4eb81c0f.22ac24","type":"set","name":"set eipam-ip-block.plans[].requests[] SUPPLEMENTAL DATA","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].vm-type'\n    value='`$db1.vf-module-to-vfc-mapping[$vm-type-index].vm-type`' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].network-role'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].subnet-role'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].subnet-role`' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].ip-type'\n    value='VIP' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].group-number'\n    value='1' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].vnf-vms[$vm-type-index].vm-names[$vm-index].vnfc-names[0].vnfc-name'\n    value='`$auto-ip-assignment-input.vnf-topology.vnf-assignments.vnf-vms[$vm-type-index].vm-names[$vm-index].vnfc-names[0].vnfc-name`' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].vnfc-name'\n    value='`$auto-ip-assignment-input.vnf-topology.vnf-assignments.vnf-vms[$vm-type-index].vm-names[$vm-index].vnfc-names[0].vnfc-name`' />    ","comments":"","x":4125.310096740723,"y":5594.061890363693,"z":"1fa209ca.68bcc6","wires":[]},{"id":"80af71b0.d1d94","type":"set","name":"set ip-version, use-dhcp","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].ip-version'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-ip-version`' />\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].use-dhcp'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-use-dhcp`' />","comments":"","x":3813.3338890075684,"y":5402.727821826935,"z":"1fa209ca.68bcc6","wires":[]},{"id":"6dd3e67.6311b18","type":"set","name":"set pools[] to generate-FQPN-output","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].'\n    value='generate-FQPN-output.' />\n","comments":"","x":4051.738525390625,"y":5534.013761281967,"z":"1fa209ca.68bcc6","wires":[]},{"id":"f9459525.385678","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":3770.8340377807617,"y":5534.060873746872,"z":"1fa209ca.68bcc6","wires":[["4eb81c0f.22ac24","6dd3e67.6311b18","780bb10d.855f4","7dfc98af.30f1d8","218a8cf.c29d374"]]},{"id":"5fd32b63.2b9584","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1934.9281692504883,"y":2079.250346183777,"z":"1fa209ca.68bcc6","wires":[["6a107bfb.0148f4","d317fff.71254","b3035c24.c4ddd","4a0e7a3a.fe5604","5934557f.f3fedc","cd8de2f4.dd7dd","cfd2ef69.0e48f","de878648.aad968"]]},{"id":"6a107bfb.0148f4","type":"set","name":"set query-aai-l3-network-by-network-role-input","xml":"<set>\n<parameter name='query-aai-l3-network-by-network-role-input.aic-cloud-region' \n\tvalue='`$auto-ip-assignment-input.aic-cloud-region`' />\n<parameter name='query-aai-l3-network-by-network-role-input.service-instance-id' \n\tvalue='`$auto-ip-assignment-input.service-instance-id`' />\n<parameter name='query-aai-l3-network-by-network-role-input.network-role' \n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n\t\n<!--\nfilter options: service-instance-id, aic-cloud-region, null, Other (or any string)\n    - null or Other will filter by aic-cloud-region first, then service-instance-id\n<parameter name='query-aai-l3-network-by-network-role-input.filter' \n\tvalue='service-instance-id' />\n-->","comments":"","x":2268.2614135742188,"y":2079.05961894989,"z":"1fa209ca.68bcc6","wires":[]},{"id":"d317fff.71254","type":"call","name":"call: query-aai-l3-network-by-network-role","xml":"<call module='GENERIC-RESOURCE-API' rpc='query-aai-l3-network-by-network-role' mode='sync' >","comments":"","outputs":1,"x":2251.5472869873047,"y":2129.6310777664185,"z":"1fa209ca.68bcc6","wires":[["ec951ac8.e48788"]]},{"id":"b3035c24.c4ddd","type":"set","name":"set generate-FQPN-input.network-name","xml":"<set>\n<parameter name='generate-FQPN-input.network-name' \n\tvalue='`$query-aai-l3-network-by-network-role-output.l3-network.network-name`' />\n<parameter name='generate-FQPN-input.network-id' \n\tvalue='`$query-aai-l3-network-by-network-role-output.l3-network.network-id`' />","comments":"","x":2245.7375259399414,"y":2181.440981864929,"z":"1fa209ca.68bcc6","wires":[]},{"id":"4a0e7a3a.fe5604","type":"set","name":"increment qridx","xml":"<set>\n<parameter name='qridx' value='`$qridx + 1`' />\n\t","comments":"","x":2174.7258071899414,"y":2333.2622652053833,"z":"1fa209ca.68bcc6","wires":[]},{"id":"5934557f.f3fedc","type":"set","name":"set eipam-ip-block.plans[$pidx].l3-network","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].l3-network.' \n\tvalue='query-aai-l3-network-by-network-role-output.l3-network.' />","comments":"","x":2253.7375259399414,"y":2282.488363265991,"z":"1fa209ca.68bcc6","wires":[]},{"id":"ec951ac8.e48788","type":"failure","name":"failure","xml":"<outcome value='failure'>","outputs":1,"x":2514.761459350586,"y":2129.095410346985,"z":"1fa209ca.68bcc6","wires":[["42265866.4df2b8"]]},{"id":"42265866.4df2b8","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"`'An error occured while querying AAI to retrieve l3-network by network-role: ' + $error-message`\" />\n","comments":"","x":2675.761459350586,"y":2129.095410346985,"z":"1fa209ca.68bcc6","wires":[]},{"id":"cd8de2f4.dd7dd","type":"set","name":"set tmp.network-role-query-results_length","xml":"<set>\n<parameter name='tmp.network-role-query-results_length' value='`$qridx`' />","comments":"","x":2255.8209381103516,"y":2380.500467300415,"z":"1fa209ca.68bcc6","wires":[]},{"id":"9572481d.426008","type":"set","name":"intialize plans_length, query-aai.output","xml":"<set>\n\t<parameter name='eipam-ip-block.plans_length' value = '0' />\n\t<parameter name='query-aai-l3-network-by-network-role-output.' value = '' />","comments":"","x":471.3333282470703,"y":1128.7261352539062,"z":"1fa209ca.68bcc6","wires":[]},{"id":"c18d23f9.dfb6a","type":"for","name":"for each network-role","xml":"<for index='network-role-index' start='0' end='`$db1.vfc-to-network-role-mapping_length`' >\n","comments":"","outputs":1,"x":849.2024078369141,"y":1551.5118427276611,"z":"1fa209ca.68bcc6","wires":[["fe724d5a.448e8"]]},{"id":"fe724d5a.448e8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1055.6425857543945,"y":1551.5080301761627,"z":"1fa209ca.68bcc6","wires":[["a6c23102.c6382","f7de5d3e.8ee25","ae970313.da058","e47d816b.04ff5","36b7f160.7d80ce","fc0d7098.ec8bd"]]},{"id":"ae970313.da058","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1271.511703491211,"y":1795.1029949188232,"z":"1fa209ca.68bcc6","wires":[["901ab3e6.b6379","ea14bac6.97b598"]]},{"id":"46decb10.a2e294","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1746.4283714294434,"y":2078.4004096090794,"z":"1fa209ca.68bcc6","wires":[["5fd32b63.2b9584"]]},{"id":"901ab3e6.b6379","type":"switchNode","name":"switch tmp.network-role.found","xml":"<switch test='`$tmp.network-role.found`'>\n","comments":"","outputs":1,"x":1520.7619934082031,"y":2078.7333946228027,"z":"1fa209ca.68bcc6","wires":[["46decb10.a2e294","b602289c.28c628"]]},{"id":"debcbc94.182ce","type":"for","name":"for each q","xml":"<for index='q' start='0' end='`$tmp.network-role-query-results_length`' >\n","comments":"","outputs":1,"x":1594.9524002075195,"y":1795.2814807891846,"z":"1fa209ca.68bcc6","wires":[["99f40c66.4c79b","2f21d390.49b6bc"]]},{"id":"1ec2226b.30207e","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2112.7024841308594,"y":1873.6029319763184,"z":"1fa209ca.68bcc6","wires":[["30192d9d.398bb2"]]},{"id":"30192d9d.398bb2","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2275.4524536132812,"y":1873.602873802185,"z":"1fa209ca.68bcc6","wires":[["d1608cb7.69be1","c6ace3f8.10c9","da17823d.ca396","6082a89a.d21ec8"]]},{"id":"a6c23102.c6382","type":"set","name":"set tmp.network-role.found = false","xml":"<set>\n\t<parameter name='tmp.network-role.found' value = 'false' />","comments":"","x":1335.178337097168,"y":1648.5199508666992,"z":"1fa209ca.68bcc6","wires":[]},{"id":"620ae3a1.712f0c","type":"set","name":"set tmp.network-role-query-results_length = 0","xml":"<set>\n<parameter name='tmp.network-role-query-results_length' value='0' />","comments":"","x":494.1666717529297,"y":1080.0595092773438,"z":"1fa209ca.68bcc6","wires":[]},{"id":"f7de5d3e.8ee25","type":"set","name":"set tmp.plan-index-to-be-incremented = false","xml":"<set>\n<parameter name='tmp.plan-index-to-be-incremented' value='false' />\n","comments":"","x":1366.630973815918,"y":1597.9882307052612,"z":"1fa209ca.68bcc6","wires":[]},{"id":"86e1d7f6.faf318","type":"set","name":"set tmp.plan-index-to-be-incremented = true","xml":"<set>\n<parameter name='tmp.plan-index-to-be-incremented' value='true' />\n","comments":"","x":3872.214683532715,"y":2881.4881405830383,"z":"1fa209ca.68bcc6","wires":[]},{"id":"af240f9.e382ff","type":"set","name":"set tmp.plan-index-to-be-incremented = true","xml":"<set>\n<parameter name='tmp.plan-index-to-be-incremented' value='true' />\n","comments":"","x":3867.07186126709,"y":3211.7737851142883,"z":"1fa209ca.68bcc6","wires":[]},{"id":"e6fa96b7.a2c818","type":"set","name":"increment eipam-ip-block.plans_length","xml":"<set>\n<parameter name=\"eipam-ip-block.plans_length\" value=\"`$pidx`\"/>","comments":"","x":3089.5003356933594,"y":3379.5594997406006,"z":"1fa209ca.68bcc6","wires":[]},{"id":"3b242f42.f792","type":"set","name":"set pidx++","xml":"<set>\n<parameter name='pidx' value='`$pidx + 1`' />\n","comments":"","x":2999.50040435791,"y":3324.559500694275,"z":"1fa209ca.68bcc6","wires":[]},{"id":"540527ff.4b5538","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2836.1670684814453,"y":3324.2264165878296,"z":"1fa209ca.68bcc6","wires":[["3b242f42.f792","e6fa96b7.a2c818"]]},{"id":"44068065.7c3bf","type":"switchNode","name":"switch tmp.plan-index-to-be-incremented","xml":"<switch test='`$tmp.plan-index-to-be-incremented`'>\n","comments":"","outputs":1,"x":2428.071823120117,"y":3325.2736988067627,"z":"1fa209ca.68bcc6","wires":[["ebb68603.fca938"]]},{"id":"ebb68603.fca938","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2683.7860565185547,"y":3324.8452320098877,"z":"1fa209ca.68bcc6","wires":[["540527ff.4b5538"]]},{"id":"c0a42027.da922","type":"set","name":"set tmp.plan-index-to-be-incremented = true","xml":"<set>\n<parameter name='tmp.plan-index-to-be-incremented' value='true' />\n","comments":"","x":3873.0003051757812,"y":5034.2270402908325,"z":"1fa209ca.68bcc6","wires":[]},{"id":"71ccdccd.6f3db4","type":"set","name":"set tmp.plan-index-to-be-incremented = true","xml":"<set>\n<parameter name='tmp.plan-index-to-be-incremented' value='true' />\n","comments":"","x":3876.0956077575684,"y":5293.917274951935,"z":"1fa209ca.68bcc6","wires":[]},{"id":"c4017219.98fec","type":"set","name":"increment eipam-ip-block.plans_length","xml":"<set>\n<parameter name=\"eipam-ip-block.plans_length\" value=\"`$pidx`\"/>","comments":"","x":3064.762252807617,"y":5520.989094495773,"z":"1fa209ca.68bcc6","wires":[]},{"id":"d50e10f8.6600e","type":"set","name":"set pidx++","xml":"<set>\n<parameter name='pidx' value='`$pidx + 1`' />\n","comments":"","x":2974.7622680664062,"y":5440.9891221523285,"z":"1fa209ca.68bcc6","wires":[]},{"id":"2bf10e53.549e32","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2811.4289321899414,"y":5440.656038045883,"z":"1fa209ca.68bcc6","wires":[["d50e10f8.6600e","c4017219.98fec"]]},{"id":"3718704a.29e8","type":"switchNode","name":"switch tmp.plan-index-to-be-incremented","xml":"<switch test='`$tmp.plan-index-to-be-incremented`'>\n","comments":"","outputs":1,"x":2396.3336868286133,"y":5441.703320264816,"z":"1fa209ca.68bcc6","wires":[["5a65f76b.f145e8"]]},{"id":"5a65f76b.f145e8","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2659.047920227051,"y":5441.274853467941,"z":"1fa209ca.68bcc6","wires":[["2bf10e53.549e32"]]},{"id":"e3bac480.22c4f8","type":"set","name":"set tmp.plan-index-to-be-incremented = false","xml":"<set>\n<parameter name='tmp.plan-index-to-be-incremented' value='false' />\n","comments":"","x":1398.3097915649414,"y":4114.060183525085,"z":"1fa209ca.68bcc6","wires":[]},{"id":"848cc7f8.6ad808","type":"get-resource","name":"get VF_MODULE_TO_VFC_MAPPING (vm_count > 0)","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n\tkey='SELECT * from VF_MODULE_TO_VFC_MAPPING WHERE vf_module_customization_uuid = $auto-ip-assignment-input.vf-module.model-customization-uuid \n\t\tAND vm_count > 0'\n  pfx='db1.vf-module-to-vfc-mapping[]'>\n\n","comments":"","outputs":1,"x":538.1666717529297,"y":475.7737865447998,"z":"1fa209ca.68bcc6","wires":[["3593ee13.1daa82","d347b8fb.2d6ba8"]]},{"id":"69acb259.3743cc","type":"get-resource","name":"get VFC_TO_NETWORK_ROLE_MAPPING (ANY ip-count > 0)","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n\tkey='SELECT * from VFC_TO_NETWORK_ROLE_MAPPING WHERE vfc_customization_uuid = $db1.vf-module-to-vfc-mapping[$vm-type-index].vfc-customization-uuid \n\t\tAND (ipv4_count > 0 OR ipv6_count > 0 OR ipv4_floating_count > 0 OR ipv6_floating_count > 0)'\n\tpfx='db1.vfc-to-network-role-mapping[]'>\n\n","comments":"","outputs":1,"x":983.214241027832,"y":1438.1071565151215,"z":"1fa209ca.68bcc6","wires":[["12834db5.591062","11c41bfb.ee6444"]]},{"id":"b602289c.28c628","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1740.4999694824219,"y":2480.0593852996826,"z":"1fa209ca.68bcc6","wires":[["3c27b6b0.8a554a"]]},{"id":"99f40c66.4c79b","type":"switchNode","name":"switch network-role | query-result vs db1","xml":"<switch test='`$tmp.qresult.network-role == $tmp.db1.network-role`' >\n","comments":"","outputs":1,"x":1864.5952758789062,"y":1873.8211879730225,"z":"1fa209ca.68bcc6","wires":[["1ec2226b.30207e"]]},{"id":"3c27b6b0.8a554a","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1925.0596618652344,"y":2479.7300453186035,"z":"1fa209ca.68bcc6","wires":[["30580ab3.84dde6","cfd2ef69.0e48f"]]},{"id":"30580ab3.84dde6","type":"set","name":"set eipam-ip-block.plans[$pidx].l3-network","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].l3-network.' \n\tvalue='tmp.network-role-query-results[$query-results-found-index].l3-network.' />","comments":"","x":2217.726173400879,"y":2480.3965520858765,"z":"1fa209ca.68bcc6","wires":[]},{"id":"de878648.aad968","type":"set","name":"set tmp.network-role-query-results","xml":"<set>\n<parameter name='tmp.network-role-query-results[$qridx].l3-network.' \n\tvalue='`$query-aai-l3-network-by-network-role-output.l3-network.`' />\n<parameter name='tmp.network-role-query-results[$qridx].l3-network.network-role-tag' \n\tvalue='`$tmp.db1.network-role-tag`' />\n\n<!--\n<parameter name='tmp.network-role-query-results[$qridx].network-role' \n\tvalue='`$db1.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n<parameter name='tmp.network-role-query-results[$qridx].network-name' \n\tvalue='`$query-aai-l3-network-by-network-role-output.l3-network.network-name`' />\n-->","comments":"","x":2228.344741821289,"y":2231.802201271057,"z":"1fa209ca.68bcc6","wires":[]},{"id":"7a257d71.1b3624","type":"set","name":"set query-results-found-index","xml":"<set>\n\t<parameter name='query-results-found-index' value = '`$q`' />","comments":"","x":2594.1064682006836,"y":4417.546196222305,"z":"1fa209ca.68bcc6","wires":[]},{"id":"28a8ff1f.90103","type":"set","name":"set eipam-ip-block.plans[$pidx].l3-network","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].l3-network.' \n\tvalue='tmp.network-role-query-results[$query-results-found-index].l3-network.' />","comments":"","x":2191.2733840942383,"y":4698.54718375206,"z":"1fa209ca.68bcc6","wires":[]},{"id":"2cf6eef6.fd6c52","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1781.9399642944336,"y":4699.213690519333,"z":"1fa209ca.68bcc6","wires":[["ff08471b.68c588"]]},{"id":"99c83f4.d51ddc","type":"set","name":"set eipam-ip-block.plans[].network-role, subnet-role","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].network-role'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n<parameter name='eipam-ip-block.plans[$pidx].subnet-role'\n    value=\"`$db1.vfc-to-network-role-mapping[$network-role-index].subnet-role`\" />","comments":"","x":2486.0001831054688,"y":2666.559338092804,"z":"1fa209ca.68bcc6","wires":[]},{"id":"7c6ced48.013ab4","type":"set","name":"set eipam-ip-block.plans[].network-role, subnet-role","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].network-role'\n    value='`$db1.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n<parameter name='eipam-ip-block.plans[$pidx].subnet-role'\n    value=\"`$db1.vfc-to-network-role-mapping[$network-role-index].subnet-role`\" />","comments":"","x":2437.750213623047,"y":4814.560279607773,"z":"1fa209ca.68bcc6","wires":[]},{"id":"4ac0f04f.defe","type":"switchNode","name":"switch ipv6-ip-version","xml":"<switch test='`$db1.vfc-to-network-role-mapping[$network-role-index].ipv6-ip-version`'>\n","comments":"","outputs":1,"x":2393.1192474365234,"y":3041.4283859729767,"z":"1fa209ca.68bcc6","wires":[["2285643b.9922cc"]]},{"id":"f885dc5b.e1297","type":"set","name":"set tmp.vm-type","xml":"<set>\n<parameter name='vm-type-loop' value = 'START' />\n<parameter name='tmp.vm-type' value = '`$db1.vf-module-to-vfc-mapping[$vm-type-index].vm-type`' />","comments":"","x":834.535701751709,"y":1281.6668610572815,"z":"1fa209ca.68bcc6","wires":[]},{"id":"e47d816b.04ff5","type":"set","name":"set network-role-loop","xml":"<set>\n<parameter name='network-role-loop' value = 'START' />","comments":"","x":1293.8214263916016,"y":1550.642938375473,"z":"1fa209ca.68bcc6","wires":[]},{"id":"1c79b3e4.57ddbc","type":"set","name":"set network-role-loop","xml":"<set>\n<parameter name='network-role-loop' value = 'START' />","comments":"","x":1325.643081665039,"y":4062.2864615917206,"z":"1fa209ca.68bcc6","wires":[]},{"id":"2b988a1b.7f7bd6","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":616.0239105224609,"y":3852.476308822632,"z":"1fa209ca.68bcc6","wires":[["8b36f505.beceb8","13900383.cbb11c","75a1e4eb.e91a0c","6276b052.96bf9","67372ecf.ddecc"]]},{"id":"8b36f505.beceb8","type":"set","name":"set tmp.vm-type","xml":"<set>\n<parameter name='vm-type-floating-loop' value = 'START' />\n<parameter name='tmp.vm-type' value = '`$db1.vf-module-to-vfc-mapping[$vm-type-index].vm-type`' />","comments":"","x":834.4525146484375,"y":3852.845067024231,"z":"1fa209ca.68bcc6","wires":[]},{"id":"2849b46c.06d7ac","type":"set","name":"clear db1.vfc-to-network-role-mapping[]","xml":"<set>\n<parameter name='db1.vfc-to-network-role-mapping.' value = '' />","comments":"","x":907.2499694824219,"y":1385.0951557159424,"z":"1fa209ca.68bcc6","wires":[]},{"id":"91540bf0.cd70b8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1304.2499771118164,"y":4277.28594326973,"z":"1fa209ca.68bcc6","wires":[["2d94833e.63e13c","b70e9260.d4d03"]]},{"id":"ff08471b.68c588","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1929.7024002075195,"y":4699.143431425095,"z":"1fa209ca.68bcc6","wires":[["28a8ff1f.90103","87218db.1c5c87"]]},{"id":"87218db.1c5c87","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2106.5120697021484,"y":4760.35818362236,"z":"1fa209ca.68bcc6","wires":[["6c18c680.514658","7c6ced48.013ab4","3ae51def.6f5252","3718704a.29e8","b2c848c5.019c18"]]},{"id":"b655aea4.094fd","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1314.9282569885254,"y":3935.1539726257324,"z":"1fa209ca.68bcc6","wires":[["659ad3e8.c45b9c"]]},{"id":"659ad3e8.c45b9c","type":"set","name":"set vfc-to-network-role-mapping length to 0","xml":"<set>\n<parameter name='db1.vfc-to-network-role-mapping_length' value='0' />\n","comments":"","x":1578.3330764770508,"y":3935.162363052368,"z":"1fa209ca.68bcc6","wires":[]},{"id":"111e43bd.511ecc","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1308.0473823547363,"y":3979.9159259796143,"z":"1fa209ca.68bcc6","wires":[["45895c95.7c67d4"]]},{"id":"45895c95.7c67d4","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VFC_TO_NETWORK_ROLE_MAPPING table\" />\n","comments":"","x":1483.0473136901855,"y":3979.058826446533,"z":"1fa209ca.68bcc6","wires":[]},{"id":"3ddfe7ee.f6d288","type":"comment","name":"db1.vfc-to-network-role-mapping[]","info":"","comments":"","x":582.8571014404297,"y":3956.9397706985474,"z":"1fa209ca.68bcc6","wires":[]},{"id":"6276b052.96bf9","type":"get-resource","name":"get VFC_TO_NETWORK_ROLE_MAPPING (ANY ip-count > 0)","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n\tkey='SELECT * from VFC_TO_NETWORK_ROLE_MAPPING WHERE vfc_customization_uuid = $db1.vf-module-to-vfc-mapping[$vm-type-index].vfc-customization-uuid \n\t\tAND (ipv4_count > 0 OR ipv6_count > 0 OR ipv4_floating_count > 0 OR ipv6_floating_count > 0)'\n\tpfx='db1.vfc-to-network-role-mapping[]'>\n\n","comments":"","outputs":1,"x":979.9165802001953,"y":3956.5826625823975,"z":"1fa209ca.68bcc6","wires":[["b655aea4.094fd","111e43bd.511ecc"]]},{"id":"75a1e4eb.e91a0c","type":"set","name":"clear db1.vfc-to-network-role-mapping[]","xml":"<set>\n<parameter name='db1.vfc-to-network-role-mapping.' value = '' />","comments":"","x":906.9523086547852,"y":3903.5706617832184,"z":"1fa209ca.68bcc6","wires":[]},{"id":"d1608cb7.69be1","type":"set","name":"set tmp.network-role.found = true","xml":"<set>\n\t<parameter name='tmp.network-role.found' value = 'true' />","comments":"","x":2541.952438354492,"y":1921.352816581726,"z":"1fa209ca.68bcc6","wires":[]},{"id":"c6ace3f8.10c9","type":"set","name":"set generate-FQPN-input.network-name","xml":"<set>\n<parameter name='generate-FQPN-input.network-name' \n\tvalue='`$tmp.network-role-query-results[$q].l3-network.network-name`' />\n<parameter name='generate-FQPN-input.network-id' \n\tvalue='`$tmp.network-role-query-results[$q].l3-network.network-id`' />","comments":"","x":2560.773567199707,"y":1873.3927431106567,"z":"1fa209ca.68bcc6","wires":[]},{"id":"da17823d.ca396","type":"set","name":"set query-results-found-index","xml":"<set>\n\t<parameter name='query-results-found-index' value = '`$q`' />","comments":"","x":2530.2498779296875,"y":1967.063325881958,"z":"1fa209ca.68bcc6","wires":[]},{"id":"6082a89a.d21ec8","type":"returnFailure","name":"BREAK","xml":"<return status='failure'>","comments":"","x":2463.392936706543,"y":2016.8570928573608,"z":"1fa209ca.68bcc6","wires":[]},{"id":"ea14bac6.97b598","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1442.82133102417,"y":1795.5714492797852,"z":"1fa209ca.68bcc6","wires":[["debcbc94.182ce","20db49f4.e01796"]]},{"id":"2f21d390.49b6bc","type":"switchNode","name":"set tmp.qresult.network-role","xml":"<set>\n<parameter name='tmp.qresult.network-role' value = '`$tmp.network-role-query-results[$q].l3-network.network-role`' />\n","comments":"","outputs":1,"x":1824.5357666015625,"y":1794.8571472167969,"z":"1fa209ca.68bcc6","wires":[[]]},{"id":"36b7f160.7d80ce","type":"switchNode","name":"set tmp.db1.network-role","xml":"<set>\n<parameter name='tmp.db1.network-role' value = '`$db1.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n","comments":"","outputs":1,"x":1307.0000457763672,"y":1696.642921447754,"z":"1fa209ca.68bcc6","wires":[[]]},{"id":"20db49f4.e01796","type":"returnSuccess","name":"CATCH BREAK","xml":"<return status='success'>\n","comments":"","x":1609.9642486572266,"y":1954.142910003662,"z":"1fa209ca.68bcc6","wires":[]},{"id":"b6c1cfe8.74caf","type":"switchNode","name":"set tmp.db1.network-role","xml":"<set>\n<parameter name='tmp.db1.network-role' value = '`$db1.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n","comments":"","outputs":1,"x":1338.5357131958008,"y":4217.9998433589935,"z":"1fa209ca.68bcc6","wires":[[]]},{"id":"958cac03.4a9f3","type":"returnSuccess","name":"CATCH BREAK","xml":"<return status='success'>\n","comments":"","x":1686.249755859375,"y":4410.571350097656,"z":"1fa209ca.68bcc6","wires":[]},{"id":"9525c570.063288","type":"switchNode","name":"set tmp.qresult.network-role","xml":"<set>\n<parameter name='tmp.qresult.network-role' value = '`$tmp.network-role-query-results[$q].l3-network.network-role`' />\n","comments":"","outputs":1,"x":1897.6784362792969,"y":4276.666721343994,"z":"1fa209ca.68bcc6","wires":[[]]},{"id":"2b9ad069.c1331","type":"switchNode","name":"switch network-role | query-result vs db1","xml":"<switch test='`$tmp.qresult.network-role == $tmp.db1.network-role`' >\n","comments":"","outputs":1,"x":1937.7381286621094,"y":4324.297742843628,"z":"1fa209ca.68bcc6","wires":[["d16be293.6196a"]]},{"id":"d7779888.5f9488","type":"returnFailure","name":"BREAK","xml":"<return status='failure'>","comments":"","x":2529.868927001953,"y":4467.3333950042725,"z":"1fa209ca.68bcc6","wires":[]},{"id":"b70e9260.d4d03","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1475.678367614746,"y":4277.428359985352,"z":"1fa209ca.68bcc6","wires":[["32938572.9de37a","958cac03.4a9f3"]]},{"id":"67372ecf.ddecc","type":"switchNode","name":"clear tmp.db1.network-role","xml":"<set>\n<parameter name='tmp.db1.network-role' value = '' />\n","comments":"","outputs":1,"x":864.3928756713867,"y":4007.2858924865723,"z":"1fa209ca.68bcc6","wires":[[]]},{"id":"39e9f916.d84206","type":"switchNode","name":"set tmp.qresult.network-role","xml":"<set>\n<parameter name='tmp.qresult.network-role' value = '`$tmp.network-role-query-results[$q].l3-network.network-role`' />\n","comments":"","outputs":1,"x":872.8214263916016,"y":1491.285732269287,"z":"1fa209ca.68bcc6","wires":[[]]},{"id":"fc0d7098.ec8bd","type":"switchNode","name":"set tmp.db1.network-role-tag","xml":"<set>\n<parameter name='tmp.db1.network-role-tag' value = '`$db1.vfc-to-network-role-mapping[$network-role-index].network-role-tag`' />\n","comments":"","outputs":1,"x":1319.5,"y":1740.476173400879,"z":"1fa209ca.68bcc6","wires":[[]]},{"id":"24dba145.3374ae","type":"switchNode","name":"clear tmp.db1.","xml":"<set>\n<parameter name='tmp.db1.' value = '' />\n\n","comments":"","outputs":1,"x":827.5000152587891,"y":1329.2261924743652,"z":"1fa209ca.68bcc6","wires":[[]]},{"id":"4af66944.e78d78","type":"get-resource","name":"Update GENERIC_RESOURCE_NAME (client-key)","xml":"<update plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n\tkey=\"update GENERIC_RESOURCE_NAME set context_id = $auto-ip-assignment-input.vf-module-id \n\t\tWHERE type = $tmp.grn.type.client-key AND context_id = $tmp.context-id.transient\">\n","comments":"","outputs":1,"x":906.0714721679688,"y":5832.441108703613,"z":"1fa209ca.68bcc6","wires":[["674917ce.c46028","ea4f9611.bab028"]]},{"id":"8a6c0049.b30ce","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-message' value=\"`'Error updating GENERIC_RESOURCE_NAME.context_id from TRANSIENT to '\n\t+ $vnf-topology-operation-input.vnf-request-information.vnf-id \n\t+ ' for generated vm-names. MANUAL clean up is required!'`\" />\n\n","comments":"","x":1379.3574447631836,"y":5831.322142601013,"z":"1fa209ca.68bcc6","wires":[]},{"id":"674917ce.c46028","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1195.9288330078125,"y":5831.39365196228,"z":"1fa209ca.68bcc6","wires":[["8a6c0049.b30ce"]]},{"id":"ea4f9611.bab028","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1202.7742347717285,"y":5877.88179397583,"z":"1fa209ca.68bcc6","wires":[["102700e5.9763cf"]]},{"id":"102700e5.9763cf","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-message' value=\"`'No GENERIC_RESOURCE_NAME found with context_id = TRANSIENT and type = '\n\t+ $vnf-topology-operation-input.vnf-request-information.vnf-id \n\t+ ' for vm-names. MANUAL clean up may be required!'`\" />\n\n","comments":"","x":1375.2144317626953,"y":5878.155340194702,"z":"1fa209ca.68bcc6","wires":[]},{"id":"bda4208a.4eeb9","type":"set","name":"set tmp.grn.type.client-key","xml":"<set>\n<parameter name='tmp.grn.type.client-key' value='VNFAPI_CLIENT_KEY' />\n","comments":"","x":826.7857971191406,"y":5683.154770851135,"z":"1fa209ca.68bcc6","wires":[]},{"id":"efaaa681.a9adf8","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":389.07142639160156,"y":20,"z":"1fa209ca.68bcc6","wires":[["bdeaac7e.eeba5"]]},{"id":"5c62b7dd.9563d8","type":"comment","name":"Need to check client-key length <=1000 chars","info":"","comments":"","x":4940.011932373047,"y":3799.393243789673,"z":"1fa209ca.68bcc6","wires":[]},{"id":"54f2b045.0b32","type":"set","name":"set tmp.client-key.seq++","xml":"<set>\n<parameter name='tmp.client-key.seq' value='`$tmp.client-key.seq + 1`' />\n","comments":"","x":4603.618713378906,"y":3037.0596923828125,"z":"1fa209ca.68bcc6","wires":[]},{"id":"700ab1d.f3b9c5","type":"switchNode","name":"switch: $tmp.client-key.seq < 10","xml":"<switch test='`$tmp.client-key.seq &lt; 10`'>\n","comments":"","outputs":1,"x":5056.9169273376465,"y":3595.6905097961426,"z":"1fa209ca.68bcc6","wires":[["dbd665a0.1ce068","ab21b7e.f1ec848"]]},{"id":"dbd665a0.1ce068","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":5306.964496612549,"y":3595.214225769043,"z":"1fa209ca.68bcc6","wires":[["a9f0a74e.1e2328"]]},{"id":"a9f0a74e.1e2328","type":"set","name":"set tmp.client-key.padding = 000","xml":"<set>\n<parameter name='tmp.client-key.padding' value='000' />\n","comments":"","x":5535.1669273376465,"y":3595.1905097961426,"z":"1fa209ca.68bcc6","wires":[]},{"id":"ab21b7e.f1ec848","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":5311.4169273376465,"y":3641.940510749817,"z":"1fa209ca.68bcc6","wires":[["a7fe81a3.3af48"]]},{"id":"a7fe81a3.3af48","type":"switchNode","name":"switch: $tmp.client-key.seq < 100","xml":"<switch test='`$tmp.client-key.seq &lt; 100`'>\n","comments":"","outputs":1,"x":5550.1669273376465,"y":3642.190511703491,"z":"1fa209ca.68bcc6","wires":[["b5316e27.f6bb8","25c36479.1d6c3c"]]},{"id":"b5316e27.f6bb8","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":5797.666851043701,"y":3641.690456390381,"z":"1fa209ca.68bcc6","wires":[["1730f02c.72024"]]},{"id":"1730f02c.72024","type":"set","name":"set tmp.client-key.padding = 00","xml":"<set>\n<parameter name='tmp.client-key.padding' value='00' />\n","comments":"","x":6025.869281768799,"y":3641.6667404174805,"z":"1fa209ca.68bcc6","wires":[]},{"id":"25c36479.1d6c3c","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":5802.119281768799,"y":3688.416741371155,"z":"1fa209ca.68bcc6","wires":[["5d1a0d73.b3d164"]]},{"id":"5d1a0d73.b3d164","type":"switchNode","name":"switch: $tmp.client-key.seq < 1000","xml":"<switch test='`$tmp.client-key.seq &lt; 1000`'>\n","comments":"","outputs":1,"x":6040.869281768799,"y":3688.666742324829,"z":"1fa209ca.68bcc6","wires":[["4da4ca2e.63bbf4","efbd32d2.a3652"]]},{"id":"4da4ca2e.63bbf4","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":6283.916851043701,"y":3688.190456390381,"z":"1fa209ca.68bcc6","wires":[["c01a5bcf.9d20d8"]]},{"id":"c01a5bcf.9d20d8","type":"set","name":"set tmp.client-key.padding = 0","xml":"<set>\n<parameter name='tmp.client-key.padding' value='0' />\n","comments":"","x":6507.666851043701,"y":3688.190456390381,"z":"1fa209ca.68bcc6","wires":[]},{"id":"efbd32d2.a3652","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":6287.666851043701,"y":3738.190456390381,"z":"1fa209ca.68bcc6","wires":[["76a6b0b3.36532"]]},{"id":"76a6b0b3.36532","type":"switchNode","name":"switch: $tmp.client-key.seq < 10000","xml":"<switch test='`$tmp.client-key.seq &lt; 10000`'>\n","comments":"","outputs":1,"x":6540.166851043701,"y":3736.940456390381,"z":"1fa209ca.68bcc6","wires":[["7270781f.413b38"]]},{"id":"7270781f.413b38","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":6783.2144203186035,"y":3736.4641704559326,"z":"1fa209ca.68bcc6","wires":[["bd183881.e66208"]]},{"id":"bd183881.e66208","type":"set","name":"set tmp.client-key.padding = null","xml":"<set>\n<parameter name='tmp.client-key.padding' value='' />\n","comments":"","x":7006.9644203186035,"y":3736.4641704559326,"z":"1fa209ca.68bcc6","wires":[]},{"id":"f04325bc.877968","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":4816.833354949951,"y":3596.190212249756,"z":"1fa209ca.68bcc6","wires":[["700ab1d.f3b9c5"]]},{"id":"fad632eb.6a9c1","type":"set","name":"set client-key,  info","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].client-key'\n   value=\"`$eipam-ip-block.plans[$pidx].requests[$ridx].vm-type + '|' +\n\t\t\t$eipam-ip-block.plans[$pidx].requests[$ridx].vnf-vms[$vm-type-index].vm-names[$vm-index].vnfc-names[0].vnfc-name + '|' +\n\t\t\t$eipam-ip-block.plans[$pidx].requests[$ridx].network-role + '|' + \n\t\t\t$eipam-ip-block.plans[$pidx].requests[$ridx].subnet-role + '|' +\n\t\t\t$eipam-ip-block.plans[$pidx].requests[$ridx].ip-type + '|' + \n\t\t\t$eipam-ip-block.plans[$pidx].requests[$ridx].ip-version + '|' +\n\t\t\t$tmp.client-key.padding + $tmp.client-key.seq`\"/>\n\n<!-- rdn|zrdm3amdns02testdns001|data|static|VIP|4|0001 -->\n\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].info'\n   value='`$auto-ip-assignment-input.vf-module-id`' />\n","comments":"","x":4828.833534240723,"y":3759.8570518493652,"z":"1fa209ca.68bcc6","wires":[]},{"id":"218a8cf.c29d374","type":"set","name":"set client-key,  info","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].client-key'\n   value=\"`$eipam-ip-block.plans[$pidx].requests[$ridx].vm-type + '|' +\n\t\t\t$eipam-ip-block.plans[$pidx].requests[$ridx].network-role + '|' + \n\t\t\t$eipam-ip-block.plans[$pidx].requests[$ridx].subnet-role + '|' +\n\t\t\t$eipam-ip-block.plans[$pidx].requests[$ridx].ip-type + '|' + \n\t\t\t$eipam-ip-block.plans[$pidx].requests[$ridx].ip-version + '|' + \n\t\t\t$eipam-ip-block.plans[$pidx].requests[$ridx].group-number + '|0001'`\" />\n\n<!-- rdn|data|static|FIXED|4|1|0001 -->\n\n<parameter name='eipam-ip-block.plans[$pidx].requests[$ridx].info'\n   value='`$auto-ip-assignment-input.vf-module-id`' />\n","comments":"","x":3995.499755859375,"y":5663.1901512146,"z":"1fa209ca.68bcc6","wires":[]},{"id":"39576ccf.08aa54","type":"switchNode","name":"switch: auto-ip-assignment-input.service-instance-id","xml":"<switch test='`$auto-ip-assignment-input.service-instance-id`'>","comments":"","outputs":1,"x":531.2500152587891,"y":280.00000381469727,"z":"1fa209ca.68bcc6","wires":[["ed1ef22c.7f465"]]},{"id":"ed1ef22c.7f465","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":825.7500228881836,"y":279.50000381469727,"z":"1fa209ca.68bcc6","wires":[["605ea0e9.015e7"]]},{"id":"605ea0e9.015e7","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"auto-ip-assignment-input.service-instance-id is null\" />\n","comments":"","x":980.166690826416,"y":279.61110067367554,"z":"1fa209ca.68bcc6","wires":[]},{"id":"db49eb6e.176328","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":1621.2978401184082,"y":5295.273439407349,"z":"1fa209ca.68bcc6","wires":[["6580bb9b.736154"]]},{"id":"593fe1a1.e7f5c","type":"switchNode","name":"switch: auto-ip-assignment-input.service-type","xml":"<switch test='`$auto-ip-assignment-input.service-type`'>\n","comments":"","outputs":1,"x":1363.750015258789,"y":5295.2500829696655,"z":"1fa209ca.68bcc6","wires":[["db49eb6e.176328"]]},{"id":"6580bb9b.736154","type":"set","name":"set service-data.service-information.service-type","xml":"<set>\n<parameter name='service-data.service-information.service-type' value='NA' />\n","comments":"","x":1897.500015258789,"y":5295.250003814697,"z":"1fa209ca.68bcc6","wires":[]},{"id":"f195efcb.8c3b5","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1073.750015258789,"y":5295.250082015991,"z":"1fa209ca.68bcc6","wires":[["593fe1a1.e7f5c","ec903613.4cc188"]]},{"id":"e26be7e0.c31918","type":"set","name":"set tmp.client-key.seq++","xml":"<set>\n<parameter name='tmp.client-key.seq' value='`$tmp.client-key.seq + 1`' />\n","comments":"","x":4592.857200622559,"y":3375.7142639160156,"z":"1fa209ca.68bcc6","wires":[]},{"id":"b8156cb0.f8602","type":"set","name":"set tmp.client-key.seq = 0","xml":"<set>\n<parameter name='tmp.client-key.seq' value='0' />\n","comments":"","x":3815.71435546875,"y":2928.571533203125,"z":"1fa209ca.68bcc6","wires":[]},{"id":"c276cfd9.9bcae","type":"set","name":"set tmp.client-key.seq = 0","xml":"<set>\n<parameter name='tmp.client-key.seq' value='0' />\n","comments":"","x":3815.71435546875,"y":3262.857177734375,"z":"1fa209ca.68bcc6","wires":[]}]