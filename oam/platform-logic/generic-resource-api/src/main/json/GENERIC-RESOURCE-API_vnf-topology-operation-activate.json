[{"id":"9823088a.34ff58","type":"dgstart","name":"DGSTART","outputs":1,"x":100,"y":83.84222793579102,"z":"cdcd3fce.c4de3","wires":[["fbfa5c5e.c6d4c"]]},{"id":"fbfa5c5e.c6d4c","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":213.6190414428711,"y":124.08033847808838,"z":"cdcd3fce.c4de3","wires":[["98148b78.bcdc48"]]},{"id":"98148b78.bcdc48","type":"method","name":"method vnf-topology-operation-activate","xml":"<method rpc='vnf-topology-operation-activate' mode='sync'>\n","comments":"","outputs":1,"x":191.4286346435547,"y":164.508882522583,"z":"cdcd3fce.c4de3","wires":[["5d97c1d9.e769b"]]},{"id":"27e22f18.ec93b","type":"comment","name":"vnf-topology-operation-activate","info":"","comments":"","x":494.34485626220703,"y":31.428571701049805,"z":"cdcd3fce.c4de3","wires":[]},{"id":"a900d36.082793","type":"switchNode","name":"switch request-action","xml":"<switch test='`$vnf-topology-operation-input.request-information.request-action`'>\n","comments":"","outputs":1,"x":503.52381134033203,"y":262.6993656158447,"z":"cdcd3fce.c4de3","wires":[["f5a183f3.59793","75104916.f4da18"]]},{"id":"f5a183f3.59793","type":"outcome","name":"CreateVnfInstance","xml":"<outcome value='CreateVnfInstance'>\n","comments":"","outputs":1,"x":721.9047737121582,"y":239.8422498703003,"z":"cdcd3fce.c4de3","wires":[["d9356d39.56626"]]},{"id":"75104916.f4da18","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":685.9047393798828,"y":285.5565776824951,"z":"cdcd3fce.c4de3","wires":[["618d2805.15c2d8"]]},{"id":"d9356d39.56626","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":908.7619018554688,"y":239.8422794342041,"z":"cdcd3fce.c4de3","wires":[[]]},{"id":"618d2805.15c2d8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"If svc-action is 'activate' then request-action must be 'CreateVnfInstance'\" />\n","comments":"","x":925.9047470092773,"y":285.5565357208252,"z":"cdcd3fce.c4de3","wires":[]},{"id":"5d97c1d9.e769b","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":176.66666412353516,"y":385.5088996887207,"z":"cdcd3fce.c4de3","wires":[["a900d36.082793","7ddc2902.deaee8","97af8d2b.356cc","19b9abee.4b7d14","875c5b74.b738b8","70ffb4f.340354c","d8d2dde2.810b9","bd43a88e.1bb6f8"]]},{"id":"7ddc2902.deaee8","type":"switchNode","name":"switch vnf_length","xml":"<switch test='`$service-data.vnfs.vnf_length`'>\n","comments":"","outputs":1,"x":489.99998474121094,"y":332.17559146881104,"z":"cdcd3fce.c4de3","wires":[["ae8c14d3.92fde8"]]},{"id":"ae8c14d3.92fde8","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":676.6666641235352,"y":331.5088891983032,"z":"cdcd3fce.c4de3","wires":[["9f893ed1.bf8d"]]},{"id":"9f893ed1.bf8d","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs in MD-SAL\" />\n","comments":"","x":858.3332901000977,"y":331.5088891983032,"z":"cdcd3fce.c4de3","wires":[]},{"id":"97af8d2b.356cc","type":"for","name":"for each vnf","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n","comments":"","outputs":1,"x":471.66666412353516,"y":380.50890922546387,"z":"cdcd3fce.c4de3","wires":[["6ccab3b2.bb933c"]]},{"id":"6ccab3b2.bb933c","type":"switchNode","name":"switch this vnf-id == input vnf-id","xml":"<switch test='`$service-data.vnfs.vnf[$idx].vnf-id == $vnf-topology-operation-input.vnf-information.vnf-id`'>\n","comments":"","outputs":1,"x":726.6667518615723,"y":379.1755771636963,"z":"cdcd3fce.c4de3","wires":[["fe8e566e.b1b388"]]},{"id":"fe8e566e.b1b388","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":965.0000381469727,"y":378.175555229187,"z":"cdcd3fce.c4de3","wires":[["e8000355.b551"]]},{"id":"e8000355.b551","type":"set","name":"set vnf-index","xml":"<set>\n<parameter name='vnf-index' value='`$idx`' />\n","comments":"","x":1133.3332328796387,"y":378.1755771636963,"z":"cdcd3fce.c4de3","wires":[]},{"id":"19b9abee.4b7d14","type":"switchNode","name":"switch vnf-index","xml":"<switch test='`$vnf-index`'>\n","comments":"","outputs":1,"x":483.3333282470703,"y":427.1755790710449,"z":"cdcd3fce.c4de3","wires":[["539a414b.f528f"]]},{"id":"539a414b.f528f","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":664.9999465942383,"y":426.50890922546387,"z":"cdcd3fce.c4de3","wires":[["3d4d7a09.a37936"]]},{"id":"3d4d7a09.a37936","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"'Could not find VNF ' + $vnf-topology-operation-input.vnf-information.vnf-id + ' in MD-SAL'\" />\n","comments":"","x":831.666633605957,"y":426.17553520202637,"z":"cdcd3fce.c4de3","wires":[]},{"id":"d8d2dde2.810b9","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":473.3332862854004,"y":778.842230796814,"z":"cdcd3fce.c4de3","wires":[]},{"id":"70ffb4f.340354c","type":"set","name":"set vnf-level-oper-status to Created","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.order-status' value='Created' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.last-rpc-action' value='`$vnf-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.last-action' value='`$vnf-topology-operation-input.request-information.request-action`' />\n","comments":"","x":535.8133964538574,"y":731.1793575286865,"z":"cdcd3fce.c4de3","wires":[]},{"id":"875c5b74.b738b8","type":"set","name":"copy input data","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.sdnc-request-header.' value='$vnf-topology-operation-input.sdnc-request-header.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.request-information.' value='$vnf-topology-operation-input.request-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.service-information.' value='$vnf-topology-operation-input.service-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-information.' value='$vnf-topology-operation-input.vnf-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-request-input.' value='$vnf-topology-operation-input.vnf-request-input.' />\n\n","comments":"","x":476.6665382385254,"y":687.1755390167236,"z":"cdcd3fce.c4de3","wires":[]},{"id":"d20df170.6a2e3","type":"switchNode","name":"switch current vnf-level-oper-status","xml":"<switch test=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.order-status`\">\n","comments":"","outputs":1,"x":540.0000495910645,"y":523.8422012329102,"z":"cdcd3fce.c4de3","wires":[["df045a00.9a1cc8","cb273963.15acc8","e0f4cddc.9bc1a"]]},{"id":"759eb0c7.19a54","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No generic-vnf found in AAI for vnf ID ' + $service-data.vnfs.vnf[$vnf-index].vnf-id`\" />\n","comments":"","x":990.0000228881836,"y":647.8421468734741,"z":"cdcd3fce.c4de3","wires":[]},{"id":"c389523d.1a902","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":821.0239219665527,"y":604.1279582977295,"z":"cdcd3fce.c4de3","wires":[["58ea1590.b05d5c"]]},{"id":"256c7551.a80d0a","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":829.5953521728516,"y":648.4136714935303,"z":"cdcd3fce.c4de3","wires":[["759eb0c7.19a54"]]},{"id":"58ea1590.b05d5c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating generic-vnf in AAI\" />\n","comments":"","x":992.690616607666,"y":604.6043519973755,"z":"cdcd3fce.c4de3","wires":[]},{"id":"bd43a88e.1bb6f8","type":"save","name":"update generic-vnf prov-status to NVTPROV","xml":"<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"generic-vnf\"\n   key=\"generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.vnf-id\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"prov-status\" value=\"NVTPROV\" />\n","comments":"","outputs":1,"x":568.3333473205566,"y":623.8422145843506,"z":"cdcd3fce.c4de3","wires":[["c389523d.1a902","256c7551.a80d0a"]]},{"id":"a0eb8f8a.c509e","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Order status must be PendingCreate or PendingDelete, but is currently '\n      + $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.order-status`\" />\n","comments":"","x":909.6665458679199,"y":562.8422517776489,"z":"cdcd3fce.c4de3","wires":[]},{"id":"df045a00.9a1cc8","type":"outcome","name":"PendingCreate","xml":"<outcome value='PendingCreate'>\n","comments":"","outputs":1,"x":784.9999961853027,"y":475.50890731811523,"z":"cdcd3fce.c4de3","wires":[["b50d2140.4c348"]]},{"id":"cb273963.15acc8","type":"outcome","name":"PendingDelete","xml":"<outcome value='PendingDelete'>\n","comments":"","outputs":1,"x":783.3333473205566,"y":518.8422317504883,"z":"cdcd3fce.c4de3","wires":[["b50d2140.4c348"]]},{"id":"e0f4cddc.9bc1a","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":758.3334503173828,"y":563.8422136306763,"z":"cdcd3fce.c4de3","wires":[["a0eb8f8a.c509e"]]},{"id":"b50d2140.4c348","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":943.3333168029785,"y":497.17559719085693,"z":"cdcd3fce.c4de3","wires":[[]]},{"id":"a9218298.5e734","type":"comment","name":"check removed with US622450","info":"","comments":"","x":418.57142857142856,"y":487.1428571428571,"z":"cdcd3fce.c4de3","wires":[]}]