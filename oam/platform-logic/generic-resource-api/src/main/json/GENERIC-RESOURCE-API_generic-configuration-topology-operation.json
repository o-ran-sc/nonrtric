[{"id":"e883356.34111c8","type":"dgstart","name":"DGSTART","outputs":1,"x":112.5,"y":81.25,"z":"82021e0d.6c10f","wires":[["ada3b9c3.42b808"]]},{"id":"ada3b9c3.42b808","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":227.78569793701172,"y":121.48810863494873,"z":"82021e0d.6c10f","wires":[["3899865b.b33ffa"]]},{"id":"3899865b.b33ffa","type":"method","name":"method generic-configuration-topology-operation","xml":"<method rpc='generic-configuration-topology-operation' mode='sync'>\n","comments":"","outputs":1,"x":235.92862701416016,"y":162.2499942779541,"z":"82021e0d.6c10f","wires":[["5086b18d.4ec67"]]},{"id":"547b438e.e416cc","type":"comment","name":"generic-configuration-topology-operation","info":"","comments":"","x":506.84485626220703,"y":28.83634376525879,"z":"82021e0d.6c10f","wires":[]},{"id":"5086b18d.4ec67","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":150.83333587646484,"y":541.7530136108398,"z":"82021e0d.6c10f","wires":[["1b7b7f55.ca75f1","a234c467.3f1f18","4bb61d5b.460ef4","f8173995.43a8a8","25fce84e.946c28","e57bf2bf.a171e","79a2f2.c117fd1","732b206f.3ad56","6b6ce288.401eec"]]},{"id":"1b7b7f55.ca75f1","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"`$bonding-service-response.ackFinalIndicator`\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"success\" />\n\n","comments":"","x":366.6667137145996,"y":889.2529363632202,"z":"82021e0d.6c10f","wires":[]},{"id":"a234c467.3f1f18","type":"call","name":"call GENERIC-RESOURCE-API:validate-generic-configuration-input","xml":"<call module='GENERIC-RESOURCE-API' rpc='validate-generic-configuration-input' mode='sync' >\n","comments":"","outputs":1,"x":533.3333129882812,"y":243.33332920074463,"z":"82021e0d.6c10f","wires":[["c918f524.db0e78"]]},{"id":"c918f524.db0e78","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":843.3334159851074,"y":243.33349132537842,"z":"82021e0d.6c10f","wires":[["c74b0c40.892c5"]]},{"id":"c74b0c40.892c5","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n","comments":"","x":995.0000228881836,"y":241.66668319702148,"z":"82021e0d.6c10f","wires":[]},{"id":"be78a275.a3a47","type":"set","name":"create gc structure and set input data","xml":"<set>\n<parameter name='gc.configuration-id'\n  value='`$generic-configuration-topology-operation-input.configuration-information.configuration-id`' />\n<parameter name='gc.configuration-data.configuration-operation-information.sdnc-request-header.'\n  value='`$generic-configuration-topology-operation-input.sdnc-request-header.`' />\n<parameter name='gc.configuration-data.configuration-operation-information.request-information.'\n  value='`$generic-configuration-topology-operation-input.request-information.`' />\n<parameter name='gc.configuration-data.configuration-operation-information.service-information.'\n  value='`$generic-configuration-topology-operation-input.service-information.`' />\n<parameter name='gc.configuration-data.configuration-operation-information.configuration-information.'\n  value='`$generic-configuration-topology-operation-input.configuration-information.`' />\n<parameter name='gc.configuration-data.configuration-operation-information.gc-request-input.'\n  value='`$generic-configuration-topology-operation-input.gc-request-input.`' />\n","comments":"","x":948.3334121704102,"y":340.00002670288086,"z":"82021e0d.6c10f","wires":[]},{"id":"4bb61d5b.460ef4","type":"execute","name":"printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/bgb-genconfig.log' />\n","comments":"","outputs":1,"x":360.0000114440918,"y":841.666615486145,"z":"82021e0d.6c10f","wires":[[]]},{"id":"27bbd4ba.ada15c","type":"execute","name":"execute RestApiCallNode - PUT port-mirror-configuration","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.genconfig.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.gc-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-gc\" />\n\n","comments":"","outputs":1,"x":1009.9999618530273,"y":509.9999656677246,"z":"82021e0d.6c10f","wires":[["944485f3.4bf438","6f7f6f23.f4a3f"]]},{"id":"944485f3.4bf438","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1310.06978225708,"y":531.3315210342407,"z":"82021e0d.6c10f","wires":[["410435ab.f840ec"]]},{"id":"6f7f6f23.f4a3f","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1302.4984169006348,"y":489.83154106140137,"z":"82021e0d.6c10f","wires":[["410435ab.f840ec"]]},{"id":"ff91012.f4d53","type":"execute","name":"generate gc-configuration url","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.gc-configuration`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.gc-url\"/>\n    <parameter name=\"target\" value=\"{configuration-id}\"/>\n    <parameter name=\"replacement\" value=\"`$gc.configuration-id`\"/>\n","comments":"","outputs":1,"x":922.9166107177734,"y":443.33325958251953,"z":"82021e0d.6c10f","wires":[[]]},{"id":"410435ab.f840ec","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1465.4879264831543,"y":503.9043674468994,"z":"82021e0d.6c10f","wires":[["c0640b05.6555b8"]]},{"id":"c0640b05.6555b8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value='Error updating md-sal for gc-configuration' />\n","comments":"","x":1638.3333168029785,"y":503.33334255218506,"z":"82021e0d.6c10f","wires":[]},{"id":"f8173995.43a8a8","type":"execute","name":"execute readProperties","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n","comments":"","outputs":1,"x":394.9999542236328,"y":289.99999046325684,"z":"82021e0d.6c10f","wires":[[]]},{"id":"25fce84e.946c28","type":"execute","name":"generate bonding service url","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.bondingservice.server + $prop.bondingservice.uri`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.bs-url\"/>\n    <parameter name=\"target\" value=\"{action}\"/>\n    <parameter name=\"replacement\" value=\"`$generic-configuration-topology-operation-input.sdnc-request-header.svc-action`\"/>\n","comments":"","outputs":1,"x":413.3332977294922,"y":644.9999618530273,"z":"82021e0d.6c10f","wires":[[]]},{"id":"6b6ce288.401eec","type":"execute","name":"execute RestApiCallNode - POST to bonding service","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.bondingservice.templatefile`\" />\n    <parameter name='restapiUrl' value='`$tmp.bs-url`' />\n    <parameter name='restapiUser' value='`$prop.bondingservice.user`' />\n    <parameter name='restapiPassword' value='`$prop.bondingservice.password`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='POST' />\n    <parameter name=\"responsePrefix\" value=\"bonding-service-response\" />\n    <parameter name='customHttpHeaders'\n      value=\"`'Authorization=Basic ' + $prop.bondingservice.authorization`\" />\n","comments":"","outputs":1,"x":488.33331298828125,"y":693.3332386016846,"z":"82021e0d.6c10f","wires":[["242a445f.6d5b3c"]]},{"id":"242a445f.6d5b3c","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":760.8317565917969,"y":693.1649036407471,"z":"82021e0d.6c10f","wires":[["81f40e9f.9fbe8"]]},{"id":"81f40e9f.9fbe8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value=\"`'Error calling bonding service; ' + $error-message`\" />\n","comments":"","x":913.3332977294922,"y":692.3333005905151,"z":"82021e0d.6c10f","wires":[]},{"id":"e699d882.2d0db8","type":"set","name":"set order-status, etc","xml":"<set>\n<parameter name='gc.configuration-data.configuration-oper-status.order-status'\n  value='PendingCreate' />\n<parameter name='gc.configuration-data.configuration-oper-status.last-rpc-action'\n  value='assign' />\n<parameter name='gc.configuration-data.configuration-oper-status.last-action'\n  value='CreateGenericConfigurationInstance' />\n","comments":"","x":896.6666641235352,"y":393.3333101272583,"z":"82021e0d.6c10f","wires":[]},{"id":"85748cfd.60ffd","type":"set","name":"dummy set ackFinalIndicator","xml":"<set>\n<parameter name='bonding-service-response.ackFinalIndicator' value='N' />\n","comments":"","x":411.6667137145996,"y":743.3334188461304,"z":"82021e0d.6c10f","wires":[]},{"id":"e57bf2bf.a171e","type":"set","name":"set service-object-path","xml":"<set>\n<parameter name='service-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $service-data.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n","comments":"","x":391.6666603088379,"y":793.3332767486572,"z":"82021e0d.6c10f","wires":[]},{"id":"79a2f2.c117fd1","type":"switchNode","name":"switch svc-action","xml":"<switch test='`$generic-configuration-topology-operation-input.sdnc-request-header.svc-action`'>\n","comments":"","outputs":1,"x":376.66666412353516,"y":433.3333320617676,"z":"82021e0d.6c10f","wires":[["c3bb199d.f6e318"]]},{"id":"c3bb199d.f6e318","type":"outcome","name":"assign","xml":"<outcome value='assign'>\n","comments":"","outputs":1,"x":536.6666259765625,"y":431.6666564941406,"z":"82021e0d.6c10f","wires":[["9a06a155.15de7"]]},{"id":"9a06a155.15de7","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":685,"y":429.9999694824219,"z":"82021e0d.6c10f","wires":[["be78a275.a3a47","e699d882.2d0db8","ff91012.f4d53","27bbd4ba.ada15c"]]},{"id":"732b206f.3ad56","type":"set","name":"set notification-url","xml":"<set>\n<parameter name='notification-url'\n  value=\"`$prop.controller.url + '/restconf/operations/GENERIC-RESOURCE-API:generic-configuration-notification'`\" />\n","comments":"","x":379.9999771118164,"y":596.6667308807373,"z":"82021e0d.6c10f","wires":[]}]