[{"id":"652accf8.af78f4","type":"dgstart","name":"DGSTART","outputs":1,"x":115,"y":100,"z":"9a9cdd56.ab0e8","wires":[["245d2ed1.72c402"]]},{"id":"245d2ed1.72c402","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":228.85713958740234,"y":139.8095464706421,"z":"9a9cdd56.ab0e8","wires":[["8126c279.7385a"]]},{"id":"8126c279.7385a","type":"method","name":"method assign-vlan-tags","xml":"<method rpc='assign-vlan-tags' mode='sync'>\n","comments":"","outputs":1,"x":161.42861938476562,"y":179.99999618530273,"z":"9a9cdd56.ab0e8","wires":[["2b22e267.5880ce"]]},{"id":"a1ecd56f.4f7138","type":"comment","name":"assign-vlan-tags","info":"","comments":"","x":520.3210983276367,"y":42.97569942474365,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"2b22e267.5880ce","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":119.66666412353516,"y":1345,"z":"9a9cdd56.ab0e8","wires":[["2c244a0a.2f99a6","36cbdffa.88e67","e6dec19f.663c6","222c19b3.ff2636","811ae3a3.5562b","7c36bb21.e49e84","e5a5c2b7.e4596","ab38927e.7993a","e6008238.aa9a3","3b356a3d.30f4c6","5f217817.0236f8","3fd9412f.cfb7ae","4f6273f9.020e6c","f6eaa086.ac557","4a7282d1.a2361c","770d61b0.03e07","8518fce8.71575","33171a53.f82ee6","c5f0bc7b.328f2","65087d58.1bcb14","d92f8c4a.771eb","b8e066e.4d27d98","5d9fa9f6.6b9a18","f9e63e02.6c242","de447fe4.4319f","28ce36b5.91d29a","30b583e4.f4ac8c"]]},{"id":"36cbdffa.88e67","type":"set","name":"copy to tmp.vlan-vnics (to work in)","xml":"<set>\n<parameter name='tmp.vlan-vnics.'\n  value='`$tmp.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[0].vnic-groups.vnic-group[0].vlan-vnics.`' />\n","comments":"","x":463.3333854675293,"y":334.99997901916504,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"7c36bb21.e49e84","type":"whileNode","name":"while total-subs > 0","xml":"<while test='`$total-subs &gt; 0`'>\n","comments":"","outputs":1,"x":418.333309173584,"y":688.3333053588867,"z":"9a9cdd56.ab0e8","wires":[["41193025.7a02d"]]},{"id":"2c244a0a.2f99a6","type":"set","name":"set total-subs","xml":"<set>\n<parameter name='total-subs' value='`$get-data-from-policy-output.precreate-sub-intf-num`' />\n","comments":"","x":396.66670989990234,"y":378.3333377838135,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"811ae3a3.5562b","type":"set","name":"set sub-index, and vnic-index to 0","xml":"<set>\n<parameter name='sub-index' value='0' />\n<parameter name='vnic-index' value='0' />\n","comments":"","x":456.66675567626953,"y":514.9999523162842,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"84ee47a3.5e24c8","type":"set","name":"set vlan-tag-id","xml":"<set>\n<parameter name='tmp.vlan-vnics.vlan-vnic[$vnic-index].vnic-sub-interfaces.sub-interface-network-data[$sub-index].vlan-tag-id'\n  value='`$cur-tag-id`' />\n","comments":"","x":801.6667861938477,"y":545,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"222c19b3.ff2636","type":"set","name":"set cur-tag-id","xml":"<set>\n<parameter name='cur-tag-id' value='`$get-data-from-policy-output.vlan-tag-start + $get-data-from-policy-output.vlan-tag-offset`' />\n","comments":"","x":395.0000648498535,"y":471.6666069030762,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"f1e94268.d9f41","type":"set","name":"increment cur-tag-id","xml":"<set>\n<parameter name='cur-tag-id' value='`$cur-tag-id + 1`' />\n","comments":"","x":818.3333702087402,"y":645.0000743865967,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"42a5d8f7.b5c068","type":"set","name":"increment vnic-index","xml":"<set>\n<parameter name='vnic-index' value='`$vnic-index + 1`' />\n","comments":"","x":818.333309173584,"y":693.3333683013916,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"fc80639f.54e36","type":"switchNode","name":"switch vnic-index == vnic length?","xml":"<switch test='`$vnic-index == $tmp.vlan-vnics.vlan-vnic_length`'>\n","comments":"","outputs":1,"x":860.0000762939453,"y":751.6667718887329,"z":"9a9cdd56.ab0e8","wires":[["8011b82e.664018"]]},{"id":"1c586522.eb984b","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1204.99995803833,"y":748.3333721160889,"z":"9a9cdd56.ab0e8","wires":[["cb730d93.9895e","15998ce6.1407d3"]]},{"id":"cb730d93.9895e","type":"set","name":"set vnic-index to 0","xml":"<set>\n<parameter name='vnic-index' value='0' />\n","comments":"","x":1371.6667251586914,"y":720.000078201294,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"15998ce6.1407d3","type":"set","name":"increment sub-index","xml":"<set>\n<parameter name='sub-index' value='`$sub-index + 1`' />\n","comments":"","x":1378.3331909179688,"y":775.0001201629639,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"2d0797cd.e719b8","type":"set","name":"decrement total-subs","xml":"<set>\n<parameter name='total-subs' value='`$total-subs - 1`' />\n","comments":"","x":819.9999542236328,"y":813.3334627151489,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"e6dec19f.663c6","type":"switchNode","name":"switch total-subs > (vlan-vnics_length * max per VNIC)","xml":"<switch test='`$total-subs &gt; ( $tmp.vlan-vnics.vlan-vnic_length * $get-data-from-policy-output.max-num-sub-intf )`'>\n","comments":"","outputs":1,"x":523.333423614502,"y":425.0000162124634,"z":"9a9cdd56.ab0e8","wires":[["2849b86f.6f5298"]]},{"id":"1fe6d488.c1b37b","type":"set","name":"set total-subs = vlan-vnics_length * max per VNIC","xml":"<set>\n<parameter name='total-subs' value='`$tmp.vlan-vnics.vlan-vnic_length * $get-data-from-policy-output.max-num-sub-intf`' />\n","comments":"","x":1054.9999961853027,"y":424.9999952316284,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"80411e6d.8bfb1","type":"set","name":"set sub interface length","xml":"<set>\n<parameter name='tmp.vlan-vnics.vlan-vnic[$vnic-index].vnic-sub-interfaces.sub-interface-network-data_length'\n  value='`$sub-index + 1`' />\n","comments":"","x":828.3333892822266,"y":595.0001430511475,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"2849b86f.6f5298","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":796.6666984558105,"y":424.99999618530273,"z":"9a9cdd56.ab0e8","wires":[["1fe6d488.c1b37b"]]},{"id":"41193025.7a02d","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":608.333324432373,"y":686.666675567627,"z":"9a9cdd56.ab0e8","wires":[["84ee47a3.5e24c8","80411e6d.8bfb1","f1e94268.d9f41","42a5d8f7.b5c068","fc80639f.54e36","2d0797cd.e719b8"]]},{"id":"8011b82e.664018","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1068.3333282470703,"y":750.0000381469727,"z":"9a9cdd56.ab0e8","wires":[["1c586522.eb984b"]]},{"id":"e5a5c2b7.e4596","type":"set","name":"copy back tmp.vlan-vnics","xml":"<set>\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[0].vnic-groups.vnic-group[0].vlan-vnics.'\n  value='`$tmp.vlan-vnics.`' />\n","comments":"","x":420.50000381469727,"y":2816.499797821045,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"ab38927e.7993a","type":"set","name":"clear tmp.vlan-vnics","xml":"<set>\n<parameter name='tmp.vlan-vnics.' value='' />\n","comments":"","x":420.0000419616699,"y":288.3333511352539,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"e6008238.aa9a3","type":"for","name":"for each vlan-vnic","xml":"<for index='vnic-index' start='0' end='`$tmp.vlan-vnics.vlan-vnic_length`' >\n","comments":"","outputs":1,"x":414.16661834716797,"y":1465.000072479248,"z":"9a9cdd56.ab0e8","wires":[["8ec558ca.ea5e38"]]},{"id":"8ec558ca.ea5e38","type":"for","name":"for each subinterface","xml":"<for index='sub-index' start='0' end='`$tmp.vlan-vnics.vlan-vnic[$vnic-index].vnic-sub-interfaces.sub-interface-network-data_length`' >\n","comments":"","outputs":1,"x":620.8332824707031,"y":1465.000093460083,"z":"9a9cdd56.ab0e8","wires":[["4c6946af.e71148"]]},{"id":"4c6946af.e71148","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":827.4999694824219,"y":1463.33345413208,"z":"9a9cdd56.ab0e8","wires":[["23d29721.ac5b48","81b844d1.ae00d8","96cbf0d4.4b3ef"]]},{"id":"26c4311.85447ce","type":"comment","name":"First loop through networks looking for this vlan-tag-id","info":"","comments":"","x":1100.8333740234375,"y":1363.3334684371948,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"23d29721.ac5b48","type":"set","name":"set network-index, and unassigned-network-index to -1","xml":"<set>\n<parameter name='network-index' value='-1' />\n<parameter name='unassigned-network-index' value='-1' />\n","comments":"","x":1147.5000762939453,"y":1405.0001482963562,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"81b844d1.ae00d8","type":"for","name":"for each network","xml":"<for index='n-index' start='0' end='`$service-data.network-instance-groups.network-instance-group[$network-instance-group-index].networks.network_length`' >\n","comments":"","outputs":1,"x":1035.8332595825195,"y":1461.6668577194214,"z":"9a9cdd56.ab0e8","wires":[["99af6510.a954e8"]]},{"id":"3b356a3d.30f4c6","type":"set","name":"set network-instance-group-id","xml":"<set>\n<parameter name='network-instance-group-id' value='`$aai.instance-group.instance-group[$aai-ig-index].id`' />\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[0].vnic-groups.vnic-group[0].network-instance-group-id'\n  value='`$aai.instance-group.instance-group[$aai-ig-index].id`' />\n","comments":"","x":450.8333435058594,"y":1098.3333721160889,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"34d50f05.68416","type":"comment","name":"Assign vlan tag ids","info":"","comments":"","x":396.66668701171875,"y":243.33334732055664,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"c415275f.5939e8","type":"comment","name":"Find the network instance group","info":"","comments":"","x":462.5000228881836,"y":1161.6667041778564,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"5f217817.0236f8","type":"set","name":"set network-instance-group-index to -1","xml":"<set>\n<parameter name='network-instance-group-index' value='-1' />\n","comments":"","x":480.83335876464844,"y":1208.333351135254,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"3fd9412f.cfb7ae","type":"for","name":"for each network-instance-group","xml":"<for silentFailure='true' index='nig-index' start='0' end='`$service-data.network-instance-groups.network-instance-group_length`' >\n","comments":"","outputs":1,"x":459.1667022705078,"y":1254.9999389648438,"z":"9a9cdd56.ab0e8","wires":[["40199d4d.bebbb4"]]},{"id":"40199d4d.bebbb4","type":"switchNode","name":"network-instance-group-ids match?","xml":"<switch test='`$network-instance-group-id\n== $service-data.network-instance-groups.network-instance-group[$nig-index].network-instance-group-id`'>\n","comments":"","outputs":1,"x":760.8333435058594,"y":1253.3331909179688,"z":"9a9cdd56.ab0e8","wires":[["a53c53b3.4e3b2"]]},{"id":"a53c53b3.4e3b2","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":980.8334007263184,"y":1252.3332719802856,"z":"9a9cdd56.ab0e8","wires":[["90bd0614.2b8f68"]]},{"id":"90bd0614.2b8f68","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1114.1666984558105,"y":1251.6666870117188,"z":"9a9cdd56.ab0e8","wires":[["eef79ff5.34e3","a063161.08833e8"]]},{"id":"eef79ff5.34e3","type":"set","name":"set network-instance-group-index","xml":"<set>\n<parameter name='network-instance-group-index' value='`$nig-index`' />\n","comments":"","x":1332.499912261963,"y":1224.99995803833,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"a063161.08833e8","type":"break","name":"break","xml":"<break>\n","comments":"","x":1252.5000343322754,"y":1268.3332328796387,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"4f6273f9.020e6c","type":"switchNode","name":"switch network-instance-group-index","xml":"<switch test='`$network-instance-group-index`'>\n","comments":"","outputs":1,"x":470.8333740234375,"y":1310.0000629425049,"z":"9a9cdd56.ab0e8","wires":[["2acd473f.1481d8"]]},{"id":"2acd473f.1481d8","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":689.1666984558105,"y":1308.9998598098755,"z":"9a9cdd56.ab0e8","wires":[["3e46fcba.683d84"]]},{"id":"3e46fcba.683d84","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value=\"`'Unable to find network instance group ID '\n  + $network-instance-group-id\n  + ' in network-instance-groups'`\" />\n","comments":"","x":839.1667404174805,"y":1308.3333148956299,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"99af6510.a954e8","type":"switchNode","name":"vlan-tag-ids match?","xml":"<switch test='`$tmp.vlan-vnics.vlan-vnic[$vnic-index].vnic-sub-interfaces.sub-interface-network-data[$sub-index].vlan-tag-id\n  == $service-data.network-instance-groups.network-instance-group[$network-instance-group-index].networks.network[$n-index].vlan-tag-id`'>\n","comments":"","outputs":1,"x":1240.833366394043,"y":1461.6666145324707,"z":"9a9cdd56.ab0e8","wires":[["87e84e53.ace3e","4f742575.5d294c"]]},{"id":"87e84e53.ace3e","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1409.1666679382324,"y":1424.9999465942383,"z":"9a9cdd56.ab0e8","wires":[["b93b3695.96b0a8"]]},{"id":"b93b3695.96b0a8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1545.833236694336,"y":1423.3331890106201,"z":"9a9cdd56.ab0e8","wires":[["702e077b.b74c88","4d366511.05eb1c"]]},{"id":"702e077b.b74c88","type":"set","name":"set network-index","xml":"<set>\n<parameter name='network-index' value='`$n-index`' />\n","comments":"","x":1720.8331413269043,"y":1394.9997415542603,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"4d366511.05eb1c","type":"break","name":"break","xml":"<break>\n","comments":"","x":1684.1665725708008,"y":1439.99973487854,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"96cbf0d4.4b3ef","type":"switchNode","name":"switch network-index","xml":"<switch test='`$network-index`'>\n","comments":"","outputs":1,"x":1042.5001068115234,"y":1648.3332471847534,"z":"9a9cdd56.ab0e8","wires":[["6ec24dcf.1760e4","fee6142c.9a6e38"]]},{"id":"6ec24dcf.1760e4","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":1224.166618347168,"y":1588.3332052230835,"z":"9a9cdd56.ab0e8","wires":[["af21836d.750cb"]]},{"id":"fee6142c.9a6e38","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1220.8334884643555,"y":1712.3333311080933,"z":"9a9cdd56.ab0e8","wires":[["17a81eee.7b05e1"]]},{"id":"17a81eee.7b05e1","type":"set","name":"set network-id in subinterface","xml":"<set>\n<parameter name='tmp.vlan-vnics.vlan-vnic[$vnic-index].vnic-sub-interfaces.sub-interface-network-data[$sub-index].network-id'\n  value='`$service-data.network-instance-groups.network-instance-group[$network-instance-group-index].networks.network[$network-index].network-id`' />\n","comments":"","x":1429.1665496826172,"y":1711.6665019989014,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"6be392b3.eb74ec","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1802.4998931884766,"y":1641.6666622161865,"z":"9a9cdd56.ab0e8","wires":[["15321738.385e99","724ea597.a1b9bc"]]},{"id":"724ea597.a1b9bc","type":"set","name":"set this network as assigned to this vlan","xml":"<set>\n<parameter name='service-data.network-instance-groups.network-instance-group[$network-instance-group-index].networks.network[$unassigned-network-index].vlan-tag-id'\n  value='`$tmp.vlan-vnics.vlan-vnic[$vnic-index].vnic-sub-interfaces.sub-interface-network-data[$sub-index].vlan-tag-id`' />\n<parameter name='service-data.network-instance-groups.network-instance-group[$network-instance-group-index].networks.network[$unassigned-network-index].network-status'\n  value='assigned' />\n","comments":"","x":2027.499984741211,"y":1663.3333530426025,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"4f742575.5d294c","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1410.8334159851074,"y":1503.333402633667,"z":"9a9cdd56.ab0e8","wires":[["c0cf0c09.a1be"]]},{"id":"c0cf0c09.a1be","type":"switchNode","name":"switch unassigned-network-index","xml":"<switch test=\"`$unassigned-network-index`\">\n","comments":"","outputs":1,"x":1630.833251953125,"y":1501.666696548462,"z":"9a9cdd56.ab0e8","wires":[["973e08b7.3ab268"]]},{"id":"973e08b7.3ab268","type":"outcomeTrue","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":1842.499984741211,"y":1499.9998970031738,"z":"9a9cdd56.ab0e8","wires":[["8e8a8630.715dd8"]]},{"id":"445cd8d3.d38e48","type":"set","name":"set unassigned-network-index","xml":"<set>\n<parameter name='unassigned-network-index' value='`$n-index`' />\n","comments":"","x":2427.4997940063477,"y":1496.6666564941406,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"8e8a8630.715dd8","type":"switchNode","name":"switch network-status","xml":"<switch test='`$service-data.network-instance-groups.network-instance-group[$network-instance-group-index].networks.network[$n-index].network-status`'>\n","comments":"","outputs":1,"x":2022.500144958496,"y":1498.3332414627075,"z":"9a9cdd56.ab0e8","wires":[["11b8e83.0200718"]]},{"id":"11b8e83.0200718","type":"outcome","name":"unassigned","xml":"<outcome value='unassigned'>\n","comments":"","outputs":1,"x":2214.1664543151855,"y":1498.3332815170288,"z":"9a9cdd56.ab0e8","wires":[["445cd8d3.d38e48"]]},{"id":"af21836d.750cb","type":"switchNode","name":"switch unassigned-network-index","xml":"<switch test='`$unassigned-network-index`'>\n","comments":"","outputs":1,"x":1439.1666641235352,"y":1588.3334074020386,"z":"9a9cdd56.ab0e8","wires":[["63c42993.468758","c210e058.f7fab"]]},{"id":"63c42993.468758","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":1667.4999771118164,"y":1566.6666593551636,"z":"9a9cdd56.ab0e8","wires":[["739c22d8.39741c"]]},{"id":"c210e058.f7fab","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1669.1668815612793,"y":1641.9999952316284,"z":"9a9cdd56.ab0e8","wires":[["6be392b3.eb74ec"]]},{"id":"739c22d8.39741c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value=\"L3-network not found\" />\n","comments":"","x":1820.833236694336,"y":1564.9998970031738,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"15321738.385e99","type":"set","name":"set network-id in subinterface","xml":"<set>\n<parameter name='tmp.vlan-vnics.vlan-vnic[$vnic-index].vnic-sub-interfaces.sub-interface-network-data[$sub-index].network-id'\n  value='`$service-data.network-instance-groups.network-instance-group[$network-instance-group-index].networks.network[$unassigned-network-index].network-id`' />\n","comments":"","x":1997.4999084472656,"y":1613.3333282470703,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"f6eaa086.ac557","type":"for","name":"for each vlan-nvic","xml":"<for index='vnic-index' start='0' end='`$tmp.vlan-vnics.vlan-vnic_length`' >\n","comments":"","outputs":1,"x":400.8333282470703,"y":1819.9998970031738,"z":"9a9cdd56.ab0e8","wires":[["3e87d92c.aa7e66"]]},{"id":"3e87d92c.aa7e66","type":"for","name":"for each subinterface","xml":"<for index='sub-index' start='0' end='`$tmp.vlan-vnics.vlan-vnic[$vnic-index].vnic-sub-interfaces.sub-interface-network-data_length`' >\n","comments":"","outputs":1,"x":607.4999923706055,"y":1819.9999179840088,"z":"9a9cdd56.ab0e8","wires":[["5fd8a0cb.1af52"]]},{"id":"5fd8a0cb.1af52","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":805.8333282470703,"y":1818.333293914795,"z":"9a9cdd56.ab0e8","wires":[["a0a5a2fe.8466"]]},{"id":"a0a5a2fe.8466","type":"for","name":"for each network in service-data","xml":"<for index='n-index' start='0' end='`$service-data.networks.network_length`' >\n","comments":"","outputs":1,"x":1037.5,"y":1819.9998397827148,"z":"9a9cdd56.ab0e8","wires":[["7f9b587d.8b8bc8"]]},{"id":"7f9b587d.8b8bc8","type":"switchNode","name":"switch network-ids match?","xml":"<switch test='`$tmp.vlan-vnics.vlan-vnic[$vnic-index].vnic-sub-interfaces.sub-interface-network-data[$sub-index].network-id\n  == $service-data.networks.network[$n-index].network-id`'>\n","comments":"","outputs":1,"x":1312.5000305175781,"y":1818.3334169387817,"z":"9a9cdd56.ab0e8","wires":[["852afd7c.6b077"]]},{"id":"7bb29eb5.ce2aa","type":"set","name":"set network-name & role","xml":"<set>\n<parameter name='tmp.vlan-vnics.vlan-vnic[$vnic-index].vnic-sub-interfaces.sub-interface-network-data[$sub-index].network-name'\n  value='`$service-data.networks.network[$n-index].network-data.network-topology.network-topology-identifier-structure.network-name`' />\n<parameter name='tmp.vlan-vnics.vlan-vnic[$vnic-index].vnic-sub-interfaces.sub-interface-network-data[$sub-index].network-role'\n  value='`$service-data.networks.network[$n-index].network-data.network-topology.network-topology-identifier-structure.network-role`' />\n","comments":"","x":1819.1666412353516,"y":1791.6669521331787,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"489e8171.fadb3","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1634.1667594909668,"y":1815.0001640319824,"z":"9a9cdd56.ab0e8","wires":[["7bb29eb5.ce2aa","28e49c4e.dfc374"]]},{"id":"28e49c4e.dfc374","type":"break","name":"break","xml":"<break>\n","comments":"","x":1762.500057220459,"y":1838.3334999084473,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"4a7282d1.a2361c","type":"switchNode","name":"switch network-name","xml":"<switch test='`$tmp.vlan-vnics.vlan-vnic[$vnic-index].vnic-sub-interfaces.sub-interface-network-data[$sub-index].network-name`'>\n","comments":"","outputs":1,"x":407.50001525878906,"y":1904.9999656677246,"z":"9a9cdd56.ab0e8","wires":[["83949a40.48e068"]]},{"id":"83949a40.48e068","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":589.1666717529297,"y":1904.9998970031738,"z":"9a9cdd56.ab0e8","wires":[["31e77c14.ce4c94"]]},{"id":"31e77c14.ce4c94","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value=\"`'Failed to find a network name for network id '\n  + $service-data.networks.network[$n-index].network-id`\" />\n","comments":"","x":747.5000381469727,"y":1903.333257675171,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"770d61b0.03e07","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n","comments":"","x":385.50001525878906,"y":2881.4997596740723,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"852afd7c.6b077","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1504.1666107177734,"y":1816.6665229797363,"z":"9a9cdd56.ab0e8","wires":[["489e8171.fadb3"]]},{"id":"8518fce8.71575","type":"get-resource","name":"get-resource instance group","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n  resource=\"instance-groups\" \n  key=\"instance-group.instance-group-function = $db.group-uuids[$group-index].network-collection-function\n    AND instance-group.instance-group-type = 'L3-NETWORK'\"\n  pfx='aai.instance-group' local-only='false' >\n\n","comments":"","outputs":1,"x":448.3333511352539,"y":884.1666851043701,"z":"9a9cdd56.ab0e8","wires":[["9849af35.9608f","b9bb3c76.ee6f1"]]},{"id":"b9bb3c76.ee6f1","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":662.5794792175293,"y":907.3175296783447,"z":"9a9cdd56.ab0e8","wires":[["b3bb7492.879b88"]]},{"id":"9849af35.9608f","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":671.5081405639648,"y":860.603274345398,"z":"9a9cdd56.ab0e8","wires":[["33fbf4ac.607d1c"]]},{"id":"33fbf4ac.607d1c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\"\n      value=\"`'Unable to find AAI instance-group for instance-group-function '\n        + $db.group-uuids[$group-index].network-collection-function\n        + ' and instance-group-type L3-NETWORK'`\" />\n","comments":"","x":829.6667175292969,"y":859.1671562194824,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"b3bb7492.879b88","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\"\n      value=\"`'System error getting AAI instance-group for instance-group-function '\n        + $db.group-uuids[$group-index].network-collection-function\n        + ' and instance-group-type L3-NETWORK'`\" />\n","comments":"","x":829.6666526794434,"y":907.1671447753906,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"c5f0bc7b.328f2","type":"for","name":"for each returned instance-group","xml":"<for index='ig-index' start='0' end='`$aai.instance-group.instance-group_length`' >\n","comments":"","outputs":1,"x":464.3335189819336,"y":996.1671514511108,"z":"9a9cdd56.ab0e8","wires":[["59617a69.dbc4a4"]]},{"id":"59617a69.dbc4a4","type":"for","name":"for each relationship","xml":"<for index='rel-index' start='0' end='`$aai.instance-group.instance-group[$ig-index].relationship-list.relationship_length`' >\n","comments":"","outputs":1,"x":716.0001602172852,"y":995.1671504974365,"z":"9a9cdd56.ab0e8","wires":[["c1083251.cc8c1"]]},{"id":"c1083251.cc8c1","type":"for","name":"for each relationship-data","xml":"<for index='reldata-index' start='0' end='`$aai.instance-group.instance-group[$ig-index].relationship-list.relationship[$rel-index].relationship-data_length`' >\n","comments":"","outputs":1,"x":942.6668319702148,"y":994.500524520874,"z":"9a9cdd56.ab0e8","wires":[["2a508b7f.bacb04"]]},{"id":"2a508b7f.bacb04","type":"switchNode","name":"switch relationship-key == service-instance.service-instance-id","xml":"<switch test=\"`$aai.instance-group.instance-group[$ig-index].relationship-list.relationship[$rel-index].relationship-data[$reldata-index].relationship-key\n  == 'service-instance.service-instance-id'`\">\n","comments":"","outputs":1,"x":1301.0004196166992,"y":994.5004434585571,"z":"9a9cdd56.ab0e8","wires":[["13249590.69991a"]]},{"id":"13249590.69991a","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1597.666877746582,"y":994.5004758834839,"z":"9a9cdd56.ab0e8","wires":[["d4256ecd.7fa88"]]},{"id":"d4256ecd.7fa88","type":"switchNode","name":"switch relationship-value == this service-instance-id","xml":"<switch test='`$aai.instance-group.instance-group[$ig-index].relationship-list.relationship[$rel-index].relationship-data[$reldata-index].relationship-value\n  == $service-data.service-information.service-instance-id`'>\n","comments":"","outputs":1,"x":1862.6667022705078,"y":994.5004453659058,"z":"9a9cdd56.ab0e8","wires":[["a421e2d3.74531"]]},{"id":"33171a53.f82ee6","type":"set","name":"set found-instance-group to false","xml":"<set>\n<parameter name='found-instance-group' value='false' />\n","comments":"","x":464.33343505859375,"y":952.8336544036865,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"389120a7.29c36","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2249.3333892822266,"y":994.5004434585571,"z":"9a9cdd56.ab0e8","wires":[["a346204.a5f1be","2d1acd3b.a9b922","65d1ae7d.131c9"]]},{"id":"a346204.a5f1be","type":"set","name":"set found-instance-group to true","xml":"<set>\n<parameter name='found-instance-group' value='true' />\n","comments":"","x":2450.9999771118164,"y":951.1671094894409,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"2d1acd3b.a9b922","type":"set","name":"set aai-ig-index","xml":"<set>\n<parameter name='aai-ig-index' value='`$ig-index`' />\n","comments":"","x":2400.999813079834,"y":994.5005254745483,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"65d1ae7d.131c9","type":"break","name":"break","xml":"<break>\n","comments":"","x":2372.6668853759766,"y":1037.8338193893433,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"65087d58.1bcb14","type":"switchNode","name":"switch found-instance-group","xml":"<switch test='`$found-instance-group`'>\n","comments":"","outputs":1,"x":449.3335189819336,"y":1046.1672763824463,"z":"9a9cdd56.ab0e8","wires":[["886eaa87.ffc188"]]},{"id":"886eaa87.ffc188","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":646.0001564025879,"y":1046.1670751571655,"z":"9a9cdd56.ab0e8","wires":[["d4044e60.f7584"]]},{"id":"d4044e60.f7584","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\"\n      value=\"`'Unable to find AAI instance-group for instance-group-function '\n        + $db.group-uuids[$group-index].vfc-instance-group-function\n        + ' and instance-group-type VNFC'`\" />\n","comments":"","x":796.0000457763672,"y":1044.5004358291626,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"a421e2d3.74531","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2122.6666717529297,"y":994.5004358291626,"z":"9a9cdd56.ab0e8","wires":[["389120a7.29c36"]]},{"id":"85eb004c.66119","type":"comment","name":"Assign floating addresses","info":"","comments":"","x":370.83350372314453,"y":1962.0000457763672,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"b8e066e.4d27d98","type":"for","name":"for each vnf-network-collection","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-network-collections.vnf-network-collection_length`' >\n","comments":"","outputs":1,"x":432.50025939941406,"y":2050.500108718872,"z":"9a9cdd56.ab0e8","wires":[["74b16895.a08878"]]},{"id":"d92f8c4a.771eb","type":"set","name":"set found-collection to false","xml":"<set>\n<parameter name='found-collection' value='false' />\n","comments":"","x":424.1669235229492,"y":2004.5000247955322,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"74b16895.a08878","type":"switchNode","name":"network-instance-group-functions match?","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-network-collections.vnf-network-collection[$idx].network-instance-group-function\n  == $tmp.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[0].vnic-groups.vnic-group[0].network-instance-group-function`'>\n","comments":"","outputs":1,"x":750.8335571289062,"y":2049.8334016799927,"z":"9a9cdd56.ab0e8","wires":[["faaf1332.7d76d"]]},{"id":"faaf1332.7d76d","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":989.1670722961426,"y":2049.5000677108765,"z":"9a9cdd56.ab0e8","wires":[["975615df.39d208"]]},{"id":"975615df.39d208","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1119.1667518615723,"y":2047.833360671997,"z":"9a9cdd56.ab0e8","wires":[["7828863b.a6d328","8d6f3a41.20ed28","6d574b94.f3f394"]]},{"id":"7828863b.a6d328","type":"set","name":"set found-collection to true","xml":"<set>\n<parameter name='found-collection' value='true' />\n","comments":"","x":1299.1667556762695,"y":2001.1668548583984,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"de447fe4.4319f","type":"for","name":"for each network-instance-group","xml":"<for index='idx' start='0' end='`$service-data.network-instance-groups.network-instance-group_length`' >\n","comments":"","outputs":1,"x":432.50010681152344,"y":2191.1667013168335,"z":"9a9cdd56.ab0e8","wires":[["917af37.8643b1"]]},{"id":"917af37.8643b1","type":"switchNode","name":"network-instance-group-ids match?","xml":"<switch test='`$tmp.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[0].vnic-groups.vnic-group[0].network-instance-group-id\n  == $service-data.network-instance-groups.network-instance-group[$idx].network-instance-group-id`'>\n","comments":"","outputs":1,"x":730.8332824707031,"y":2189.5000858306885,"z":"9a9cdd56.ab0e8","wires":[["31f04a0f.57f536"]]},{"id":"31f04a0f.57f536","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":952.5000534057617,"y":2188.1668643951416,"z":"9a9cdd56.ab0e8","wires":[["ef7bae7e.384a9"]]},{"id":"8d6f3a41.20ed28","type":"break","name":"break","xml":"<break>\n","comments":"","x":1239.166919708252,"y":2089.500068664551,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"5d9fa9f6.6b9a18","type":"switchNode","name":"switch found-collection","xml":"<switch test='`$found-collection`'>\n","comments":"","outputs":1,"x":404.1669616699219,"y":2097.8334436416626,"z":"9a9cdd56.ab0e8","wires":[["381c3f44.23f99"]]},{"id":"381c3f44.23f99","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":577.5003108978271,"y":2097.8334436416626,"z":"9a9cdd56.ab0e8","wires":[["d682f9e9.9b2f58"]]},{"id":"d682f9e9.9b2f58","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value=\"`'Unable to find vnf-network-collection for network-instance-group-function '\n  + $tmp.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[$vnfc-index].vnic-groups.vnic-group[$vnic-group-index].network-instance-group-function`\" />\n","comments":"","x":720.8334808349609,"y":2097.8333673477173,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"6d574b94.f3f394","type":"set","name":"set vnc-index","xml":"<set>\n<parameter name='vnc-index' value='`$idx`' />\n","comments":"","x":1262.5004959106445,"y":2046.166693687439,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"f9e63e02.6c242","type":"set","name":"set found-network-instance-group to false","xml":"<set>\n<parameter name='found-network-instance-group' value='false' />\n","comments":"","x":460.8334655761719,"y":2144.500030517578,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"ef7bae7e.384a9","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1084.166732788086,"y":2186.1666193008423,"z":"9a9cdd56.ab0e8","wires":[["1c1479c5.0e3596","44374f33.c4d29","ca9bcaba.3c7cb8"]]},{"id":"1c1479c5.0e3596","type":"set","name":"set found-network-instance-group to true","xml":"<set>\n<parameter name='found-network-instance-group' value='true' />\n","comments":"","x":1312.5001678466797,"y":2139.500153541565,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"44374f33.c4d29","type":"break","name":"break","xml":"<break>\n","comments":"","x":1204.1669006347656,"y":2227.833327293396,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"ca9bcaba.3c7cb8","type":"set","name":"set nig-index","xml":"<set>\n<parameter name='nig-index' value='`$idx`' />\n","comments":"","x":1227.5004768371582,"y":2184.499952316284,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"28ce36b5.91d29a","type":"switchNode","name":"switch found-network-instance-group","xml":"<switch test='`$found-network-instance-group`'>\n","comments":"","outputs":1,"x":445.83343505859375,"y":2239.499831199646,"z":"9a9cdd56.ab0e8","wires":[["9c5a7f75.31353"]]},{"id":"9c5a7f75.31353","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":665.8336448669434,"y":2237.833409309387,"z":"9a9cdd56.ab0e8","wires":[["c0ff935e.ce4da"]]},{"id":"c0ff935e.ce4da","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value=\"`'Unable to find network-instance-group for network-instance-group-id '\n  + $tmp.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[$vnfc-index].vnic-groups.vnic-group[$vnic-group-index].network-instance-group-id`\" />\n","comments":"","x":809.1668148040771,"y":2237.833333015442,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"30b583e4.f4ac8c","type":"for","name":"for each subnet","xml":"<for silentFailure='true' index='subnet-index' start='0'\n  end='`$service-data.network-instance-groups.network-instance-group[$nig-index].subnets_length`' >\n","comments":"","outputs":1,"x":380.83331298828125,"y":2536.1669960021973,"z":"9a9cdd56.ab0e8","wires":[["c35334b3.d58d88"]]},{"id":"c35334b3.d58d88","type":"switchNode","name":"switch ip-version","xml":"<switch test='`$service-data.network-instance-groups.network-instance-group[$nig-index].subnets[$subnet-index].ip-version`'>\n","comments":"","outputs":1,"x":564.1666488647461,"y":2536.1669149398804,"z":"9a9cdd56.ab0e8","wires":[["3089a3c3.ba118c","b9ee7c6.9b83c8"]]},{"id":"3089a3c3.ba118c","type":"outcome","name":"ipv4","xml":"<outcome value='ipv4'>\n","comments":"","outputs":1,"x":727.5001564025879,"y":2421.166756629944,"z":"9a9cdd56.ab0e8","wires":[["4f0afcd5.e043f4"]]},{"id":"b9ee7c6.9b83c8","type":"outcome","name":"ipv6","xml":"<outcome value='ipv6'>\n","comments":"","outputs":1,"x":729.1667709350586,"y":2657.83327960968,"z":"9a9cdd56.ab0e8","wires":[["76c81b8.f9018e4"]]},{"id":"f9ac0c48.bea23","type":"switchNode","name":"switch network collection vipv4-address","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-network-collections.vnf-network-collection[$vnc-index].vnf-floating-ip.ip-addresses.vipv4-address`'>\n","comments":"","outputs":1,"x":1087.5005798339844,"y":2354.500081062317,"z":"9a9cdd56.ab0e8","wires":[["b6283c51.9a1"]]},{"id":"b6283c51.9a1","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":1322.5003280639648,"y":2352.833245277405,"z":"9a9cdd56.ab0e8","wires":[["4d266e16.60cc6"]]},{"id":"a968161.37c5ae8","type":"set","name":"set variables for EIPAM calls","xml":"<set>\n<parameter name='tmp.vt-ip.network-instance-group-id'\n  value='`$tmp.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[$vnfc-index].vnic-groups.vnic-group[$vnic-group-index].network-instance-group-id`' />\n<parameter name='tmp.vt-ip.network-instance-group-function'\n  value='`$tmp.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[$vnfc-index].vnic-groups.vnic-group[$vnic-group-index].network-instance-group-function`' />\n<parameter name='tmp.vt-ip.nf-role'\n  value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.nf-role`' />\n<parameter name='tmp.vt-ip.vm-type'\n  value='`$db.group-uuids[$group-index].vm-type`' />\n<parameter name='tmp.vt-ip.vnfc-name'\n  value='`$tmp.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[$vnfc-index].vnfc-name`' />\n<parameter name='tmp.vt-ip.type'\n  value='VIP' />\n<parameter name='tmp.vt-ip.vf-module-id'\n  value='`$vf-module-topology-operation-input.vf-module-information.vf-module-id`' />\n<parameter name='tmp.vt-ip.ip-version'\n  value='ipv4' />\n<parameter name='tmp.vt-ip.network-id'\n  value='`$tmp.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[$vnfc-index].vnic-groups.vnic-group[$vnic-group-index].vlan-vnics.vlan-vnic[0].vnic-sub-interface.sub-interface-network-data[0].network-id`' />\n","comments":"","x":1644.166862487793,"y":2294.5000791549683,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"4d266e16.60cc6","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1447.5003280639648,"y":2352.833245277405,"z":"9a9cdd56.ab0e8","wires":[["a968161.37c5ae8","b44508ed.c8e008","174299a1.3bc446","e48077b.3ea7a88"]]},{"id":"b44508ed.c8e008","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-vlan-tagging-ip-addresses","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-vlan-tagging-ip-addresses' mode='sync' >\n","comments":"","outputs":1,"x":1799.1668319702148,"y":2341.166741371155,"z":"9a9cdd56.ab0e8","wires":[["3f1cec1d.1871f4"]]},{"id":"3f1cec1d.1871f4","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2152.500186920166,"y":2339.500075340271,"z":"9a9cdd56.ab0e8","wires":[["a2851cad.d2b5d"]]},{"id":"a2851cad.d2b5d","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n","comments":"","x":2300.833610534668,"y":2337.8332147598267,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"174299a1.3bc446","type":"set","name":"set test EIPAM response","xml":"<set>\n<parameter name='eipam-ip-block.plans_length' value='2' />\n<parameter name='eipam-ip-block.plans[0].plan-name' value='plan-1' />\n<parameter name='eipam-ip-block.plans[0].requests_length' value='1' />\n<parameter name='eipam-ip-block.plans[0].requests[0].client-key'\n  value='vm-type-1|zmtn6nf-code-16code-1001|network-role-1|subnet-role-1|FIXED|4|1' />\n<parameter name='eipam-ip-block.plans[0].requests[0].ip-type' value='FIXED' />\n<parameter name='eipam-ip-block.plans[0].requests[0].ip-prefix' value=\"`'34.52.87.1' + $counter`\" />\n<parameter name='eipam-ip-block.plans[0].requests[0].ip-version' value='4' />\n","comments":"","x":1630.8335800170898,"y":2389.49999332428,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"e48077b.3ea7a88","type":"set","name":"set network collection vipv4-address","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-network-collections.vnf-network-collection[$vnc-index].vnf-floating-ip.ip-addresses.vipv4-address'\n  value='`$eipam-ip-block.plans[0].requests[0].ip-prefix`' />\n","comments":"","x":1667.5002746582031,"y":2434.5001649856567,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"4f0afcd5.e043f4","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":857.5001525878906,"y":2419.4999990463257,"z":"9a9cdd56.ab0e8","wires":[["f9ac0c48.bea23","44e75606.5d9828"]]},{"id":"44e75606.5d9828","type":"for","name":"for each vlan-vnic","xml":"<for index='vlan-vnic-index' start='0' end='`$tmp.vlan-vnics.vlan-vnic_length`' >\n","comments":"","outputs":1,"x":1024.166732788086,"y":2492.833245277405,"z":"9a9cdd56.ab0e8","wires":[["78c15aef.261da4"]]},{"id":"78c15aef.261da4","type":"for","name":"for each sub-interface","xml":"<for index='sub-index' start='0' end='`$tmp.vlan-vnics.vlan-vnic[$vlan-vnic-index].vnic-sub-interfaces.sub-interface-network-data_length`' >\n","comments":"","outputs":1,"x":1230.8335037231445,"y":2492.8331747055054,"z":"9a9cdd56.ab0e8","wires":[["9cc506c6.cacec8"]]},{"id":"9cc506c6.cacec8","type":"set","name":"set floating-ip-v4","xml":"<set>\n<parameter name='tmp.vlan-vnics.vlan-vnic[$vlan-vnic-index].vnic-sub-interfaces.sub-interface-network-data[$sub-index].floating-ips.floating-ip-v4'\n  value='`$eipam-ip-block.plans[0].requests[0].ip-prefix`' />\n","comments":"","x":1432.500099182129,"y":2492.8335008621216,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"7b56555a.339a6c","type":"switchNode","name":"switch network collection vipv6-address","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-network-collections.vnf-network-collection[$vnc-index].vnf-floating-ip.ip-addresses.vipv6-address`'>\n","comments":"","outputs":1,"x":1090.833480834961,"y":2594.49999332428,"z":"9a9cdd56.ab0e8","wires":[["4938431d.a63f9c"]]},{"id":"4938431d.a63f9c","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":1325.8332290649414,"y":2592.8331575393677,"z":"9a9cdd56.ab0e8","wires":[["2331e3c3.6f45ac"]]},{"id":"cd2467f7.91fd58","type":"set","name":"set variables for EIPAM calls","xml":"<set>\n<parameter name='tmp.vt-ip.network-instance-group-id'\n  value='`$tmp.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[$vnfc-index].vnic-groups.vnic-group[$vnic-group-index].network-instance-group-id`' />\n<parameter name='tmp.vt-ip.network-instance-group-function'\n  value='`$tmp.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[$vnfc-index].vnic-groups.vnic-group[$vnic-group-index].network-instance-group-function`' />\n<parameter name='tmp.vt-ip.nf-role'\n  value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.nf-role`' />\n<parameter name='tmp.vt-ip.vm-type'\n  value='`$db.group-uuids[$group-index].vm-type`' />\n<parameter name='tmp.vt-ip.vnfc-name'\n  value='`$tmp.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[$vnfc-index].vnfc-name`' />\n<parameter name='tmp.vt-ip.type'\n  value='VIP' />\n<parameter name='tmp.vt-ip.vf-module-id'\n  value='`$vf-module-topology-operation-input.vf-module-information.vf-module-id`' />\n<parameter name='tmp.vt-ip.ip-version'\n  value='ipv6' />\n<parameter name='tmp.vt-ip.network-id'\n  value='`$tmp.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[$vvig-index].vnfcs.vnfc[$vnfc-index].vnic-groups.vnic-group[$vnic-group-index].vlan-vnics.vlan-vnic[0].vnic-sub-interface.sub-interface-network-data[0].network-id`' />\n","comments":"","x":1647.4997634887695,"y":2534.499991416931,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"2331e3c3.6f45ac","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1450.8332290649414,"y":2592.8331575393677,"z":"9a9cdd56.ab0e8","wires":[["cd2467f7.91fd58","3a2cb18.85b084e","ad55df13.888ba","593a7f2c.310c7"]]},{"id":"3a2cb18.85b084e","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-vlan-tagging-ip-addresses","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-vlan-tagging-ip-addresses' mode='sync' >\n","comments":"","outputs":1,"x":1802.4997329711914,"y":2581.1666536331177,"z":"9a9cdd56.ab0e8","wires":[["a4c5186a.f96208"]]},{"id":"a4c5186a.f96208","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2155.8330879211426,"y":2579.499987602234,"z":"9a9cdd56.ab0e8","wires":[["c8656944.b5e6e8"]]},{"id":"c8656944.b5e6e8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n","comments":"","x":2304.1665115356445,"y":2577.8331270217896,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"ad55df13.888ba","type":"set","name":"set test EIPAM response","xml":"<set>\n<parameter name='eipam-ip-block.plans_length' value='2' />\n<parameter name='eipam-ip-block.plans[0].plan-name' value='plan-1' />\n<parameter name='eipam-ip-block.plans[0].requests_length' value='6' />\n<parameter name='eipam-ip-block.plans[0].requests[0].client-key'\n  value='vm-type-1|zmtn6nf-code-16code-1001|network-role-1|subnet-role-1|FIXED|4|1' />\n<parameter name='eipam-ip-block.plans[0].requests[0].ip-type' value='FIXED' />\n<parameter name='eipam-ip-block.plans[0].requests[0].ip-prefix' value=\"`'cafe:1111' + $counter`\" />\n<parameter name='eipam-ip-block.plans[0].requests[0].ip-version' value='6' />\n","comments":"","x":1634.1664810180664,"y":2629.4999055862427,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"593a7f2c.310c7","type":"set","name":"set network collection vipv6-address","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-network-collections.vnf-network-collection[$vnc-index].vnf-floating-ip.ip-addresses.vipv6-address'\n  value='`$eipam-ip-block.plans[0].requests[0].ip-prefix`' />\n","comments":"","x":1670.8331756591797,"y":2674.5000772476196,"z":"9a9cdd56.ab0e8","wires":[]},{"id":"76c81b8.f9018e4","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":862.4998321533203,"y":2656.16659450531,"z":"9a9cdd56.ab0e8","wires":[["7b56555a.339a6c","c214cfe5.d1b16"]]},{"id":"c214cfe5.d1b16","type":"for","name":"for each vlan-vnic","xml":"<for index='vlan-vnic-index' start='0' end='`$tmp.vlan-vnics.vlan-vnic_length`' >\n","comments":"","outputs":1,"x":1027.4996337890625,"y":2732.8331575393677,"z":"9a9cdd56.ab0e8","wires":[["5eb6afaa.d832"]]},{"id":"5eb6afaa.d832","type":"for","name":"for each sub-interface","xml":"<for index='sub-index' start='0' end='`$tmp.vlan-vnics.vlan-vnic[$vlan-vnic-index].vnic-sub-interfaces.sub-interface-network-data_length`' >\n","comments":"","outputs":1,"x":1234.166404724121,"y":2732.8330869674683,"z":"9a9cdd56.ab0e8","wires":[["f3af3152.84e6"]]},{"id":"f3af3152.84e6","type":"set","name":"set floating-ip-v6","xml":"<set>\n<parameter name='tmp.vlan-vnics.vlan-vnic[$vlan-vnic-index].vnic-sub-interfaces.sub-interface-network-data[$sub-index].floating-ips.floating-ip-v6'\n  value='`$eipam-ip-block.plans[0].requests[0].ip-prefix`' />\n","comments":"","x":1435.8330001831055,"y":2732.8334131240845,"z":"9a9cdd56.ab0e8","wires":[]}]