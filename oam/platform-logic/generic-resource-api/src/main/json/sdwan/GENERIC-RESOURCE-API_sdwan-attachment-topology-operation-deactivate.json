[
  {
    "id": "f8331c4a.37167",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 115,
    "y": 35,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "2f57f4b9.7848fc"
      ]
    ]
  },
  {
    "id": "2f57f4b9.7848fc",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 299.00000190734863,
    "y": 106.00001668930054,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "606390f2.8a1db"
      ]
    ]
  },
  {
    "id": "606390f2.8a1db",
    "type": "method",
    "name": "sdwan-attachment-topology-operation-deactivate",
    "xml": "<method rpc='sdwan-attachment-topology-operation-deactivate' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 287.00012016296387,
    "y": 193.99999952316284,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "4ba95650.840ef8"
      ]
    ]
  },
  {
    "id": "4ba95650.840ef8",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 303.00012016296387,
    "y": 749.000244140625,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "7bfab5a3.06caac",
        "45a84e1e.bdf7b",
        "169fcb74.40e255",
        "b2e9aacc.581ff8",
        "e34f2e02.a4351",
        "96bf45ea.f31428",
        "ade80637.81d448",
        "9fb629bb.9a3648",
        "4bdb1ae.9bc94e4",
        "85c9e5e0.4b2808",
        "321fef32.53b0b",
        "57a853e.4687fac",
        "c17cdc10.1ceea",
        "94474a0.f7cc5b8",
        "500ce0c3.5b4ed",
        "8054d01.53e0b3",
        "9c9d490e.b9a1b8",
        "75448c50.567d34",
        "965fc969.fd32d8",
        "d94628e2.163098",
        "b8f3c1af.8a68d",
        "5450bfab.9413e",
        "d6353ac9.cd8368",
        "de426682.23e5b8",
        "9c358a1f.148518",
        "7e6a4a74.fb8064",
        "e6e54d59.f029"
      ]
    ]
  },
  {
    "id": "7bfab5a3.06caac",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-id,etc",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n<parameter name='tmp.ar.parent-service-instance-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id`' />\n\n\n",
    "comments": "",
    "x": 699.993558883667,
    "y": 147.99348640441895,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "af7814ef.59e2e8",
    "type": "comment",
    "name": "set tmp ar-id to fetch resource from MDSAL",
    "info": "",
    "comments": "",
    "x": 728.9538707733154,
    "y": 112.02528238296509,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "45a84e1e.bdf7b",
    "type": "set",
    "name": "set tmp.ar.self-link",
    "xml": "<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:connection-attachment-allotted-resources/connection-attachment-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/connection-attachment-topology/'` \" />\n\n",
    "comments": "",
    "x": 653.9934978485107,
    "y": 240.99349164962769,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "b2e9aacc.581ff8",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 660.2553882598877,
    "y": 328.66022062301636,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "169fcb74.40e255",
    "type": "execute",
    "name": "generate allotted-resource tmp.ar-url",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.connection-attachment-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 710.2554912567139,
    "y": 415.6602215766907,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "a1f59482.c2e3a8",
    "type": "comment",
    "name": "GET connection-attachment-allotted-resource from mdsal",
    "info": "",
    "comments": "",
    "x": 753.808515548706,
    "y": 507.5387673377991,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "48f7ab81.dd3f54",
    "type": "comment",
    "name": "Used for setting output to API Handler",
    "info": "",
    "comments": "",
    "x": 707.9935283660889,
    "y": 207.99350118637085,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "c7689a40.af6f68",
    "type": "comment",
    "name": "Obtain different URL, template location etc",
    "info": "For saving resource information to MDSAL & for AAI",
    "comments": "",
    "x": 725.9934940338135,
    "y": 293.88238191604614,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "5bb7cd3a.b035e4",
    "type": "comment",
    "name": "Used to Get AR by id to MDSAL, same as self-link",
    "info": "",
    "comments": "",
    "x": 751.9935131072998,
    "y": 380.88234090805054,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "255752ab.e0974e",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1194.666826248169,
    "y": 534.0000281333923,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "7b548c16.84a074"
      ]
    ]
  },
  {
    "id": "7b548c16.84a074",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1363.6668300628662,
    "y": 532.4999289512634,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "30903850.9efd78"
      ]
    ]
  },
  {
    "id": "30903850.9efd78",
    "type": "switchNode",
    "name": "switch cr length",
    "xml": "<switch test='`$mdsal-ar.connection-attachment-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1536.5240993499756,
    "y": 470.1190915107727,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "f5872089.49e85",
        "fd0f2962.8ae6b8"
      ]
    ]
  },
  {
    "id": "f5872089.49e85",
    "type": "other",
    "name": "outcome 1",
    "xml": "<outcome value='1'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1773.857343673706,
    "y": 448.11904191970825,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "ddd5f356.20fb3"
      ]
    ]
  },
  {
    "id": "ddd5f356.20fb3",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic='true'>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1958.381233215332,
    "y": 445.0238757133484,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "26efebde.981c54",
        "f909f530.6858a8",
        "aab72afb.6cac28"
      ]
    ]
  },
  {
    "id": "49c172c3.b6fc6c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: SOTN resource not found\" />\n    \n",
    "comments": "",
    "x": 1882.5190753936768,
    "y": 570.066116809845,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "1a7aa44a.cd34ac",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1186.5186290740967,
    "y": 569.0661129951477,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "ea618a2d.cb5e38"
      ]
    ]
  },
  {
    "id": "ea618a2d.cb5e38",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1366.5185794830322,
    "y": 569.7326636314392,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "49c172c3.b6fc6c"
      ]
    ]
  },
  {
    "id": "fd0f2962.8ae6b8",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1762.185297012329,
    "y": 485.39940214157104,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "49c172c3.b6fc6c"
      ]
    ]
  },
  {
    "id": "26efebde.981c54",
    "type": "set",
    "name": "set connection-attachment-ar from get",
    "xml": "<set>\n<parameter name='connection-attachment-ar.' value='$mdsal-ar.connection-attachment-allotted-resource[0].' />\n",
    "comments": "",
    "x": 2204.4447917938232,
    "y": 405.00010538101196,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "aab72afb.6cac28",
    "type": "set",
    "name": "set oper-status",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.request-information.request-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$connection-attachment-ar.allotted-resource-status.rpc-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.svc-request-id`' />\n\n",
    "comments": "",
    "x": 2137.444787979126,
    "y": 495.4286599159241,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "f909f530.6858a8",
    "type": "switchNode",
    "name": "switch order-status",
    "xml": "<switch test='`$connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2148.4446239471436,
    "y": 449.00010919570923,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "dcae652b.a678c8",
        "61137107.6ab3"
      ]
    ]
  },
  {
    "id": "dcae652b.a678c8",
    "type": "outcome",
    "name": "outcome Active",
    "xml": "<outcome value='Active'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2355.0445728302,
    "y": 439.00010919570923,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "f4b4f2e4.a75bd"
      ]
    ]
  },
  {
    "id": "61137107.6ab3",
    "type": "outcome",
    "name": "outcome Other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2354.7590923309326,
    "y": 481.42869997024536,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "a2c4e7e4.8b9478"
      ]
    ]
  },
  {
    "id": "f4b4f2e4.a75bd",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2507.515127182007,
    "y": 437.375759601593,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "a2c4e7e4.8b9478",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" \n    value=\"`'Existing connection-attachment-allotted-resource with order status of ' + $connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status + '.'`\" />\n",
    "comments": "",
    "x": 2527.666982650757,
    "y": 478.00011110305786,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "8746fbbb.5c4dd8",
    "type": "call",
    "name": "call GENERIC-RESOURCE-API:sdwan-get-saved-ar-param",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sdwan-get-saved-ar-param' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 915.3031139373779,
    "y": 630.4935903549194,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "e34f2e02.a4351",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 612.3092784881592,
    "y": 631.4999384880066,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "8746fbbb.5c4dd8"
      ]
    ]
  },
  {
    "id": "96352635.65ff08",
    "type": "comment",
    "name": "GET parent-service-data from mdsal to check existence of other End point",
    "info": "",
    "comments": "",
    "x": 794.0004405975342,
    "y": 692.5316977500916,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "eb439772.0db3a8",
    "type": "comment",
    "name": "GET connection-attachment-ar to store AR data from mdsal",
    "info": "",
    "comments": "",
    "x": 2187.4729442596436,
    "y": 369.5039687156677,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "678453f3.6e4c2c",
    "type": "comment",
    "name": "Set source end point",
    "info": "",
    "comments": "",
    "x": 625.9728374481201,
    "y": 599.2540640830994,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "96bf45ea.f31428",
    "type": "set",
    "name": "set tmp.ar.parent-service-instance-id",
    "xml": "<set>\n<parameter name='tmp.ar.parent-service-instance-id' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id` \" />\n\n",
    "comments": "",
    "x": 678.968915939331,
    "y": 724.0002083778381,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "14706c37.53ff04",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1056.9689121246338,
    "y": 773.0002074241638,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "f7881611.1e7fc8"
      ]
    ]
  },
  {
    "id": "415e2268.5d0d3c",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1048.8207149505615,
    "y": 808.0662922859192,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "400a8be0.06c244"
      ]
    ]
  },
  {
    "id": "400a8be0.06c244",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: SOTN resource not found\" />\n    \n",
    "comments": "",
    "x": 1223.9694004058838,
    "y": 804.3336424827576,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "f7881611.1e7fc8",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1207.9689121246338,
    "y": 771.0002074241638,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "6055aad6.cfe2c4",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1037.7308254241943,
    "y": 2275.9528431892395,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "3f6ad50.2555b2c"
      ]
    ]
  },
  {
    "id": "3f6ad50.2555b2c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"AAI failed\" />\n",
    "comments": "",
    "x": 1199.25465965271,
    "y": 2320.571889281273,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "235942f0.e7b26e",
    "type": "failure",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1039.8260669708252,
    "y": 2341.7147859334946,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "3f6ad50.2555b2c"
      ]
    ]
  },
  {
    "id": "48fc4721.99e218",
    "type": "comment",
    "name": "Save Resource to AAI",
    "info": "",
    "comments": "",
    "x": 751.7784938812256,
    "y": 2291.302206516266,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "57a853e.4687fac",
    "type": "set",
    "name": "set output to api handler",
    "xml": "<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='connection-attachment-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $connection-attachment-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n",
    "comments": "",
    "x": 766.5461902618408,
    "y": 2212.827687740326,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "c17cdc10.1ceea",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 713.9593296051025,
    "y": 2407.443506717682,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "321fef32.53b0b",
    "type": "execute",
    "name": "execute RestApiCallNode - PUT AR by id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.sdwan-attachment.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 816.2782917022705,
    "y": 2120.4684615135193,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "51856f43.e53b6",
        "1d0bebfe.eab134",
        "559d3f61.79c98"
      ]
    ]
  },
  {
    "id": "51856f43.e53b6",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1084.9196681976318,
    "y": 2171.7998732551932,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "60114e3f.8f3c6"
      ]
    ]
  },
  {
    "id": "1d0bebfe.eab134",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1075.9197177886963,
    "y": 2140.2998990044,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "60114e3f.8f3c6"
      ]
    ]
  },
  {
    "id": "559d3f61.79c98",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1079.669755935669,
    "y": 2110.657003879547,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "f983099f.d54368"
      ]
    ]
  },
  {
    "id": "60114e3f.8f3c6",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource\" />\n",
    "comments": "",
    "x": 1245.669755935669,
    "y": 2141.0499228462577,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "f983099f.d54368",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1221.3257236480713,
    "y": 2106.8491730690002,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "ade80637.81d448",
    "type": "set",
    "name": "set ar-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-status.action' value=\"`$connection-attachment-topology-operation-input.request-information.request-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-name' value=\"connection-attachment-topology-operation\" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-action' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.request-information.' value=\"`$connection-attachment-topology-operation-input.request-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.service-information.' value=\"`$connection-attachment-topology-operation-input.service-information.` \" />\n",
    "comments": "",
    "x": 716.4919109344482,
    "y": 1970.84938454628,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "4bdb1ae.9bc94e4",
    "type": "execute",
    "name": "execute getTime",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='setTime' >\n    <parameter name=\"outputPath\" value=\"tmp.current-time\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 733.777753829956,
    "y": 2043.468982219696,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "85c9e5e0.4b2808",
    "type": "set",
    "name": "set allotted-resource-oper-status",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status' value='PendingDelete' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$connection-attachment-topology-operation-input.request-information.request-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-request-id`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.create-timestamp' value='`$tmp.current-time`' />\n",
    "comments": "",
    "x": 788.7648105621338,
    "y": 2081.4201197624207,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "9fb629bb.9a3648",
    "type": "set",
    "name": "set model-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.connection-attachment-topology.onap-model-information.' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.` \" />",
    "comments": "",
    "x": 730.3334522247314,
    "y": 2010.0240349769592,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "71e134cd.34ff8c",
    "type": "comment",
    "name": "Prepare data for allotted-resource addition to MDSAL",
    "info": "This will add to allotted-resource which is present inside service.",
    "comments": "",
    "x": 839.6668834686279,
    "y": 1926.0239098072052,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "616f171a.47daa8",
    "type": "comment",
    "name": "Add to allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 781.2467098236084,
    "y": 1893.4372115135193,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "5450bfab.9413e",
    "type": "update",
    "name": "update AAI allotted-resource",
    "xml": "<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"allotted-resource\" \n\t\tkey=\"customer.global-customer-id = $connection-attachment-topology-operation-input.service-information.global-customer-id AND\n\t\t\tservice-subscription.service-type = $connection-attachment-topology-operation-input.service-information.subscription-service-type AND\n\t\t\tservice-instance.service-instance-id = $connection-attachment-topology-operation-input.service-information.service-instance-id AND\n\t\t\tallotted-resource.id = $tmp.ar.allotted-resource-id\"\n        pfx='pfx' local-only='false' force='false'>\n\t<parameter name=\"selflink\" value=\"`$tmp.ar.self-link`\" />\n\t<parameter name=\"model-invariant-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-invariant-uuid`\" />\n\t<parameter name=\"model-version-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-uuid`\" />\n\t<parameter name=\"operational-status\" value=\"PendingDelete\" />\n",
    "comments": "",
    "outputs": 1,
    "x": 778.2227725982666,
    "y": 2328.75434923172,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "6055aad6.cfe2c4",
        "235942f0.e7b26e"
      ]
    ]
  },
  {
    "id": "94474a0.f7cc5b8",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource connection-attachment-allotted-resource",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 827.3339519500732,
    "y": 550.4999489784241,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "255752ab.e0974e",
        "1a7aa44a.cd34ac"
      ]
    ]
  },
  {
    "id": "500ce0c3.5b4ed",
    "type": "execute",
    "name": "get parent-service-data tmp.ar-url-psd",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"/restconf/config/GENERIC-RESOURCE-API:services/service/{service-instance-id}/service-data\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url-psd\"/>\n    <parameter name=\"target\" value=\"{service-instance-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.parent-service-instance-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 681.0001964569092,
    "y": 759.0002102851868,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "8054d01.53e0b3",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource parent service data",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url-psd`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-psd\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 748.0001583099365,
    "y": 794.0002942085266,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "14706c37.53ff04",
        "415e2268.5d0d3c"
      ]
    ]
  },
  {
    "id": "c6e4843.cf19e78",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2568.8126583099365,
    "y": 811.3294506072998,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "5596c62d.3bd3a8"
      ]
    ]
  },
  {
    "id": "e43e013.c1cc8",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2602.664144515991,
    "y": 757.3954172134399,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "6247e999.5c9548"
      ]
    ]
  },
  {
    "id": "d9e74637.02a718",
    "type": "for",
    "name": "for arvidx.. mdsal-sd.service-data.vnfs.vnf_length[]",
    "xml": "<for index='arvidx' start='0' end='`$mdsal-sd.service-data.vnfs.vnf_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 2087.813558578491,
    "y": 1638.9966711997986,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "9c851968.c2df88"
      ]
    ]
  },
  {
    "id": "9c851968.c2df88",
    "type": "block",
    "name": "block atmoic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2363.480131149292,
    "y": 1639.9967041015625,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "54b544e3.42d4bc"
      ]
    ]
  },
  {
    "id": "54b544e3.42d4bc",
    "type": "switchNode",
    "name": "switch ActivateSiteInstance",
    "xml": "<switch test=\"`$mdsal-sd.service-data.vnfs.vnf[$arvidx].vnf-data.request-information.request-action == ActivateSiteInstance`\">\n    \n    \n\n",
    "comments": "",
    "outputs": 1,
    "x": 2600.343832015991,
    "y": 1644.194667816162,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "aa6e75db.b48038"
      ]
    ]
  },
  {
    "id": "aa6e75db.b48038",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2809.3433475494385,
    "y": 1644.19482088089,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "3132632f.4cad6c"
      ]
    ]
  },
  {
    "id": "2aa66f72.5e93f",
    "type": "set",
    "name": "set tmp.sitevidx ",
    "xml": "<set>\n<parameter name='tmp.sitevidx' value='`$arvidx`' />\n\n",
    "comments": "",
    "x": 2206.3442974090576,
    "y": 1748.1952495574951,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "4f450f5a.52d67",
    "type": "set",
    "name": "set prop.ar-parent-service-instance-id",
    "xml": "<set>\n<parameter name='prop.ar-parent-service-instance-id' value='`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.allotted-resource-information.parent-service-instance-id`' />\n",
    "comments": "",
    "x": 2122.8124599456787,
    "y": 1061.996099948883,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "2d8849eb.21e096",
    "type": "for",
    "name": "for loop aridx - Get role from allotted resource",
    "xml": "<for index=\"aridx\" start=\"0\" end=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.connection-attachment-request-input.param_length`\">\n    \n    \n",
    "comments": "",
    "outputs": 1,
    "x": 2148.8122539520264,
    "y": 1010.4959712028503,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "d84d5dca.fda43"
      ]
    ]
  },
  {
    "id": "d84d5dca.fda43",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2403.812582015991,
    "y": 1007.4964308738708,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "f1205a89.ab0798",
        "52dd7727.f5fe18"
      ]
    ]
  },
  {
    "id": "f1205a89.ab0798",
    "type": "switchNode",
    "name": "switch Role",
    "xml": "<switch test=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.connection-attachment-request-input.param[$aridx].name == 'Role'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 2533.8124027252197,
    "y": 979.496367931366,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "c09b2335.3fa2e"
      ]
    ]
  },
  {
    "id": "c09b2335.3fa2e",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2674.812734603882,
    "y": 978.4963669776917,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "a9576f56.b9348"
      ]
    ]
  },
  {
    "id": "a9576f56.b9348",
    "type": "set",
    "name": "set prop.role",
    "xml": "<set>\n<parameter name='prop.role' value='`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.connection-attachment-request-input.param[$aridx].value`' />\n",
    "comments": "",
    "x": 2840.813398361206,
    "y": 973.0962700843811,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "fa09f12.7306b1",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2420.813081741333,
    "y": 1156.9963774681091,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "949549ca.fec9a8"
      ]
    ]
  },
  {
    "id": "a6b8177b.a72a88",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2414.6648235321045,
    "y": 1113.0624146461487,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "ffd5545.891d1a8"
      ]
    ]
  },
  {
    "id": "6247e999.5c9548",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2728.8122692108154,
    "y": 754.4958505630493,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "5596c62d.3bd3a8",
    "type": "block",
    "name": "block atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1858.3121318817139,
    "y": 1028.4959712028503,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "2d8849eb.21e096",
        "4f450f5a.52d67",
        "fc8ba65.b9ce358",
        "4d147f57.4dac2"
      ]
    ]
  },
  {
    "id": "ffd5545.891d1a8",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2544.312942504883,
    "y": 1106.496334552765,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "949549ca.fec9a8",
    "type": "block",
    "name": "block atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1934.312421798706,
    "y": 1233.4959845542908,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "3f440bd9.75daa4"
      ]
    ]
  },
  {
    "id": "9c405c37.6c68b",
    "type": "for",
    "name": "for loop siteidx - Get site ID from servicedata",
    "xml": "<for index=\"siteidx\" start=\"0\" end=\"`$mdsal-sd.service-data.vnfs.vnf[$tmp.sitevidx].vnf-data.vnf-request-input.vnf-input-parameters.param_length`\">\n    \n    \n",
    "comments": "",
    "outputs": 1,
    "x": 2298.3151454925537,
    "y": 1789.4970073699951,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "b4cc5d95.f9e96"
      ]
    ]
  },
  {
    "id": "58af8ae9.984c54",
    "type": "switchNode",
    "name": "switch siteId",
    "xml": "<switch test=\"`$mdsal-sd.service-data.vnfs.vnf[$tmp.sitevidx].vnf-data.vnf-request-input.vnf-input-parameters.param[$siteidx].name == 'siteId'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 2370.317129135132,
    "y": 1857.497986793518,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "545beb56.93d714"
      ]
    ]
  },
  {
    "id": "a5f8b7de.41e8d8",
    "type": "block",
    "name": "block atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2224.815404891968,
    "y": 1930.9970245361328,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "40a92cd6.b03f74",
        "92d18c15.f7ea6",
        "6fed1bc4.775804"
      ]
    ]
  },
  {
    "id": "e6e54d59.f029",
    "type": "execute",
    "name": "execute RestApiCallNode delete vpn topology",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/sdwan-vpn-topology.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/sdwan/overlay-network/' + $prop.vpn1Id + '/topology'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"put\"/>\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 814.8129138946533,
    "y": 1718.4967412948608,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "41dfdc02.d499c4",
        "13592df6.00f3c2"
      ]
    ]
  },
  {
    "id": "41dfdc02.d499c4",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1069.8126811981201,
    "y": 1734.4967412948608,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "899d6eb4.6e43e"
      ]
    ]
  },
  {
    "id": "899d6eb4.6e43e",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 1239.8126201629639,
    "y": 1737.4967412948608,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "9460e156.0dbc9",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create vpn rest api\" />\n",
    "comments": "",
    "x": 1239.8127422332764,
    "y": 1693.4967412948608,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "13592df6.00f3c2",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1072.8126201629639,
    "y": 1693.4967412948608,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "9460e156.0dbc9"
      ]
    ]
  },
  {
    "id": "23c44741.0683a8",
    "type": "set",
    "name": "set controller data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.url' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.user' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.password' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n",
    "comments": "",
    "x": 1240.3796348571777,
    "y": 1256.1728954315186,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "b8f3c1af.8a68d",
    "type": "get-resource",
    "name": "get-resource esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = SDWANController AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.esr-thirdparty-sdnc' local-only='false' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 809.8793773651123,
    "y": 1307.1732459068298,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "6754723.b98c58c",
        "6d29272.a552fd8",
        "9b336b2d.6145a8"
      ]
    ]
  },
  {
    "id": "6754723.b98c58c",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1068.8796691894531,
    "y": 1262.1728792190552,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "23c44741.0683a8"
      ]
    ]
  },
  {
    "id": "6d29272.a552fd8",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1065.3703861236572,
    "y": 1300.7469758987427,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "34fe0d3d.2375f2"
      ]
    ]
  },
  {
    "id": "9b336b2d.6145a8",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1060.7033939361572,
    "y": 1342.080288887024,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "6298bcb0.bae674"
      ]
    ]
  },
  {
    "id": "34fe0d3d.2375f2",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 1215.941701889038,
    "y": 1295.0327281951904,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "6298bcb0.bae674",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 1222.4758548736572,
    "y": 1343.519497871399,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "3f440bd9.75daa4",
    "type": "for",
    "name": "for pnidx.. mdsal-parentsd.service-data.networks.network_length[]",
    "xml": "<for index='pnidx' start='0' end='`$mdsal-parentsd.service-data.networks.network_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 2259.3119945526123,
    "y": 1232.9957122802734,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "ad8228ad.984598"
      ]
    ]
  },
  {
    "id": "adf75159.a4939",
    "type": "switchNode",
    "name": "switch ActivateSDWANConnectivityInstance",
    "xml": "<switch test=\"`$mdsal-parentsd.service-data.networks.network[$pnidx].network-data.request-information.request-action == 'ActivateSDWANConnectivityInstance'`\">\n    \n    \n\n",
    "comments": "",
    "outputs": 1,
    "x": 2182.979818344116,
    "y": 1325.9959139823914,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "152fe76d.8c87b9"
      ]
    ]
  },
  {
    "id": "152fe76d.8c87b9",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2439.97931098938,
    "y": 1324.9960441589355,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "bff21d24.0b57f"
      ]
    ]
  },
  {
    "id": "94eca419.a27f98",
    "type": "for",
    "name": "for loop paramidx - Get topology from servicedata",
    "xml": "<for index=\"paramidx\" start=\"0\" end=\"`$mdsal-parentsd.service-data.networks.network[$pnidx].network-data.network-request-input.network-input-parameters.param_length`\">\n    \n    \n",
    "comments": "",
    "outputs": 1,
    "x": 2241.9799976348877,
    "y": 1414.9956321716309,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "de02d4be.b70b88"
      ]
    ]
  },
  {
    "id": "de02d4be.b70b88",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2507.9796867370605,
    "y": 1411.9959554672241,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "a00734cd.6de4c8",
        "641cbedf.bffd9"
      ]
    ]
  },
  {
    "id": "a00734cd.6de4c8",
    "type": "switchNode",
    "name": "switch topology",
    "xml": "<switch test=\"`$mdsal-parentsd.service-data.networks.network[$pnidx].network-data.network-request-input.network-input-parameters.param[$paramidx].name == 'topology'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 2678.9800205230713,
    "y": 1380.9954652786255,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "26c02eae.b386b2"
      ]
    ]
  },
  {
    "id": "26c02eae.b386b2",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2830.980010986328,
    "y": 1382.9954957962036,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "fa1994f9.3ab1f8"
      ]
    ]
  },
  {
    "id": "fa1994f9.3ab1f8",
    "type": "set",
    "name": "set topology",
    "xml": "<set>\n<parameter name='prop.topology' value='`$mdsal-parentsd.service-data.networks.network[$pnidx].network-data.network-request-input.network-input-parameters.param[$paramidx].value`' />\n",
    "comments": "",
    "x": 2974.98002243042,
    "y": 1382.5954303741455,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "641cbedf.bffd9",
    "type": "switchNode",
    "name": "switch vpnId",
    "xml": "<switch test=\"`$mdsal-parentsd.service-data.networks.network[$pnidx].network-data.network-request-input.network-input-parameters.param[$paramidx].name == 'vpn-id'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 2670.6457443237305,
    "y": 1423.328447341919,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "8be0360b.142cf8"
      ]
    ]
  },
  {
    "id": "8be0360b.142cf8",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2822.6457347869873,
    "y": 1425.328477859497,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "d6238463.67fb38"
      ]
    ]
  },
  {
    "id": "d6238463.67fb38",
    "type": "set",
    "name": "set prop.vpn1Id",
    "xml": "<set>\n<parameter name='prop.vpn1Id' value='`$mdsal-parentsd.service-data.networks.network[$pnidx].network-data.network-request-input.network-input-parameters.param[$paramidx].value`' />\n",
    "comments": "",
    "x": 2966.645746231079,
    "y": 1424.928412437439,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "d94628e2.163098",
    "type": "execute",
    "name": "execute RestApiCallNode delete vpn ",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/sdwan-vpn.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/sdwan/overlay-network/vpn'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"put\"/>\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 787.8125858306885,
    "y": 1829.9967064857483,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "ad8a5a19.5d2dc8",
        "a192274c.875558"
      ]
    ]
  },
  {
    "id": "ad8a5a19.5d2dc8",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1020.8126640319824,
    "y": 1854.996705532074,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "f3ab5240.5c692"
      ]
    ]
  },
  {
    "id": "f3ab5240.5c692",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 1190.8126029968262,
    "y": 1857.996705532074,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "bd5bcef5.5eb46",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create vpn rest api\" />\n",
    "comments": "",
    "x": 1190.8127250671387,
    "y": 1813.996705532074,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "a192274c.875558",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1023.8126029968262,
    "y": 1813.996705532074,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "bd5bcef5.5eb46"
      ]
    ]
  },
  {
    "id": "82cffc44.23091",
    "type": "set",
    "name": "set prop.name",
    "xml": "<set>\n<parameter name='prop.name' value='`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.connection-attachment-request-input.param[$aridx].value`' />\n",
    "comments": "",
    "x": 2888.8124027252197,
    "y": 1025.9959406852722,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "52dd7727.f5fe18",
    "type": "switchNode",
    "name": "switch sdwanVpnName",
    "xml": "<switch test=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.connection-attachment-request-input.param[$aridx].name == 'sdwanVpnName'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 2569.3122425079346,
    "y": 1028.9959330558777,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "68d65f0e.41b06"
      ]
    ]
  },
  {
    "id": "68d65f0e.41b06",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2740.3124027252197,
    "y": 1027.9960017204285,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "82cffc44.23091"
      ]
    ]
  },
  {
    "id": "56e2d584.03ab4c",
    "type": "set",
    "name": "set prop.ar.provided-allotted-resource-id",
    "xml": "<set>\n<parameter name='prop.ar.provided-allotted-resource-id' value='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[$pidx].allotted-resource-id`' />\n\n\n",
    "comments": "",
    "x": 2054.8120098114014,
    "y": 769.9960651397705,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "bb8d7398.e602a",
    "type": "block",
    "name": "block atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1367.8424663543701,
    "y": 1171.1932725906372,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "f1cd9602.486d48"
      ]
    ]
  },
  {
    "id": "667f1405.f078ac",
    "type": "execute",
    "name": "generate tmp.ar-url-connection url",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.connection-attachment-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url-connection\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$prop.ar.provided-allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 2039.3296718597412,
    "y": 803.3295412063599,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "a0d61f91.413f4",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource connection-attachment-allotted-resource",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url-connection`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-providedAr\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2179.3293018341064,
    "y": 838.9958324432373,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "e43e013.c1cc8",
        "c6e4843.cf19e78"
      ]
    ]
  },
  {
    "id": "fc8ba65.b9ce358",
    "type": "execute",
    "name": "execute RestApiCallNode - get parent service data",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url-connection`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-parentsd\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2154.9965419769287,
    "y": 1131.9958891868591,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "fa09f12.7306b1",
        "a6b8177b.a72a88"
      ]
    ]
  },
  {
    "id": "bff21d24.0b57f",
    "type": "block",
    "name": "block atmoic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1899.3299617767334,
    "y": 1421.663094997406,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "94eca419.a27f98",
        "ad1d91e2.9fb76",
        "b140ba23.8a1858",
        "c40e517f.50767"
      ]
    ]
  },
  {
    "id": "40a92cd6.b03f74",
    "type": "set",
    "name": "set prop.attach.siteId",
    "xml": "<set>\n<parameter name='prop.attach.siteId' value='`$mdsal-sd.service-data.vnfs.vnf[$tmp.sitevidx].vnf-data.vnf-request-input.vnf-input-parameters.param[$siteidx].value`' />\n\n",
    "comments": "",
    "x": 2490.9982776641846,
    "y": 1912.6638507843018,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "545beb56.93d714",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2510.9985332489014,
    "y": 1857.6636772155762,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "a5f8b7de.41e8d8"
      ]
    ]
  },
  {
    "id": "3132632f.4cad6c",
    "type": "block",
    "name": "block atmoic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2003.6644191741943,
    "y": 1743.3301877975464,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "9c405c37.6c68b",
        "2aa66f72.5e93f"
      ]
    ]
  },
  {
    "id": "9c9d490e.b9a1b8",
    "type": "for",
    "name": "for pidx..mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[]",
    "xml": "<for index='pidx' start='0' end='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 975.1812229156494,
    "y": 1206.6358728408813,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "bb8d7398.e602a"
      ]
    ]
  },
  {
    "id": "b4cc5d95.f9e96",
    "type": "block",
    "name": "block atmoic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2215.6647777557373,
    "y": 1854.0008354187012,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "58af8ae9.984c54"
      ]
    ]
  },
  {
    "id": "75448c50.567d34",
    "type": "set",
    "name": "set prop.siteAttachement_length=0",
    "xml": "<set>\n<parameter name='prop.siteAttachements_length' value='0' />\n<parameter name='prop.siteIds_length' value='0' />\n\n\n\n",
    "comments": "",
    "x": 820.9999980926514,
    "y": 1149.5312285423279,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "92d18c15.f7ea6",
    "type": "set",
    "name": "Add sites to list and update length",
    "xml": "<set>\n<parameter name='prop.siteIds[$prop.siteIds_length]' value='`$prop.attach.siteId`' />\n<parameter name='prop.siteIds_length' value='`$prop.siteIds_length + 1`' />\n\n\n\n\n\n\n\n\n\n\n",
    "comments": "",
    "x": 2518.5021114349365,
    "y": 1957.5316557884216,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "4d147f57.4dac2",
    "type": "execute",
    "name": "generate prop.ar-parent-service-instance-id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"/restconf/config/GENERIC-RESOURCE-API:services/service/{service-instance-id}/service-data\"/>      \n    <parameter name=\"outputPath\" value=\"tmp.ar-url-connection\"/>\n    <parameter name=\"target\" value=\"{service-instance-id}\"/>\n    <parameter name=\"replacement\" value=\"`$prop.ar-parent-service-instance-id`\"/>\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2139.5001430511475,
    "y": 1094.531409740448,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "ad1d91e2.9fb76",
    "type": "set",
    "name": "set prop.ar-service-instance-id",
    "xml": "<set>\n<parameter name='prop.ar-service-instance-id' value='`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.connection-attachment-topology.allotted-resource-identifiers.consuming-service-instance-id`' />\n",
    "comments": "",
    "x": 2172.5005626678467,
    "y": 1483.5313277244568,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "b140ba23.8a1858",
    "type": "execute",
    "name": "generate prop.ar-service-instance-id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"/restconf/config/GENERIC-RESOURCE-API:services/service/{service-instance-id}/service-data\"/>      \n    <parameter name=\"outputPath\" value=\"tmp.ar-url-connection\"/>\n    <parameter name=\"target\" value=\"{service-instance-id}\"/>\n    <parameter name=\"replacement\" value=\"`$prop.ar-service-instance-id`\"/>\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2197.8330211639404,
    "y": 1516.4096236228943,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "c40e517f.50767",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource service data",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url-connection`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-sd\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2248.833143234253,
    "y": 1553.4094424247742,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "6f8bfcf3.2cbda4",
        "671b3b67.714c24"
      ]
    ]
  },
  {
    "id": "671b3b67.714c24",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2527.500207901001,
    "y": 1549.5311541557312,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "1fc5d55c.4c864b"
      ]
    ]
  },
  {
    "id": "6f8bfcf3.2cbda4",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2525.3525371551514,
    "y": 1510.5972819328308,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "2fe21dd5.a9ca62"
      ]
    ]
  },
  {
    "id": "2fe21dd5.a9ca62",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2655.0007305145264,
    "y": 1504.0312418937683,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "1fc5d55c.4c864b",
    "type": "block",
    "name": "block atmoic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2676.5011043548584,
    "y": 1550.5313391685486,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "d9e74637.02a718"
      ]
    ]
  },
  {
    "id": "f1cd9602.486d48",
    "type": "switchNode",
    "name": "switch allotted resource ID match",
    "xml": "<switch test=\"`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[$pidx].allotted-resource-id == $tmp.ar.allotted-resource-id`\">",
    "comments": "",
    "outputs": 1,
    "x": 1591.5001125335693,
    "y": 1168.031301021576,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "a2faeb8f.9adb58"
      ]
    ]
  },
  {
    "id": "a2faeb8f.9adb58",
    "type": "outcomeFalse",
    "name": "false",
    "xml": "<outcome value='false'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1670.5001773834229,
    "y": 805.0312938690186,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "7036cf78.a5aa3"
      ]
    ]
  },
  {
    "id": "7036cf78.a5aa3",
    "type": "block",
    "name": "block atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1812.5004253387451,
    "y": 804.0312347412109,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "56e2d584.03ab4c",
        "667f1405.f078ac",
        "a0d61f91.413f4"
      ]
    ]
  },
  {
    "id": "15b04770.9781e9",
    "type": "comment",
    "name": "if allotted resource Id match with the incomming allotted resource ID,  sites in this service vnf should not be included",
    "info": "parent instId 200 |  parent instId 200\nservice instId 100| service InstId 200\n site1            |       site2\n allotted resId 1 | allotted resId 2 \n --------------------------------------\n Deactivate:\n loop for provided allotted res ID\n If allotted resId 1 matches with incomming allotted resource Id then we should delete the sites available in the service data 100\n for this we have to send request for deleting with site IDs site2 without including site1.\n \n \n ",
    "comments": "",
    "x": 1765.5000286102295,
    "y": 737.0312957763672,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "7505e39f.a765fc",
    "type": "comment",
    "name": "loop for provided allotted rsource Id",
    "info": "",
    "comments": "",
    "x": 1087.4999980926514,
    "y": 1170.5312895774841,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "2f9e3c20.0207a4",
    "type": "comment",
    "name": "get allotted resource for the allotted resource ID",
    "info": "",
    "comments": "",
    "x": 2326.500326156616,
    "y": 738.5311737060547,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "7fd25f7d.205ea",
    "type": "comment",
    "name": "get parent service data to get connectivity which has connectivity and vpn ID",
    "info": "",
    "comments": "",
    "x": 2109.4998531341553,
    "y": 965.5312514305115,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "53cc3005.40ef",
    "type": "comment",
    "name": "get service data from service instance id from allotted reosurce Id to get sites vnf",
    "info": "",
    "comments": "",
    "x": 2298.4998531341553,
    "y": 1447.531051158905,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "965fc969.fd32d8",
    "type": "call",
    "name": "call sdwan-vnf-topology-operation-underlay for delete",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sdwan-wanport-vnf-topology-operation-underlay' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 848.5001163482666,
    "y": 1634.531358242035,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "6fed1bc4.775804",
    "type": "set",
    "name": "Add site attachement to list and update length",
    "xml": "<set>\n<parameter name='prop.siteAttachements[$prop.siteAttachements_length].siteId' value='`$prop.attach.siteId`' />\n<parameter name='prop.siteAttachements[$prop.siteAttachements_length].roles[0]' value='`$prop.role`' />\n<parameter name='prop.siteAttachements[$prop.siteAttachements_length].roles_length' value='1' />\n<parameter name='prop.siteAttachements_length' value='`$prop.siteAttachements_length + 1`' />\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "comments": "",
    "x": 2548.2500896453857,
    "y": 1998.2539830207825,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "d6353ac9.cd8368",
    "type": "execute",
    "name": "execute RestApiCallNode Get token",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/actokentemplate.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/v2/tokens'`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"post\"/>\n<parameter name=\"responsePrefix\" value=\"token-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>",
    "comments": "",
    "outputs": 1,
    "x": 822.000036239624,
    "y": 1397.000150680542,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "58744a52.9052b4",
        "2cb21a31.a626b6"
      ]
    ]
  },
  {
    "id": "58744a52.9052b4",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1074.0001621246338,
    "y": 1377.9999685287476,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "1cd6b02.062c05"
      ]
    ]
  },
  {
    "id": "1cd6b02.062c05",
    "type": "set",
    "name": "set token-id",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.token_id' value='`$token-result.data.token_id`' />\n",
    "comments": "",
    "x": 1223.0001621246338,
    "y": 1376.9999380111694,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "8b511642.cc8a88",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing get token rest api\" />\n",
    "comments": "",
    "x": 1214.0001888275146,
    "y": 1411.3932132720947,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "2cb21a31.a626b6",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1066.2501964569092,
    "y": 1413.6430912017822,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "8b511642.cc8a88"
      ]
    ]
  },
  {
    "id": "de426682.23e5b8",
    "type": "get-resource",
    "name": "get-resource service-subscription",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"service-subscription\" \n        key= 'service-subscription.service-type = $connection-attachment-topology-operation-input.service-information.subscription-service-type \n        AND customer.global-customer-id = $connection-attachment-topology-operation-input.service-information.global-customer-id'\n      force=\"true\" pfx=\"tmp.AnAI-data-tenant\">      ",
    "comments": "",
    "outputs": 1,
    "x": 812.8955059051514,
    "y": 1509.5620489120483,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "4a6eca43.810a44",
        "6a29a6d.e51e358"
      ]
    ]
  },
  {
    "id": "9c358a1f.148518",
    "type": "execute",
    "name": "execute RestApiCallNode Create tenant auth",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/baseservice/tenants/authorization/' + $prop.tenant-id`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"put\"/>\n<parameter name=\"responsePrefix\" value=\"tenant-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 850.3955669403076,
    "y": 1576.4548950195312,
    "z": "7c522092.2b01d",
    "wires": [
      []
    ]
  },
  {
    "id": "6a29a6d.e51e358",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1017.0739574432373,
    "y": 1534.52241897583,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "bcbf10f7.b7993"
      ]
    ]
  },
  {
    "id": "4a6eca43.810a44",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1023.3953685760498,
    "y": 1482.3081073760986,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "67730720.8e4a18"
      ]
    ]
  },
  {
    "id": "bcbf10f7.b7993",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing get token rest api\" />\n",
    "comments": "",
    "x": 1169.8239574432373,
    "y": 1534.2724800109863,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "67730720.8e4a18",
    "type": "switchNode",
    "name": "switch temp-ub-sub-account-id",
    "xml": "<switch test='`$tmp.AnAI-data-tenant.temp-ub-sub-account-id`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1224.8955974578857,
    "y": 1474.3121299743652,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "ffa06abb.9a2a48",
        "cc923e40.7eb57"
      ]
    ]
  },
  {
    "id": "cc923e40.7eb57",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>",
    "comments": "",
    "outputs": 1,
    "x": 1458.0039043426514,
    "y": 1433.0039434432983,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "7c9ff36f.d8d7bc"
      ]
    ]
  },
  {
    "id": "ffa06abb.9a2a48",
    "type": "other",
    "name": "Other",
    "xml": "<outcome value='Other'>",
    "comments": "",
    "outputs": 1,
    "x": 1411.2894840240479,
    "y": 1527.0040216445923,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "d1efa0cc.71a21"
      ]
    ]
  },
  {
    "id": "d1efa0cc.71a21",
    "type": "set",
    "name": "set prop.tenant-id",
    "xml": "<set>\n<parameter name='prop.tenant-id' value='`$tmp.AnAI-data-tenant.temp-ub-sub-account-id`' />\n",
    "comments": "",
    "x": 1580.1466655731201,
    "y": 1525.1110353469849,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "7c9ff36f.d8d7bc",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing get token rest api\" />\n",
    "comments": "",
    "x": 1570.4322299957275,
    "y": 1477.8253078460693,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "7e6a4a74.fb8064",
    "type": "for",
    "name": "for ntidx.. mdsal-psd.service-data.networks.network_length[]",
    "xml": "<for index='ntidx' start='0' end='`$mdsal-psd.service-data.networks.network_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 776.0312480926514,
    "y": 903.0312495231628,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "b21fb0ff.7db48"
      ]
    ]
  },
  {
    "id": "ad8228ad.984598",
    "type": "block",
    "name": "block atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1907.031270980835,
    "y": 1324.0312895774841,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "adf75159.a4939"
      ]
    ]
  },
  {
    "id": "b21fb0ff.7db48",
    "type": "block",
    "name": "block atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 740.0312480926514,
    "y": 975.0312495231628,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "e497173b.c24408"
      ]
    ]
  },
  {
    "id": "e497173b.c24408",
    "type": "switchNode",
    "name": "switch ActivateSDWANConnectivityInstance",
    "xml": "<switch test=\"`$mdsal-psd.service-data.networks.network[$ntidx].network-data.request-information.request-action == 'ActivateSDWANConnectivityInstance'`\">\n    \n    \n\n",
    "comments": "",
    "outputs": 1,
    "x": 1015.9797954559326,
    "y": 976.9958739280701,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "d6c139b3.090dd8"
      ]
    ]
  },
  {
    "id": "d6c139b3.090dd8",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1272.9792881011963,
    "y": 975.9960041046143,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "b4139f80.a76b4"
      ]
    ]
  },
  {
    "id": "b4139f80.a76b4",
    "type": "block",
    "name": "block atmoic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 732.3299388885498,
    "y": 1072.6630549430847,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "ba5ecb28.66e198"
      ]
    ]
  },
  {
    "id": "ba5ecb28.66e198",
    "type": "for",
    "name": "for loop paramidx - Get topology from servicedata",
    "xml": "<for index=\"paramidx\" start=\"0\" end=\"`$mdsal-psd.service-data.networks.network[$ntidx].network-data.network-request-input.network-input-parameters.param_length`\">\n    \n    \n",
    "comments": "",
    "outputs": 1,
    "x": 1011.9800395965576,
    "y": 1061.995677471161,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "bcfcaf76.f471a"
      ]
    ]
  },
  {
    "id": "bcfcaf76.f471a",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1209.9796695709229,
    "y": 1114.996165752411,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "808f1a6b.ade978",
        "8fc5fee9.2e70f",
        "7c2cd6d7.da9468"
      ]
    ]
  },
  {
    "id": "8fc5fee9.2e70f",
    "type": "switchNode",
    "name": "switch vpnId",
    "xml": "<switch test=\"`$mdsal-psd.service-data.networks.network[$ntidx].network-data.network-request-input.network-input-parameters.param[$paramidx].name == 'vpn-id'`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1359.6458168029785,
    "y": 1129.3284697532654,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "5eeff931.68f088"
      ]
    ]
  },
  {
    "id": "808f1a6b.ade978",
    "type": "switchNode",
    "name": "switch topology",
    "xml": "<switch test=\"`$mdsal-psd.service-data.networks.network[$ntidx].network-data.network-request-input.network-input-parameters.param[$paramidx].name == 'topology'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1367.9800930023193,
    "y": 1086.995487689972,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "385cddcb.23c372"
      ]
    ]
  },
  {
    "id": "5eeff931.68f088",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1511.6458072662354,
    "y": 1131.3285002708435,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "827b7756.0101b8"
      ]
    ]
  },
  {
    "id": "385cddcb.23c372",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1519.9800834655762,
    "y": 1088.99551820755,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "9cc5fb84.591a88"
      ]
    ]
  },
  {
    "id": "9cc5fb84.591a88",
    "type": "set",
    "name": "set topology",
    "xml": "<set>\n<parameter name='prop.topology' value='`$mdsal-psd.service-data.networks.network[$ntidx].network-data.network-request-input.network-input-parameters.param[$paramidx].value`' />\n",
    "comments": "",
    "x": 1604.9800968170166,
    "y": 1026.5954375267029,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "827b7756.0101b8",
    "type": "set",
    "name": "set prop.vpn1Id",
    "xml": "<set>\n<parameter name='prop.vpn1Id' value='`$mdsal-psd.service-data.networks.network[$ntidx].network-data.network-request-input.network-input-parameters.param[$paramidx].value`' />\n",
    "comments": "",
    "x": 1659.6458721160889,
    "y": 1120.9284148216248,
    "z": "7c522092.2b01d",
    "wires": []
  },
  {
    "id": "7c2cd6d7.da9468",
    "type": "switchNode",
    "name": "switch vpn name",
    "xml": "<switch test=\"`$mdsal-psd.service-data.networks.network[$ntidx].network-data.network-request-input.network-input-parameters.param[$paramidx].name == 'name'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1331.031270980835,
    "y": 1045.031277179718,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "829e0f12.c7157"
      ]
    ]
  },
  {
    "id": "829e0f12.c7157",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1441.0312747955322,
    "y": 989.0312466621399,
    "z": "7c522092.2b01d",
    "wires": [
      [
        "16fe2ddd.1cfe92"
      ]
    ]
  },
  {
    "id": "16fe2ddd.1cfe92",
    "type": "set",
    "name": "set vpn name",
    "xml": "<set>\n<parameter name='prop.name' value='`$mdsal-psd.service-data.networks.network[$ntidx].network-data.network-request-input.network-input-parameters.param[$paramidx].value`' />\n",
    "comments": "",
    "x": 1562.0312747955322,
    "y": 954.6312832832336,
    "z": "7c522092.2b01d",
    "wires": []
  }
]
