[{"id":"7d592922.381a98","type":"dgstart","name":"DGSTART","outputs":1,"x":234.75,"y":114,"z":"904f855.2f5e8f8","wires":[["2231b9ae.40730e"]]},{"id":"2231b9ae.40730e","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":371.0356903076172,"y":181.09526014328003,"z":"904f855.2f5e8f8","wires":[["5597044c.d58a04"]]},{"id":"5597044c.d58a04","type":"method","name":"network-topology-operation-assign-from-preload","xml":"<method rpc='network-topology-operation-assign-from-preload' mode='sync'>\n","comments":"","outputs":1,"x":373.71439361572266,"y":248.89284801483154,"z":"904f855.2f5e8f8","wires":[["eeff1f58.674cb"]]},{"id":"275965de.197eca","type":"comment","name":"Called from assign when network name passed in from mso","info":"","comments":"","x":571.6071395874023,"y":142.00000476837158,"z":"904f855.2f5e8f8","wires":[]},{"id":"eeff1f58.674cb","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":353.74999237060547,"y":380.9999933242798,"z":"904f855.2f5e8f8","wires":[["9c2238aa.67ea08","8255a2a9.5c5808","f9dafdce.3c8a3","685cc7cd.396018","899c4fe3.7f9af8","a4c0d0b4.fb2228","e3f5293b.03dee","cc0b4bd9.424d18","d792a084.fab23","fbeedbdb.9915b","9af57339.b5c73","cae6b67f.073328","1fa70774.12d5c1","ad534b95.44473","6fca91a9.21355","27110277.784596","e618d649.0c64a8","1375dc08.d1881c","98f1afcd.7f17e","31fdd3c0.8004c4","ae3f6cc0.f931c","c33e48fe.f40f2","1edbf6d.7460609","d7a7e7e8.a8b248","6820b570.d2fcf4","2475aec8.3301ca","9d88f2e8.48f3e","75c470c.1b64c1","d03a4655.11876","250c1ed0.7ac68a"]]},{"id":"9c2238aa.67ea08","type":"get-resource","name":"get AnAI - l3-network by network-name","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network\" \n\t\tkey=\"l3-network.network-name = $tmp.network-instance-name\" \n\t\tlocal-only=\"false\" \n\t\tpfx=\"aai.l3-network\">\n","comments":"","outputs":1,"x":739.3293075561523,"y":694.7704095840454,"z":"904f855.2f5e8f8","wires":[["47b81159.539aa","88c61ad0.d333f"]]},{"id":"47b81159.539aa","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1006.3293495178223,"y":694.7703790664673,"z":"904f855.2f5e8f8","wires":[["849fecc5.099258"]]},{"id":"849fecc5.099258","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name=\"error-code\" value=\"500\" />\n\t<parameter name=\"error-message\" value=\"'Error searching for l3-network with network-name =' + $tmp.network-instance-name + 'from AnAI'\" />","comments":"","x":1158.4404335021973,"y":694.9926080703735,"z":"904f855.2f5e8f8","wires":[]},{"id":"88c61ad0.d333f","type":"other","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1008.6072845458984,"y":732.2858028411865,"z":"904f855.2f5e8f8","wires":[["a3a611b6.7e9f98"]]},{"id":"a3a611b6.7e9f98","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name=\"error-code\" value=\"500\" />\n\t<parameter name=\"error-message\" value=\"'Error l3-network with network-name =' + $tmp.network-instance-name + ' already exists in AnAI'\" />","comments":"","x":1159.6072425842285,"y":731.2857751846313,"z":"904f855.2f5e8f8","wires":[]},{"id":"8255a2a9.5c5808","type":"execute","name":"generate preload network url","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.preload-network`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.pn-url\"/>\n    <parameter name=\"target\" value=\"{network-name}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.network-instance-name`\"/>\n","comments":"","outputs":1,"x":700.6071548461914,"y":534.2857880592346,"z":"904f855.2f5e8f8","wires":[[]]},{"id":"f9dafdce.3c8a3","type":"execute","name":"execute RestApiCallNode - Get preload-network by network-name","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.pn-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"preload-data\" />\n\n","comments":"","outputs":1,"x":815.6072158813477,"y":569.5358800888062,"z":"904f855.2f5e8f8","wires":[["1a8fb816.080118","de38a578.c54d28"]]},{"id":"1a8fb816.080118","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1181.6072273254395,"y":574.2858438491821,"z":"904f855.2f5e8f8","wires":[["f2b3d346.87f28"]]},{"id":"f2b3d346.87f28","type":"block","name":"block: atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":1351.6071815490723,"y":573.7857294082642,"z":"904f855.2f5e8f8","wires":[[]]},{"id":"de38a578.c54d28","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1177.4589881896973,"y":606.3519020080566,"z":"904f855.2f5e8f8","wires":[["86b0c28f.440d28"]]},{"id":"86b0c28f.440d28","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name=\"error-code\" value=\"500\" />\n\t<parameter name=\"error-message\" value=\"'Error: No preload-network found with network-name =' + $tmp.network-instance-name + ' in md-sal'\" />","comments":"","x":1355.6071853637695,"y":606.2858171463013,"z":"904f855.2f5e8f8","wires":[]},{"id":"d97278fc.3053e","type":"comment","name":"preload found in md-sal, aai network doesn't exist.  Proceed to create.","info":"","comments":"","x":834.6071243286133,"y":629.2859487533569,"z":"904f855.2f5e8f8","wires":[]},{"id":"16662914.1e81f7","type":"save","name":"save AnAI - l3-network","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network\" \n\t\tkey=\"l3-network.network-id = $tmp.l3-network.network-id\" >\n<!-- Create l3-network object -->\n<parameter name=\"network-id\" value=\"`$tmp.l3-network.network-id`\" />\n<parameter name=\"network-name\" value=\"`$tmp.network-instance-name`\" />\n<parameter name='network-type' value=\"`$network-model.network-type`\" />\n<parameter name='network-role' value=\"`$network-model.network-role`\" />\n<parameter name='network-technology' value=\"`$network-model.network-technology`\" />\n<parameter name='is-bound-to-vpn' value=\"`$network-model.is-bound-to-vpn`\" />\n<parameter name=\"service-id\" value=\"`$network-topology-operation-input.service-information.service-id`\" />\n<parameter name=\"tenant-id\" value=\"`$network-topology-operation-input.network-request-input.tenant`\" />\n<parameter name=\"network-role-instance\" value=\"0\" />\n<parameter name=\"orchestration-status\" value=\"PendingCreate\" />\n<parameter name=\"physical-network-name\" value=\"`$preload-data.preload-network-topology-information.physical-network-name`\" />\n<parameter name=\"is-provider-network\" value=\"`$preload-data.preload-network-topology-information.is-provider-network`\" />\n<parameter name=\"is-shared-network\" value=\"`$preload-data.preload-network-topology-information.is-shared-network`\" />\n<parameter name=\"is-external-network\" value=\"`$preload-data.preload-network-topology-information.is-external-network`\" />\n<parameter name=\"selflink\" value=\"`$tmp.l3-network.self-link`\" />\n","comments":"","outputs":1,"x":1087.6789321899414,"y":862.4647035598755,"z":"904f855.2f5e8f8","wires":[["ae985daf.cc194","4833e133.eaab"]]},{"id":"ae985daf.cc194","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1291.4620971679688,"y":825.9800109863281,"z":"904f855.2f5e8f8","wires":[["f037d2da.e2da78"]]},{"id":"f037d2da.e2da78","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='500'/>\n\t<parameter name='error-message' value=\"`'Failed to save l3-network in AnAI with network-id = ' + $tmp.return.generate-l3network-network-id.uuid`\"/>","comments":"","x":1484.239646911621,"y":846.7577819824219,"z":"904f855.2f5e8f8","wires":[]},{"id":"685cc7cd.396018","type":"set","name":"set: tmp.error-message to \"\"","xml":"<set>\n\t<parameter name=\"tmp.error-message\" value=\"\"/>","comments":"","x":704.9851989746094,"y":658.7666625976562,"z":"904f855.2f5e8f8","wires":[]},{"id":"4833e133.eaab","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1301.5569381713867,"y":867.3384561538696,"z":"904f855.2f5e8f8","wires":[["f037d2da.e2da78"]]},{"id":"899c4fe3.7f9af8","type":"switchNode","name":"switch ... PRELOAD subnets_length","xml":"<switch test=\"`$preload-data.preload-network-topology-information.subnets_length`\">","comments":"","outputs":1,"x":733.3571853637695,"y":995.4285650253296,"z":"904f855.2f5e8f8","wires":[["b535960c.037"]]},{"id":"b535960c.037","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":994.8016357421875,"y":995.2063007354736,"z":"904f855.2f5e8f8","wires":[["20af37fa.7e239"]]},{"id":"20af37fa.7e239","type":"set","name":"set PRELOAD subnets[] = 0","xml":"<set>\n<parameter name=\"preload-data.preload-network-topology-information.subnets_length\" value=\"0\" />\n","comments":"","x":1228.3572447035049,"y":995.206321398417,"z":"904f855.2f5e8f8","wires":[]},{"id":"a4c0d0b4.fb2228","type":"for","name":"for loop i - PRELOAD subnets","xml":"<for index=\"i\" start=\"0\" end=\"`$preload-data.preload-network-topology-information.subnets_length`\">\n","comments":"","outputs":1,"x":714.1072463989258,"y":1087.4287095069885,"z":"904f855.2f5e8f8","wires":[["8602f731.72b7c8"]]},{"id":"8602f731.72b7c8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":971.1058654785156,"y":1087.4377207756042,"z":"904f855.2f5e8f8","wires":[["c7ed8c75.f11108","e7ad3a60.ccf05","75e2306b.a71d6","ca97996a.85c7f","3239fd87.45740a","fe762cff.ee4918","45e19eff.8708","18e3cafb.f22a2d","2d9b4f3.65a3a3"]]},{"id":"8bb52697.fd8018","type":"set","name":"set tmp.dhcpEnabled.boolean=false","xml":"<set>\n<parameter name=\"tmp.dhcpEnabled.boolean\" value=\"false\" />\n","comments":"","x":1745.1072463989258,"y":1127.4287095069885,"z":"904f855.2f5e8f8","wires":[]},{"id":"9dd6b81f.8e0e5","type":"set","name":"set tmp.dhcpEnabled.boolean=true","xml":"<set>\n<parameter name=\"tmp.dhcpEnabled.boolean\" value=\"true\" />\n","comments":"","x":1743.4247512817383,"y":1085.365159034729,"z":"904f855.2f5e8f8","wires":[]},{"id":"c7ed8c75.f11108","type":"switchNode","name":"switch: PRELOAD dhcp-enabled","xml":"<switch test=\"`$preload-data.preload-network-topology-information.subnets[$i].dhcp-enabled`\">","comments":"","outputs":1,"x":1235.4247512817383,"y":1084.8713846206665,"z":"904f855.2f5e8f8","wires":[["19d4b935.0a36c7","854d9609.d675e"]]},{"id":"19d4b935.0a36c7","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":1492.6470947265625,"y":1085.0937051773071,"z":"904f855.2f5e8f8","wires":[["9dd6b81f.8e0e5"]]},{"id":"854d9609.d675e","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":1492.5517654418945,"y":1126.9349265098572,"z":"904f855.2f5e8f8","wires":[["8bb52697.fd8018"]]},{"id":"e7ad3a60.ccf05","type":"switchNode","name":"switch: PRELOAD addr-from-start","xml":"<switch test=\"`$preload-data.preload-network-topology-information.subnets[$i].addr-from-start`\">","comments":"","outputs":1,"x":1241.675163269043,"y":1241.6893377304077,"z":"904f855.2f5e8f8","wires":[["5ececd95.cb981c","c803a7a5.ad9e38","4d4043ed.bbe3f4"]]},{"id":"5ececd95.cb981c","type":"other","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":1495.8974914550781,"y":1199.6259698867798,"z":"904f855.2f5e8f8","wires":[["c8aeb545.ec2978"]]},{"id":"c803a7a5.ad9e38","type":"other","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":1495.8021545410156,"y":1284.181456565857,"z":"904f855.2f5e8f8","wires":[["7c696201.cb9d54"]]},{"id":"7c696201.cb9d54","type":"set","name":"set tmp.addrFromStart.boolean=false","xml":"<set>\n<parameter name=\"tmp.addrFromStart.boolean\" value=\"false\" />\n","comments":"","x":1741.5004806518555,"y":1284.6751956939697,"z":"904f855.2f5e8f8","wires":[]},{"id":"c8aeb545.ec2978","type":"set","name":"set tmp.addrFromStart.boolean=true","xml":"<set>\n<parameter name=\"tmp.addrFromStart.boolean\" value=\"true\" />\n","comments":"","x":1746.675148010254,"y":1199.8974237442017,"z":"904f855.2f5e8f8","wires":[]},{"id":"4d4043ed.bbe3f4","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":1494.9608612060547,"y":1241.260908126831,"z":"904f855.2f5e8f8","wires":[["c8aeb545.ec2978"]]},{"id":"24c96fdf.aba0e","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1479.1072463989258,"y":1550.4287095069885,"z":"904f855.2f5e8f8","wires":[["393be07f.91e3"]]},{"id":"ca97996a.85c7f","type":"switchNode","name":"switch test: PRELOAD gateway-address","xml":"<switch test=\"`$preload-data.preload-network-topology-information.subnets[$i].gateway-address`\">","comments":"","outputs":1,"x":1255.5000762939453,"y":1398.231457233429,"z":"904f855.2f5e8f8","wires":[["95fd72a7.7afd08"]]},{"id":"95fd72a7.7afd08","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":1495.9999828338623,"y":1398.2314133644104,"z":"904f855.2f5e8f8","wires":[["6e1d3211.0bee04"]]},{"id":"a1773e6f.77a1e","type":"GenericXML","name":"Execute: generate gateway-address","xml":"<execute plugin=\"com.att.sdnctl.sli.plugin.ipAddressTools.IpAddressTool\" method=\"getGatewayAddress\">\n\t<parameter name=\"ipAddress\" value=\"`$preload-data.preload-network-topology-information.subnets[$i].start-address`\" />\n\t<parameter name=\"ipVersion\" value=\"`$preload-data.preload-network-topology-information.subnets[$i].ip-version`\" />\n\t<parameter name=\"subnet\" value=\"`$preload-data.preload-network-topology-information.subnets[$i].cidr-mask`\" />\n\t<parameter name=\"ctxVariable\" value=\"tmp.return.generate.gateway-address\" />","comments":"","outputs":1,"x":1921.2499980926514,"y":1397.981420993805,"z":"904f855.2f5e8f8","wires":[["cbbe4a5f.1e968"]]},{"id":"6e1d3211.0bee04","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1646.7499904632568,"y":1398.2314238548279,"z":"904f855.2f5e8f8","wires":[["a1773e6f.77a1e","bd82e01.b8a6ea"]]},{"id":"75e2306b.a71d6","type":"set","name":"set tmp.gateway-address","xml":"<set>\n<parameter name=\"tmp.gateway-address\" value=\"`$preload-data.preload-network-topology-information.subnets[$i].gateway-address`\" />\n","comments":"","x":1205.9999980926514,"y":1343.4814200401306,"z":"904f855.2f5e8f8","wires":[]},{"id":"bd82e01.b8a6ea","type":"set","name":"set tmp.gateway-address","xml":"<set>\n<parameter name=\"tmp.gateway-address\" value=\"`$tmp.return.generate.gateway-address`\" />\n","comments":"","x":1892.7499980926514,"y":1458.9814229011536,"z":"904f855.2f5e8f8","wires":[]},{"id":"393be07f.91e3","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":1678.5000743865967,"y":1550.0648274421692,"z":"904f855.2f5e8f8","wires":[["2e1587e6.6e5ca","10c680f7.aeae4f"]]},{"id":"2e1587e6.6e5ca","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'An error occurred while saving subnet in AnAI where subnet-id = ' + $tmp.return.generate-subnets-subnet-id.uuid`\"/>","comments":"","x":1917.599615097046,"y":1549.8147263526917,"z":"904f855.2f5e8f8","wires":[]},{"id":"3239fd87.45740a","type":"call","name":"call: generate-subnets-subnet-id","xml":"<call module=\"VNF-API\" rpc=\"generate-subnets-subnet-id\" mode=\"sync\" >\n","comments":"","outputs":1,"x":1230.614938735962,"y":1498.088562488556,"z":"904f855.2f5e8f8","wires":[["e7942995.6198b8"]]},{"id":"e7942995.6198b8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1480.3649234771729,"y":1498.3385529518127,"z":"904f855.2f5e8f8","wires":[["10c680f7.aeae4f"]]},{"id":"fe762cff.ee4918","type":"save","name":"save AnAI - l3-network.subnets","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"subnet\" \n\t\tkey=\"l3-network.network-id = $tmp.l3-network.network-id \n\t\t\tAND subnet.subnet-id = $tmp.return.generate-subnets-subnet-id.uuid\" >\n<!-- Create subnet object -->\n<parameter name=\"network-id\" value=\"`$tmp.l3-network.network-id`\" />\n<parameter name=\"subnet-id\" value=\"`$tmp.return.generate-subnets-subnet-id.uuid`\" />\n<parameter name=\"subnet-name\" value=\"`$preload-data.preload-network-topology-information.subnets[$i].subnet-name`\" />\n<parameter name=\"subnet-role\" value=\"`$preload-data.preload-network-topology-information.subnets[$i].subnet-role`\" />\n<parameter name=\"gateway-address\" value=\"`$tmp.gateway-address`\" />\n<parameter name=\"network-start-address\" value=\"`$preload-data.preload-network-topology-information.subnets[$i].start-address`\" />\n<parameter name=\"cidr-mask\" value=\"`$preload-data.preload-network-topology-information.subnets[$i].cidr-mask`\" />\n<parameter name=\"ip-version\" value=\"`$preload-data.preload-network-topology-information.subnets[$i].ip-version`\" />\n<parameter name=\"dhcp-start\" value=\"`$preload-data.preload-network-topology-information.subnets[$i].dhcp-start-address`\" />\n<parameter name=\"dhcp-end\" value=\"`$preload-data.preload-network-topology-information.subnets[$i].dhcp-end-address`\" />\n<parameter name=\"dhcp-enabled\" value=\"`$tmp.dhcpEnabled.boolean`\" />\n<parameter name=\"ip-assignment-direction\" value=\"`$tmp.addrFromStart.boolean`\" />\n<parameter name=\"orchestration-status\" value=\"PendingCreate\" />","comments":"","outputs":1,"x":1229.490972518921,"y":1550.0802063941956,"z":"904f855.2f5e8f8","wires":[["24c96fdf.aba0e","49a6098a.a5c0b"]]},{"id":"49a6098a.a5c0b","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1486.4244785308838,"y":1597.1480813026428,"z":"904f855.2f5e8f8","wires":[["393be07f.91e3"]]},{"id":"cbbe4a5f.1e968","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2167.5434856414795,"y":1398.5052399635315,"z":"904f855.2f5e8f8","wires":[["10c680f7.aeae4f"]]},{"id":"45e19eff.8708","type":"switchNode","name":"switch host-routes_length","xml":"<switch test='`$preload-data.preload-network-topology-information.host-routes_length`'>\n","comments":"","outputs":1,"x":1224.107276916504,"y":1643.4287152290344,"z":"904f855.2f5e8f8","wires":[["c81c1b79.1b13c"]]},{"id":"c81c1b79.1b13c","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1464.678695678711,"y":1643.0001244544983,"z":"904f855.2f5e8f8","wires":[["b6cc66.b6850b98"]]},{"id":"b6cc66.b6850b98","type":"set","name":"set host-routes_length to 0","xml":"<set>\n<parameter name='preload-data.preload-network-topology-information.host-routes_length' value='0' />\n","comments":"","x":1691.821662902832,"y":1643.4285683631897,"z":"904f855.2f5e8f8","wires":[]},{"id":"77358c60.78d16c","type":"call","name":"call: generate-host-routes-host-route-id","xml":"<call module=\"GENERIC-RESOURCE-API\" rpc=\"generate-host-routes-host-route-id\" mode=\"sync\" >\n","comments":"","outputs":1,"x":1810.0160446166992,"y":1766.4289870262146,"z":"904f855.2f5e8f8","wires":[["413368b1.e1c6c"]]},{"id":"413368b1.e1c6c","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2074.76602935791,"y":1766.6789774894714,"z":"904f855.2f5e8f8","wires":[["10c680f7.aeae4f"]]},{"id":"18e3cafb.f22a2d","type":"for","name":"for loop h - PRELOAD host-routes","xml":"<for index=\"h\" start=\"0\" end=\"`$preload-data.preload-network-topology-information.host-routes_length`\">\n","comments":"","outputs":1,"x":1229.7225723266602,"y":1769.5429739952087,"z":"904f855.2f5e8f8","wires":[["6f86d096.5b7ca"]]},{"id":"6f86d096.5b7ca","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1509.9606628417969,"y":1765.9713797569275,"z":"904f855.2f5e8f8","wires":[["77358c60.78d16c","d816e769.eaa37","f9fba56f.8a299"]]},{"id":"d816e769.eaa37","type":"set","name":"set tmp.local.subnet-id","xml":"<set>\n<parameter name=\"tmp.local.subnet-id\" value=\"`$tmp.return.generate-subnets-subnet-id.uuid`\" />\n","comments":"","x":1759.960563659668,"y":1702.971405506134,"z":"904f855.2f5e8f8","wires":[]},{"id":"dd067dea.d7e48","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2079.1073322296143,"y":1824.4288630485535,"z":"904f855.2f5e8f8","wires":[["b769acb0.ddfd88"]]},{"id":"b769acb0.ddfd88","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":2278.500160217285,"y":1824.0649809837341,"z":"904f855.2f5e8f8","wires":[["d96697d3.24a928","10c680f7.aeae4f"]]},{"id":"d96697d3.24a928","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'An error occurred while saving host-route in AnAI where host-route-id = ' + $tmp.return.generate-host-routes-host-route-id.uuid`\"/>","comments":"","x":2487.099769592285,"y":1823.8146152496338,"z":"904f855.2f5e8f8","wires":[]},{"id":"f9fba56f.8a299","type":"save","name":"save AnAI - host-routes.host-route","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"host-route\" \n\t\tkey=\"l3-network.network-id = $tmp.l3-network.network-id \n\t\t\tAND subnet.subnet-id = $tmp.return.generate-subnets-subnet-id.uuid  \n\t\t\tAND host-route.host-route-id = $tmp.return.generate-host-routes-host-route-id.uuid\" >\n<!-- Create host-route object -->\n<parameter name=\"host-route-id\" value=\"`$tmp.return.generate-host-routes-host-route-id.uuid`\" />\n<parameter name=\"route-prefix\" value=\"`$preload-data.preload-network-topology-information.subnets[$i].host-routes[$h].route-prefix`\" />\n<parameter name=\"next-hop\" value=\"`$preload-data.preload-network-topology-information.subnets[$i].host-routes[$h].next-hop`\" />","comments":"","outputs":1,"x":1803.4910583496094,"y":1824.0803599357605,"z":"904f855.2f5e8f8","wires":[["dd067dea.d7e48","25e6c104.427846"]]},{"id":"25e6c104.427846","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":2087.6744651794434,"y":1872.3981447219849,"z":"904f855.2f5e8f8","wires":[["b769acb0.ddfd88"]]},{"id":"e3f5293b.03dee","type":"switchNode","name":"switch service-id","xml":"<switch test='`$tmp.l3-network.service-id`'>\n","comments":"","outputs":1,"x":680.9287490844727,"y":848.4644546508789,"z":"904f855.2f5e8f8","wires":[["3e11851a.61719a","be4f6ec9.f5675"]]},{"id":"3e11851a.61719a","type":"outcome","name":"outcome NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":869.9287490844727,"y":827.4644546508789,"z":"904f855.2f5e8f8","wires":[["f1b4df9f.d8d0e"]]},{"id":"be4f6ec9.f5675","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":844.9287490844727,"y":862.4644546508789,"z":"904f855.2f5e8f8","wires":[["16662914.1e81f7"]]},{"id":"f1b4df9f.d8d0e","type":"save","name":"save AnAI - l3-network","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network\" \n\t\tkey=\"l3-network.network-id = $tmp.l3-network.network-id\" >\n<!-- Create l3-network object -->\n<parameter name=\"network-id\" value=\"`$tmp.l3-network.network-id`\" />\n<parameter name=\"network-name\" value=\"`$tmp.network-instance-name`\" />\n<parameter name='network-type' value=\"`$tmp.l3-network.network-type`\" />\n<parameter name='network-role' value=\"`$tmp.l3-network.network-role`\" />\n<parameter name='network-technology' value=\"`$network-model.network-technology`\" />\n<parameter name=\"is-bound-to-vpn\" value=\"`$tmp.l3-network.is-bound-to-vpn-boolean`\" />\n<parameter name=\"tenant-id\" value=\"`$network-topology-operation-input.network-request-input.tenant`\" />\n<parameter name=\"network-role-instance\" value=\"0\" />\n<parameter name=\"orchestration-status\" value=\"PendingCreate\" />\n<parameter name=\"physical-network-name\" value=\"`$preload-data.preload-network-topology-information.physical-network-name`\" />\n<parameter name=\"is-provider-network\" value=\"`$preload-data.preload-network-topology-information.is-provider-network`\" />\n<parameter name=\"is-shared-network\" value=\"`$preload-data.preload-network-topology-information.is-shared-network`\" />\n<parameter name=\"is-external-network\" value=\"`$preload-data.preload-network-topology-information.is-external-network`\" />\n<parameter name=\"selflink\" value=\"`$tmp.l3-network.self-link`\" />\n","comments":"","outputs":1,"x":1089.6786575317383,"y":829.9645071029663,"z":"904f855.2f5e8f8","wires":[["ae985daf.cc194","4833e133.eaab"]]},{"id":"d792a084.fab23","type":"save","name":"save relationship: tenant and cloud-region","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network:relationship-list\" \n\tkey=\"l3-network.network-id = $tmp.l3-network.network-id\" \n\tforce=\"true\" \n\tlocal-only=\"false\">\n\t<!-- create relationship-list -->\n\t<parameter name=\"relationship-list.relationship[0].related-to\" value=\"tenant\" />\n\t<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"cloud-region.cloud-owner\" />\n\t<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.cloud-region.cloud-owner`\" />\n\t<parameter name=\"relationship-list.relationship[0].relationship-data[1].relationship-key\" value=\"cloud-region.cloud-region-id\" />\n\t<parameter name=\"relationship-list.relationship[0].relationship-data[1].relationship-value\" value=\"`$network-topology-operation-input.network-request-input.aic-cloud-region`\" />\n\t<parameter name=\"relationship-list.relationship[0].relationship-data[2].relationship-key\" value=\"tenant.tenant-id\" />\n\t<parameter name=\"relationship-list.relationship[0].relationship-data[2].relationship-value\" value=\"`$network-topology-operation-input.network-request-input.tenant`\" />\n\t<parameter name=\"relationship-list.relationship[1].related-to\" value=\"cloud-region\" />\n\t<parameter name=\"relationship-list.relationship[1].relationship-data[0].relationship-key\" value=\"cloud-region.cloud-owner\" />\n\t<parameter name=\"relationship-list.relationship[1].relationship-data[0].relationship-value\" value=\"`$prop.cloud-region.cloud-owner`\" />\n\t<parameter name=\"relationship-list.relationship[1].relationship-data[1].relationship-key\" value=\"cloud-region.cloud-region-id\" />\n\t<parameter name=\"relationship-list.relationship[1].relationship-data[1].relationship-value\" value=\"`$network-topology-operation-input.network-request-input.aic-cloud-region`\" />\n\t\n\t","comments":"","outputs":1,"x":741.3571853637695,"y":2109.179002761841,"z":"904f855.2f5e8f8","wires":[["16175e24.e2a11a","34c93d4a.ebf89a"]]},{"id":"16175e24.e2a11a","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":989.3571891784668,"y":2109.1789932250977,"z":"904f855.2f5e8f8","wires":[["71f7c6e5.f11fd"]]},{"id":"71f7c6e5.f11fd","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1177.7500171661377,"y":2108.8151111602783,"z":"904f855.2f5e8f8","wires":[["28674d86.03d222","10c680f7.aeae4f"]]},{"id":"28674d86.03d222","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'An error occurred while saving tenant and cloud-region relationship for l3-network in AnAI where network-id = ' + $tmp.l3-network.network-id`\"/>","comments":"","x":1387.7381744384766,"y":2106.628755569458,"z":"904f855.2f5e8f8","wires":[]},{"id":"34c93d4a.ebf89a","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":997.3650321960449,"y":2151.012315750122,"z":"904f855.2f5e8f8","wires":[["71f7c6e5.f11fd"]]},{"id":"cc0b4bd9.424d18","type":"set","name":"set l3-network","xml":"<set>\n<parameter name='tmp.l3-network.network-name' value=\"`$tmp.network-instance-name`\" />\n<parameter name='tmp.l3-network.network-type' value=\"`$preload-data.preload-network-topology-information.network-topology-identifier-structure.network-type`\" />\n<parameter name=\"tmp.l3-network.physical-network-name\" value=\"`$preload-data.preload-network-topology-information.physical-network-name`\" />\n<parameter name=\"tmp.l3-network.is-provider-network\" value=\"`$preload-data.preload-network-topology-information.is-provider-network`\" />\n<parameter name=\"tmp.l3-network.is-shared-network\" value=\"`$preload-data.preload-network-topology-information.is-shared-network`\" />\n<parameter name=\"tmp.l3-network.is-external-network\" value=\"`$preload-data.preload-network-topology-information.network-topology-identifier-structure.network-type`\" />\n<parameter name='tmp.l3-network.network-role' value=\"`$preload-data.preload-network-topology-information.network-topology-identifier-structure.network-role`\" />\n<parameter name='tmp.l3-network.network-technology' value=\"`$preload-data.preload-network-topology-information.network-topology-identifier-structure.network-technology`\" />\n<parameter name='tmp.l3-network.is-bound-to-vpn' value=\"`$network-model.is-bound-to-vpn`\" />\n<parameter name=\"tmp.l3-network.tenant-id\" value=\"`$network-topology-operation-input.network-request-input.tenant`\" />\n<parameter name=\"tmp.l3-network.network-role-instance\" value=\"0\" />\n<parameter name='tmp.l3-network.orchestration-status' value=\"PendingCreate\" />\n<parameter name='tmp.l3-network.model-invariant-id' value=\"`$network-topology-operation-input.network-information.onap-model-information.model-invariant-uuid`\" />\n<parameter name='tmp.l3-network.model-version-id' value=\"`$network-topology-operation-input.network-information.onap-model-information.model-version`\" />\n<parameter name='tmp.l3-network.model-customization-id' value=\"`$network-topology-operation-input.network-information.onap-model-information.model-customization-uuid`\" />\n<parameter name='tmp.l3-network.eipam-v6-address-plan' value=\"`$network-model.eipam-v6-address-plan`\" />\n<parameter name='tmp.l3-network.eipam-v4-address-plan' value=\"`$network-model.eipam-v4-address-plan`\" />\n<parameter name='tmp.l3-network.service-id' value=\"`$service-data.service-information.service-id`\" />\n<parameter name='tmp.l3-network.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $service-data.service-information.service-instance-id\n + '/service-data/networks/network/'\n + $tmp.l3-network.network-id\n + '/network-data/network-topology/'` \" />\n","comments":"","x":677.9287719726562,"y":758.2145385742188,"z":"904f855.2f5e8f8","wires":[]},{"id":"fbeedbdb.9915b","type":"set","name":"copy input to service-data","xml":"<set>\n<parameter name='service-data.networks.network[$nidx].network-data.sdnc-request-header.' value='`$network-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.networks.network[$nidx].network-data.request-information.' value='`$network-topology-operation-input.request-information.`' />\n<parameter name='service-data.networks.network[$nidx].network-data.service-information.' value='`$network-topology-operation-input.service-information.`' />\n<parameter name='service-data.networks.network[$nidx].network-data.network-information.' value='`$network-topology-operation-input.network-information.`' />\n<parameter name='service-data.networks.network[$nidx].network-data.network-request-input.' value='`$network-topology-operation-input.network-request-input.`' />\n","comments":"","x":691.4642944335938,"y":390.00001096725464,"z":"904f855.2f5e8f8","wires":[]},{"id":"9af57339.b5c73","type":"set","name":"set onap-model-info","xml":"<set>\n<parameter name='tmp.l3-network.model-invariant-id' value=\"`$network-topology-operation-input.network-information.onap-model-information.model-invariant-uuid`\" />\n<parameter name='tmp.l3-network.model-version-id' value=\"`$network-topology-operation-input.network-information.onap-model-information.model-version`\" />\n<parameter name='tmp.l3-network.model-customization-id' value=\"`$network-topology-operation-input.network-information.onap-model-information.model-customization-uuid`\" />\n<parameter name='s-onap-model-information.model-invariant-uuid' value='`$service-model.invariant-uuid`' />\n<parameter name='s-onap-model-information.model-version' value='`$service-model.version`' />\n<parameter name='s-onap-model-information.model-uuid' value='`$service-model.service-uuid`' />\n<parameter name='s-onap-model-information.model-name' value='`$service-model.name`' />\n<parameter name='n-onap-model-information.model-invariant-uuid' value='`$network-model.invariant-uuid`' />\n<parameter name='n-onap-model-information.model-version' value='`$network-model.version`' />\n<parameter name='n-onap-model-information.model-uuid' value='`$network-model.uuid`' />\n<parameter name='n-onap-model-information.model-name' value='`$network-model.name`' />","comments":"","x":675.6347427368164,"y":420.0634126663208,"z":"904f855.2f5e8f8","wires":[]},{"id":"cae6b67f.073328","type":"set","name":"set onap-model-info with mysql data","xml":"<set>\n<parameter name='service-data.networks.network[$nidx].network-data.service-information.ecomp-model-information.' value=\"`$s-onap-model-information.`\" />\n<parameter name='service-data.networks.network[$nidx].network-data.network-information.ecomp-model-information.' value=\"`$n-onap-model-information.`\" />\n","comments":"","x":724.8847312927246,"y":450.563410282135,"z":"904f855.2f5e8f8","wires":[]},{"id":"ad534b95.44473","type":"set","name":"set object-path","xml":"<set>\n<parameter name='network-object-path'\n value=\"`$tmp.l3-network.self-link`\"/>\n \n","comments":"","x":660.0010604858398,"y":3678.7512464523315,"z":"904f855.2f5e8f8","wires":[]},{"id":"1fa70774.12d5c1","type":"set","name":"set networkId","xml":"<set>\n<parameter name='networkId' value='`$tmp.l3-network.network-id`' />\n","comments":"","x":656.429557800293,"y":3635.036647796631,"z":"904f855.2f5e8f8","wires":[]},{"id":"27110277.784596","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name='' value='' />\n","comments":"","x":656.0010375976562,"y":3809.7509765625,"z":"904f855.2f5e8f8","wires":[]},{"id":"cd67760d.3b296","type":"delete","name":"delete l3-network","xml":"<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network\" \n\tkey=\"l3-network.network-id = $tmp.return.generate-l3network-network-id.uuid\">","comments":"","outputs":1,"x":2557.2512741088867,"y":3742.7511587142944,"z":"904f855.2f5e8f8","wires":[[]]},{"id":"e1d80a1a.7969e8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='500'/>\n\t<parameter name='error-message' value=\"`'Error writing to l3-netework - ' + $tmp.error-message`\"/>","comments":"","x":2544.188606262207,"y":3785.947202682495,"z":"904f855.2f5e8f8","wires":[]},{"id":"10c680f7.aeae4f","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2367.427536010742,"y":3743.0027475357056,"z":"904f855.2f5e8f8","wires":[["cd67760d.3b296","e1d80a1a.7969e8"]]},{"id":"2d9b4f3.65a3a3","type":"set","name":"set tmp.local.network-id","xml":"<set>\n<parameter name=\"tmp.local.network-id\" value=\"`$tmp.l3-network.network-id`\" />\n","comments":"","x":1204.2101726531982,"y":1448.8384919166565,"z":"904f855.2f5e8f8","wires":[]},{"id":"6fca91a9.21355","type":"set","name":"set network-level-oper-status","xml":"<set>\n<parameter name='service-data.networks.network[$nidx].network-data.network-level-oper-status.order-status' value='PendingCreate' />\n<parameter name='service-data.networks.network[$nidx].network-data.network-level-oper-status.last-rpc-action' value='`$network-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.networks.network[$nidx].network-data.network-level-oper-status.last-action' value='`$network-topology-operation-input.request-information.request-action`' />\n","comments":"","x":701.2500610351562,"y":3725.2502098083496,"z":"904f855.2f5e8f8","wires":[]},{"id":"1375dc08.d1881c","type":"for","name":"for loop i - PRELOAD vpn-bindings","xml":"<for index=\"i\" start=\"0\" end=\"`$preload-data.preload-network-topology-information.vpn-bindings_length`\">\n","comments":"","outputs":1,"x":731.001091003418,"y":2297.751326560974,"z":"904f855.2f5e8f8","wires":[["574d1c0a.691b24"]]},{"id":"574d1c0a.691b24","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":972.7788696289062,"y":2298.0013284683228,"z":"904f855.2f5e8f8","wires":[["fa2bbaf6.dd3228","200741d1.dc8a7e","a65f567d.8acfe8"]]},{"id":"41a8cddd.36fdfc","type":"save","name":"save relationship: vpn_bindings","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network:relationship-list\" \n\tkey=\"l3-network.network-id = $tmp.l3-network.network-id\" \n\tforce=\"true\" \n\tlocal-only=\"false\">\n\t\n\t<parameter name=\"relationship-list.relationship[0].related-to\" value=\"vpn-binding\" />\n\t<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"vpn-binding.vpn-id\" />\n\t<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$tmp.vpn-binding-id`\" />","comments":"","outputs":1,"x":1677.1637802124023,"y":2575.8306770324707,"z":"904f855.2f5e8f8","wires":[["8d07f24a.1fe3a8","4a84f29d.fed7ac","ea15ac27.f9401"]]},{"id":"e618d649.0c64a8","type":"switchNode","name":"switch ... PRELOAD vpn-bindings[]","xml":"<switch test=\"`$preload-data.preload-network-topology-information.vpn-bindings_length`\">","comments":"","outputs":1,"x":731.3785341050889,"y":2246.3326400121055,"z":"904f855.2f5e8f8","wires":[["74b70b65.70671c"]]},{"id":"74b70b65.70671c","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":951.8229844835068,"y":2246.1103757222495,"z":"904f855.2f5e8f8","wires":[["73ec0d7b.d3f2a4"]]},{"id":"73ec0d7b.d3f2a4","type":"set","name":"set vpn-bindings[] = 0","xml":"<set>\n<parameter name=\"preload-data.preload-network-topology-information.vpn-bindings_length\" value=\"0\" />\n","comments":"","x":1146.3785934448242,"y":2246.110396385193,"z":"904f855.2f5e8f8","wires":[]},{"id":"ac65277d.2e0e68","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1915.2632484436035,"y":2481.6006326675415,"z":"904f855.2f5e8f8","wires":[["69a18f95.bb6bb"]]},{"id":"d2cfe57b.a35e58","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1922.7632522583008,"y":2434.100631713867,"z":"904f855.2f5e8f8","wires":[["69a18f95.bb6bb"]]},{"id":"69a18f95.bb6bb","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2098.263252258301,"y":2481.350633621216,"z":"904f855.2f5e8f8","wires":[["d6496602.bf5e48","10c680f7.aeae4f"]]},{"id":"d6496602.bf5e48","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'Failed to query vpn-bindings from AnAI where vpn-binding-id = ' + $preload-data.preload-network-topology-information.vpn-bindings[$i].vpn-binding-id`\"/>","comments":"","x":2320.36279296875,"y":2481.1005325317383,"z":"904f855.2f5e8f8","wires":[]},{"id":"fa2bbaf6.dd3228","type":"switchNode","name":"switch: PRELOAD vpn-binding-id","xml":"<switch test=\"`$preload-data.preload-network-topology-information.vpn-bindings[$i].vpn-binding-id`\">","comments":"","outputs":1,"x":1251.263256072998,"y":2344.850570678711,"z":"904f855.2f5e8f8","wires":[["30879991.8d2a86"]]},{"id":"30879991.8d2a86","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1464.7632637023926,"y":2344.6005716323853,"z":"904f855.2f5e8f8","wires":[["bcd7dc4e.537ee8"]]},{"id":"bcd7dc4e.537ee8","type":"set","name":"set tmp.vpn-binding-id","xml":"<set>\n<parameter name=\"tmp.vpn-binding-id\" value=\"`$preload-data.preload-network-topology-information.vpn-bindings[$i].vpn-binding-id`\" />\n","comments":"","x":1647.2632637023926,"y":2344.6005725860596,"z":"904f855.2f5e8f8","wires":[]},{"id":"14075edf.8f17f1","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1918.2632484436035,"y":2389.350631713867,"z":"904f855.2f5e8f8","wires":[["411a0ec1.9a0e68"]]},{"id":"8d07f24a.1fe3a8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1902.2366561889648,"y":2575.306263923645,"z":"904f855.2f5e8f8","wires":[["ec08a067.d71d18"]]},{"id":"ec08a067.d71d18","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2090.129535675049,"y":2574.942371368408,"z":"904f855.2f5e8f8","wires":[["417f4c1f.354f84","10c680f7.aeae4f"]]},{"id":"417f4c1f.354f84","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'An error occurred while saving vpn-binding relationship for l3-network in AnAI where vpn-id = ' + $tmp.vpn-binding-id`\"/>","comments":"","x":2303.229076385498,"y":2575.6922702789307,"z":"904f855.2f5e8f8","wires":[]},{"id":"200741d1.dc8a7e","type":"switchNode","name":"switch: tmp.vpn-binding-id != NULL","xml":"<switch test=\"`$tmp.vpn-binding-id != ''`\">","comments":"","outputs":1,"x":1000.2633056640625,"y":2403.26708984375,"z":"904f855.2f5e8f8","wires":[["ce353cf6.29839"]]},{"id":"ce353cf6.29839","type":"other","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1234.01318359375,"y":2403.26708984375,"z":"904f855.2f5e8f8","wires":[["d5c07d00.bbbf9"]]},{"id":"a65f567d.8acfe8","type":"set","name":"unset tmp.vpn-binding-id","xml":"<set>\n<parameter name=\"tmp.vpn-binding-id\" value=\"\" />\n","comments":"","x":1225.3385620117188,"y":2298.544904232025,"z":"904f855.2f5e8f8","wires":[]},{"id":"4a84f29d.fed7ac","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1905.8941268920898,"y":2662.16392993927,"z":"904f855.2f5e8f8","wires":[["e2bb2c87.3d244"]]},{"id":"e2bb2c87.3d244","type":"set","name":"set tmp.is-bound-to-vpn","xml":"<set>\n<parameter name=\"tmp.is-bound-to-vpn\" value=\"true\" />\n","comments":"","x":2096.39412689209,"y":2662.16392993927,"z":"904f855.2f5e8f8","wires":[]},{"id":"ea15ac27.f9401","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1910.3225936889648,"y":2617.9575357437134,"z":"904f855.2f5e8f8","wires":[["ec08a067.d71d18"]]},{"id":"411a0ec1.9a0e68","type":"switchNode","name":"switch: tmp.AnAI.vpn-binding.vpn-id","xml":"<switch test=\"`$tmp.AnAI.vpn-binding.vpn-id`\" >","comments":"","outputs":1,"x":2134.2711181640625,"y":2388.850341796875,"z":"904f855.2f5e8f8","wires":[["c1c55f5c.7e6848"]]},{"id":"c1c55f5c.7e6848","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":2376.0211181640625,"y":2389.3504695892334,"z":"904f855.2f5e8f8","wires":[["9a952383.71055"]]},{"id":"9a952383.71055","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2555.1337890625,"y":2389.750732421875,"z":"904f855.2f5e8f8","wires":[["6f76fb55.547514","10c680f7.aeae4f"]]},{"id":"6f76fb55.547514","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'Failed to query vpn-bindings from AnAI where vpn-binding-id  = ' + $tmp.vpn-binding-id + '.'`\"/>","comments":"","x":2770.633758544922,"y":2389.7507152557373,"z":"904f855.2f5e8f8","wires":[]},{"id":"98f1afcd.7f17e","type":"switchNode","name":"switch ... PRELOAD network-policy[]","xml":"<switch test=\"`$preload-data.preload-network-topology-information.network-policy_length`\">","comments":"","outputs":1,"x":739.7509689331055,"y":2681.50096988678,"z":"904f855.2f5e8f8","wires":[["fe947295.cc353"]]},{"id":"fe947295.cc353","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":969.1954193115234,"y":2681.278705596924,"z":"904f855.2f5e8f8","wires":[["7d31c197.0306e8"]]},{"id":"7d31c197.0306e8","type":"set","name":"set network-policy[] = 0","xml":"<set>\n<parameter name='preload-data.preload-network-topology-information.network-policy_length' value='0' />\n","comments":"","x":1163.7510282728408,"y":2681.278726259867,"z":"904f855.2f5e8f8","wires":[]},{"id":"31fdd3c0.8004c4","type":"for","name":"for loop i - PRELOAD network-policy","xml":"<for index=\"i\" start=\"0\" end=\"`$preload-data.preload-network-topology-information.network-policy_length`\">\n","comments":"","outputs":1,"x":739.1082305908203,"y":2727.0723609924316,"z":"904f855.2f5e8f8","wires":[["816cabff.5b8288"]]},{"id":"816cabff.5b8288","type":"switchNode","name":"switch: PRELOAD network-policy-fqdn != NULL","xml":"<switch test=\"`$preload-data.preload-network-topology-information.network-policy[$i].network-policy-fqdn != ''`\">","comments":"","outputs":1,"x":1095.3704893324111,"y":2727.4216190973916,"z":"904f855.2f5e8f8","wires":[["6c21593a.79f8c8"]]},{"id":"6c21593a.79f8c8","type":"other","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1361.1204893324111,"y":2727.6716190973916,"z":"904f855.2f5e8f8","wires":[["ebc6ee05.37034"]]},{"id":"ebc6ee05.37034","type":"save","name":"query AnAI - network-policy","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"network-policy\" \n\t\tkey=\"network-policy.network-policy-fqdn = $preload-data.preload-network-topology-information.network-policy[$i].network-policy-fqdn\" \n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.AnAI.network-policy\">","comments":"","outputs":1,"x":1570.3704931471084,"y":2727.6716190973916,"z":"904f855.2f5e8f8","wires":[["fd584772.5251c8","107c735d.16382d","6dd4ddb8.3db9bc"]]},{"id":"fd584772.5251c8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1778.3705770704482,"y":2768.671628634135,"z":"904f855.2f5e8f8","wires":[["5a78ea1e.a9aff4"]]},{"id":"107c735d.16382d","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1783.8705808851455,"y":2727.1716276804605,"z":"904f855.2f5e8f8","wires":[["5a78ea1e.a9aff4"]]},{"id":"5a78ea1e.a9aff4","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1948.3705808851455,"y":2768.421629587809,"z":"904f855.2f5e8f8","wires":[["e4f69cc5.48bbb","10c680f7.aeae4f"]]},{"id":"e4f69cc5.48bbb","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'Failed to query network-policy n AnAI where network-policy-fqdn = ' + $preload-data.preload-network-topology-information.network-policy[$i].network-policy-fqdn`\"/>","comments":"","x":2157.4701215955947,"y":2768.1715284983316,"z":"904f855.2f5e8f8","wires":[]},{"id":"6dd4ddb8.3db9bc","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1780.9017851087783,"y":2813.0007015864053,"z":"904f855.2f5e8f8","wires":[["2573614f.5ccd5e"]]},{"id":"2573614f.5ccd5e","type":"switchNode","name":"switch: tmp.AnAI.network-policy.network-policy-id","xml":"<switch test=\"`$tmp.AnAI.network-policy.network-policy-id`\" >","comments":"","outputs":1,"x":2058.981056213379,"y":2812.5005588531494,"z":"904f855.2f5e8f8","wires":[["d95b3655.f3c99","3bf15b8c.2b4dec"]]},{"id":"d95b3655.f3c99","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":2332.731056213379,"y":2812.0005588531494,"z":"904f855.2f5e8f8","wires":[["a6733916.0987f"]]},{"id":"3bf15b8c.2b4dec","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2332.223213195801,"y":2859.250657081604,"z":"904f855.2f5e8f8","wires":[["c4ba6c4d.50611"]]},{"id":"ae3f6cc0.f931c","type":"switchNode","name":"switch ... PRELOAD route-table-reference[]","xml":"<switch test=\"`$preload-data.preload-network-topology-information.route-table-reference_length`\">","comments":"","outputs":1,"x":757.4017868041992,"y":2880.0006036758423,"z":"904f855.2f5e8f8","wires":[["39c5aea5.9800ea"]]},{"id":"39c5aea5.9800ea","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":1012.8462371826172,"y":2879.7783393859863,"z":"904f855.2f5e8f8","wires":[["ac917dd3.d158b"]]},{"id":"ac917dd3.d158b","type":"set","name":"set route-table-reference[] = 0","xml":"<set>\n<parameter name='preload-data.preload-network-topology-information.route-table-reference_length' value='0' />\n","comments":"","x":1217.1519088745117,"y":2878.528371810913,"z":"904f855.2f5e8f8","wires":[]},{"id":"c33e48fe.f40f2","type":"for","name":"for loop i - PRELOAD route-table-reference","xml":"<for index=\"i\" start=\"0\" end=\"`$preload-data.preload-network-topology-information.route-table-reference_length`\">\n","comments":"","outputs":1,"x":755.7590484619141,"y":2927.571994781494,"z":"904f855.2f5e8f8","wires":[["1d90a206.a94ee6"]]},{"id":"1d90a206.a94ee6","type":"switchNode","name":"switch: PRELOAD route-table-reference-fqdn != NULL","xml":"<switch test=\"`$preload-data.preload-network-topology-information.route-table-reference[$i].route-table-reference-fqdn != ''`\">","comments":"","outputs":1,"x":1141.354637145996,"y":2927.2545766830444,"z":"904f855.2f5e8f8","wires":[["d931b196.bb13c8"]]},{"id":"d931b196.bb13c8","type":"other","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1407.104637145996,"y":2927.5045766830444,"z":"904f855.2f5e8f8","wires":[["c0151afe.ccf7d"]]},{"id":"c0151afe.ccf7d","type":"save","name":"query AnAI - route-table-reference","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"route-table-reference\" \n\t\tkey=\"route-table-reference.route-table-reference-fqdn = $preload-data.preload-network-topology-information.route-table-reference[$i].route-table-reference-fqdn\" \n\t\tpfx=\"tmp.AnAI.route-table-reference\">","comments":"","outputs":1,"x":1636.3546409606934,"y":2927.5045766830444,"z":"904f855.2f5e8f8","wires":[["1b0d4ab1.0fe45d","da9c4c3f.55e8f8","173ff66c.769472"]]},{"id":"1b0d4ab1.0fe45d","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1862.3547248840332,"y":2968.5045862197876,"z":"904f855.2f5e8f8","wires":[["1a466fe2.b5678"]]},{"id":"da9c4c3f.55e8f8","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1867.8547286987305,"y":2927.0045852661133,"z":"904f855.2f5e8f8","wires":[["1a466fe2.b5678"]]},{"id":"1a466fe2.b5678","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2032.3547286987305,"y":2968.254587173462,"z":"904f855.2f5e8f8","wires":[["20cd2a36.de0a3e","10c680f7.aeae4f"]]},{"id":"20cd2a36.de0a3e","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'Failed to query network-policy n AnAI where network-policy-fqdn = ' + $preload-data.preload-network-topology-information.network-policy[$i].network-policy-fqdn`\"/>","comments":"","x":2241.4542694091797,"y":2968.0044860839844,"z":"904f855.2f5e8f8","wires":[]},{"id":"173ff66c.769472","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1864.8859329223633,"y":3012.833659172058,"z":"904f855.2f5e8f8","wires":[["2f54d5ed.3e6bf2"]]},{"id":"2f54d5ed.3e6bf2","type":"switchNode","name":"switch: tmp.AnAI.route-table-reference.route-table-reference-id","xml":"<switch test=\"`$tmp.AnAI.route-table-reference.route-table-reference-id`\" >","comments":"","outputs":1,"x":2182.965204026964,"y":3012.3335164388022,"z":"904f855.2f5e8f8","wires":[["a030e283.5654b8","bcbd20c4.9a6c98"]]},{"id":"c4ba6c4d.50611","type":"save","name":"save relationship: network-policy","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network:relationship-list\" \n\tkey=\"l3-network.network-id = $tmp.l3-network.network-id\" >\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"network-policy\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"network-policy.network-policy-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$tmp.AnAI.network-policy.network-policy-id`\" />","comments":"","outputs":1,"x":2562.2509689331055,"y":2859.00096988678,"z":"904f855.2f5e8f8","wires":[["a7e93fe1.c4cfa","e5d2edf9.e5817"]]},{"id":"a7e93fe1.c4cfa","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2785.323844909668,"y":2858.476556777954,"z":"904f855.2f5e8f8","wires":[["fe22bb02.ebcb9"]]},{"id":"fe22bb02.ebcb9","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2965.216724395752,"y":2858.1126642227173,"z":"904f855.2f5e8f8","wires":[["66d9ed51.cfd7e4","10c680f7.aeae4f"]]},{"id":"66d9ed51.cfd7e4","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'An error occurred while saving network-policy relationship for l3-network in AnAI where network-policy-id = ' + $tmp.AnAI.network-policy.network-policy-id`\"/>","comments":"","x":3188.316265106201,"y":2858.8625631332397,"z":"904f855.2f5e8f8","wires":[]},{"id":"e5d2edf9.e5817","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":2793.0602968004014,"y":2900.957081158956,"z":"904f855.2f5e8f8","wires":[["fe22bb02.ebcb9"]]},{"id":"a6733916.0987f","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2504.3181076049805,"y":2810.9569025039673,"z":"904f855.2f5e8f8","wires":[["c4ae766a.d2c618","10c680f7.aeae4f"]]},{"id":"c4ae766a.d2c618","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'Failed to query newtork-policy from AnAI where network-policy-fqdn = ' + $preload-data.preload-network-topology-information.network-policy[$i].network-policy-fqdn + '. It is likely that the same network-policy-fqdn points to more than one network-policy objects in AnAI.'`\"/>","comments":"","x":2749.468818664551,"y":2810.45645904541,"z":"904f855.2f5e8f8","wires":[]},{"id":"94618525.84434","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'Failed to query route-table-reference from AnAI where route-table-reference-fqdn = ' + $preload-data.preload-network-topology-information.route-table-reference[$i].route-table-reference-fqdn + '. It is likely that the same route-table-reference-fqdn points to more than one route-table-reference objects in AnAI.'`\"/>","comments":"","x":2934.7509689331055,"y":3001.500725746155,"z":"904f855.2f5e8f8","wires":[]},{"id":"857a389b.9483f","type":"save","name":"save relationship: route-table-reference","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network:relationship-list\" \n\tkey=\"l3-network.network-id = $tmp.l3-network.network-id\" >\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"route-table-reference\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"route-table-reference.route-table-reference-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$tmp.AnAI.route-table-reference.route-table-reference-id`\" />","comments":"","outputs":1,"x":2752.834571838379,"y":3051.0445041656494,"z":"904f855.2f5e8f8","wires":[["640cf074.779e4","f83c3398.a3e3c8"]]},{"id":"640cf074.779e4","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":3007.9074478149414,"y":3050.5200910568237,"z":"904f855.2f5e8f8","wires":[["4f94a64b.a935a8"]]},{"id":"4f94a64b.a935a8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":3187.8003273010254,"y":3050.156198501587,"z":"904f855.2f5e8f8","wires":[["320aaa6d.7cc736","10c680f7.aeae4f"]]},{"id":"320aaa6d.7cc736","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'An error occurred while saving route-table-reference relationship for l3-network in AnAI where route-table-reference-id = ' + $tmp.AnAI.route-table-reference.route-table-reference-id`\"/>","comments":"","x":3411.8998947143555,"y":3049.9061212539673,"z":"904f855.2f5e8f8","wires":[]},{"id":"f83c3398.a3e3c8","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":3015.643899705675,"y":3093.0006154378257,"z":"904f855.2f5e8f8","wires":[["4f94a64b.a935a8"]]},{"id":"a030e283.5654b8","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":2519.901710510254,"y":3003.500436782837,"z":"904f855.2f5e8f8","wires":[["9c548e59.9b55e"]]},{"id":"9c548e59.9b55e","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2684.901710510254,"y":3003.000436782837,"z":"904f855.2f5e8f8","wires":[["94618525.84434","10c680f7.aeae4f"]]},{"id":"bcbd20c4.9a6c98","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2519.393867492676,"y":3050.7505350112915,"z":"904f855.2f5e8f8","wires":[["857a389b.9483f"]]},{"id":"4ed44f0b.2faec8","type":"save","name":"update AnAI - l3-network","xml":"<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network\" \n\t\tkey=\"l3-network.network-id = $tmp.l3-network.network-id\" >\n<parameter name=\"is-bound-to-vpn\" value=\"true\" />","comments":"","outputs":1,"x":1147.8759689331055,"y":3049.000725746155,"z":"904f855.2f5e8f8","wires":[["b5e3d12a.6f35a8","fcaa4883.a338b8"]]},{"id":"b5e3d12a.6f35a8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1344.1591262817383,"y":3049.016043663025,"z":"904f855.2f5e8f8","wires":[["f4cb6f65.8fc2b"]]},{"id":"1edbf6d.7460609","type":"switchNode","name":"switch ... tmp.is-bound-to-vpn","xml":"<switch test=\"`$tmp.is-bound-to-vpn`\">","comments":"","outputs":1,"x":710.0188674926758,"y":3049.1436138153076,"z":"904f855.2f5e8f8","wires":[["b8c162bf.bfffb8"]]},{"id":"b8c162bf.bfffb8","type":"outcome","name":"true","xml":"<outcome value=\"true\">","comments":"","outputs":1,"x":929.4633178710938,"y":3048.9213495254517,"z":"904f855.2f5e8f8","wires":[["4ed44f0b.2faec8"]]},{"id":"f4cb6f65.8fc2b","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1556.2688064575195,"y":3049.393569946289,"z":"904f855.2f5e8f8","wires":[["9f9ea316.b821c8","10c680f7.aeae4f"]]},{"id":"9f9ea316.b821c8","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'An error occurred while updating l3-network is-bound-to-vpn in AnAI where network-id = ' + $tmp.return.generate-l3network-network-id.uuid`\"/>","comments":"","x":1774.7687911987305,"y":3049.14354801178,"z":"904f855.2f5e8f8","wires":[]},{"id":"fcaa4883.a338b8","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1351.6457595825195,"y":3090.115693092346,"z":"904f855.2f5e8f8","wires":[["f4cb6f65.8fc2b"]]},{"id":"c9e16987.b4c4a8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":990.3972854614258,"y":3199.8412466049194,"z":"904f855.2f5e8f8","wires":[["e48c4af.29ae6b8"]]},{"id":"e48c4af.29ae6b8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1170.2901649475098,"y":3199.4773540496826,"z":"904f855.2f5e8f8","wires":[["815fdd3b.9aa418","10c680f7.aeae4f"]]},{"id":"815fdd3b.9aa418","type":"set","name":"set: tmp.error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"tmp.error-message\" value=\"`'An error occurred while saving service-instance relationship for l3-network in AnAI where service-instance-id = ' + $network-topology-operation-input.service-information.service-instance-id`\"/>","comments":"","x":1408.3897323608398,"y":3199.227276802063,"z":"904f855.2f5e8f8","wires":[]},{"id":"27c04aed.76d49e","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":998.1337373521592,"y":3242.321770985922,"z":"904f855.2f5e8f8","wires":[["e48c4af.29ae6b8"]]},{"id":"d7a7e7e8.a8b248","type":"save","name":"save relationship: service-instance","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-network:relationship-list\" \n\tkey=\"l3-network.network-id = $tmp.l3-network.network-id\" >\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"service-instance\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"customer.global-customer-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$service-data.service-information.global-customer-id`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[1].relationship-key\" value=\"service-subscription.service-type\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[1].relationship-value\" value=\"`$service-data.service-information.subscription-service-type`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[2].relationship-key\" value=\"service-instance.service-instance-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[2].relationship-value\" value=\"`$service-data.service-information.service-instance-id`\" />","comments":"","outputs":1,"x":733.3760604858398,"y":3198.250744819641,"z":"904f855.2f5e8f8","wires":[["c9e16987.b4c4a8","27c04aed.76d49e"]]},{"id":"2475aec8.3301ca","type":"set","name":"set network in service-data","xml":"<set>\n<parameter name=\"service-data.networks.network[$nidx].network-id\" value='`$tmp.l3-network.network-id`' />\n<parameter name=\"service-data.networks.network[$nidx].network-data.network-information.from-preload\" value='true' />\n<parameter name=\"service-data.networks.network[$nidx].network-data.network-topology.\" value='$network-topology.' />\n<parameter name=\"service-data.networks.network_length\" value='`$nidx_len`' />\n\n","comments":"","x":719.7509689331055,"y":3486.500725746155,"z":"904f855.2f5e8f8","wires":[]},{"id":"6820b570.d2fcf4","type":"set","name":"set network-topology-identifier-structure in service-data","xml":"<set>\n<parameter name='network-topology.network-topology-identifier-structure.' value='`$tmp.l3-network.`' />\n<parameter name='network-topology.tenant' value='`$network-topology-operation-input.network-request-input.tenant`' />\n<parameter name='network-topology.onap-model-information.' value='`$network-topology-operation-input.network-information.onap-model-information.`' />\n<parameter name='network-topology.network-parameters.' value='`$network-topology-operation-input.network-request-input.network-parameters.`' />\n<parameter name='network-topology.aic-cloud-region' value='`$network-topology-operation-input.network-request-input.aic-cloud-region`' />","comments":"","x":803.5009498596191,"y":3379.358116298914,"z":"904f855.2f5e8f8","wires":[]},{"id":"9d88f2e8.48f3e","type":"switchNode","name":"switch tmp.nidx ","xml":"<switch test=\"`$tmp.nidx`\">\n\n","comments":"","outputs":1,"x":672.6088180541992,"y":319.00167179107666,"z":"904f855.2f5e8f8","wires":[["fc452003.28b968","f6026195.195f2"]]},{"id":"fc452003.28b968","type":"outcome","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":861.1802024841309,"y":317.573055267334,"z":"904f855.2f5e8f8","wires":[["e37c065b.540c88"]]},{"id":"e37c065b.540c88","type":"switchNode","name":"switch service-data.networks_length","xml":"<switch test='`$service-data.networks.network_length`'>\n","comments":"","outputs":1,"x":1110.4062957763672,"y":318.76397228240967,"z":"904f855.2f5e8f8","wires":[["e663db13.5a4698","c5159555.fdb15"]]},{"id":"e663db13.5a4698","type":"other","name":"Null","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":1403.501618385315,"y":317.5732808113098,"z":"904f855.2f5e8f8","wires":[["25d54d17.2b7a32"]]},{"id":"25d54d17.2b7a32","type":"set","name":"set nidx","xml":"<set>\n<parameter name='nidx' value='0' />\n<parameter name='nidx_len' value='1'/>\n","comments":"","x":1583.5016603469849,"y":315.1446967124939,"z":"904f855.2f5e8f8","wires":[]},{"id":"c5159555.fdb15","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1406.3587808609009,"y":343.2875533103943,"z":"904f855.2f5e8f8","wires":[["92920675.a1a7e"]]},{"id":"92920675.a1a7e","type":"set","name":"set nidx","xml":"<set>\n<parameter name='nidx' value='`$service-data.networks.network_length`' />\n<parameter name='nidx_len' value='`$service-data.networks.network_length + 1`' />\n","comments":"","x":1584.9302110671997,"y":352.1447539329529,"z":"904f855.2f5e8f8","wires":[]},{"id":"f6026195.195f2","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":862.6088371276855,"y":356.14452743530273,"z":"904f855.2f5e8f8","wires":[["27be96dc.4200d2"]]},{"id":"27be96dc.4200d2","type":"set","name":"set nidx","xml":"<set>\n<parameter name='nidx' value='`$tmp.nidx`' />\n<parameter name='nidx_len' value='`$service-data.networks.network_length`' />\n","comments":"","x":1025.4659614562988,"y":356.1445531845093,"z":"904f855.2f5e8f8","wires":[]},{"id":"75c470c.1b64c1","type":"execute","name":"execute printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/lmr-nto.log' />","comments":"","outputs":1,"x":676.75,"y":605,"z":"904f855.2f5e8f8","wires":[[]]},{"id":"d03a4655.11876","type":"execute","name":"execute printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/lmr-nto2.log' />","comments":"","outputs":1,"x":694.75,"y":3528.5,"z":"904f855.2f5e8f8","wires":[[]]},{"id":"250c1ed0.7ac68a","type":"set","name":"set network-information in service-data","xml":"<set>\n<parameter name=\"service-data.networks.network[$nidx].network-data.network-information.network-id\" value='`$tmp.l3-network.network-id`' />\n<parameter name=\"service-data.networks.network[$nidx].network-data.network-information.from-preload\" value='true' />\n<parameter name=\"service-data.networks.network[$nidx].network-data.network-information.network-type\" value='`$tmp.l3-network.network-type`' />\n\n","comments":"","x":751,"y":806.25,"z":"904f855.2f5e8f8","wires":[]},{"id":"7d4ea1ca.77ea4","type":"save","name":"query AnAI - vpn-bindings","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-binding\" \n\t\tkey=\"vpn-binding.vpn-id = $tmp.vpn-binding-id\" \n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.AnAI.vpn-binding\">","comments":"","outputs":1,"x":1706,"y":2403.25,"z":"904f855.2f5e8f8","wires":[["14075edf.8f17f1","d2cfe57b.a35e58","ac65277d.2e0e68"]]},{"id":"d5c07d00.bbbf9","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1463.5,"y":2403.5,"z":"904f855.2f5e8f8","wires":[["7d4ea1ca.77ea4","41a8cddd.36fdfc"]]}]