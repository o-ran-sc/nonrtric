[{"id":"79886f35.468b2","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":361,"y":33,"z":"13ea1295.46163d","wires":[["6bebd82e.dbb4e8"]]},{"id":"fc9a5aeb.9641b8","type":"dgstart","name":"DGSTART","outputs":1,"x":105,"y":33,"z":"13ea1295.46163d","wires":[["79886f35.468b2"]]},{"id":"6bebd82e.dbb4e8","type":"method","name":"method getpathsegment-populate-from-vnfapi","xml":"<method rpc='getpathsegment-populate-from-vnfapi' mode='sync'>\n","comments":"","outputs":1,"x":737,"y":33,"z":"13ea1295.46163d","wires":[["c815e4d6.935de8"]]},{"id":"c815e4d6.935de8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":172,"y":95,"z":"13ea1295.46163d","wires":[["d9a6b40e.e037e8","bc341c4c.788fc","45f4ec8e.8f54b4","3f5b8bf5.fb4eb4","f22ed2ac.cf7d4","8dce646d.ba9e58","fd97e171.58aa","aecdddc8.b3b0c","73374c07.1b3084","a7f70fe1.122d9","cf9d4004.d81ce"]]},{"id":"398ebb3d.c08964","type":"comment","name":"Validate ctx inputs","info":"","comments":"","x":229,"y":285,"z":"13ea1295.46163d","wires":[]},{"id":"d9a6b40e.e037e8","type":"switchNode","name":"switch input serv-inst.service-instance-id","xml":"<switch test='`$serv-inst.service-instance-id`'>\n","comments":"","outputs":1,"x":305,"y":371,"z":"13ea1295.46163d","wires":[["d44a97a1.a14c48"]]},{"id":"807211c8.250bf","type":"comment","name":"service-instance-id and match-type - REQUIRED","info":"","comments":"","x":326,"y":327,"z":"13ea1295.46163d","wires":[]},{"id":"d44a97a1.a14c48","type":"other","name":"Blank","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":535,"y":371,"z":"13ea1295.46163d","wires":[["19cff64d.9e764a"]]},{"id":"e84a6720.65d5f8","type":"GenericXML","name":"record","xml":"<record  plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: input service-instance-id is not set\"/>","comments":"","outputs":1,"x":781,"y":371,"z":"13ea1295.46163d","wires":[[]]},{"id":"bc341c4c.788fc","type":"switchNode","name":"switch input match-type","xml":"<switch test='`$match-type`'>\n","comments":"","outputs":1,"x":257,"y":456,"z":"13ea1295.46163d","wires":[["359972bf.ebd0ce"]]},{"id":"359972bf.ebd0ce","type":"other","name":"Blank","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":536,"y":456,"z":"13ea1295.46163d","wires":[["5fe8c913.e7db68"]]},{"id":"8e58421f.d9382","type":"GenericXML","name":"record","xml":"<record  plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: input match-type is not set\"/>","comments":"","outputs":1,"x":790,"y":457,"z":"13ea1295.46163d","wires":[[]]},{"id":"dd804e4.b1b1bb","type":"comment","name":"Determine simple or composite path from vnf-ids_length","info":"","comments":"","x":339,"y":577,"z":"13ea1295.46163d","wires":[]},{"id":"45f4ec8e.8f54b4","type":"switchNode","name":"switch input vnf-ids_length","xml":"<switch test='`$vnf-ids_length`'>\n","comments":"","outputs":1,"x":249,"y":622,"z":"13ea1295.46163d","wires":[["7745bc96.282894","4d6a5928.9b39e8"]]},{"id":"7745bc96.282894","type":"other","name":"Blank","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":439,"y":622,"z":"13ea1295.46163d","wires":[["cf606a1a.2b6be8"]]},{"id":"3fdc4223.03b76e","type":"GenericXML","name":"record","xml":"<record  plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: input vnf-ids_length is NOT blank, this is a SIMPLE path\"/>","comments":"","outputs":1,"x":700,"y":743,"z":"13ea1295.46163d","wires":[[]]},{"id":"804d67a4.472cc8","type":"comment","name":"For 1806: will match-type always be \"network-name\", may have other values in the future","info":"","comments":"","x":1153,"y":456,"z":"13ea1295.46163d","wires":[]},{"id":"52e459e3.cc48b8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":566,"y":687,"z":"13ea1295.46163d","wires":[["a7265092.2dcf2","3fdc4223.03b76e"]]},{"id":"a7265092.2dcf2","type":"set","name":"set path-type SIMPLE","xml":"<set>\n<parameter name=\"path-type\" value= \"SIMPLE\"/>","comments":"","x":745,"y":693,"z":"13ea1295.46163d","wires":[]},{"id":"8dce646d.ba9e58","type":"execute","name":"printContext * TEST-ONLY *","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/getpathsegment-populate-from-vnfapi-output.log' />\n","comments":"","outputs":1,"x":252,"y":3650,"z":"13ea1295.46163d","wires":[[]]},{"id":"4d6a5928.9b39e8","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":438,"y":687,"z":"13ea1295.46163d","wires":[["52e459e3.cc48b8"]]},{"id":"cf606a1a.2b6be8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":567,"y":622,"z":"13ea1295.46163d","wires":[["bd9f687e.c01fc8","2f9dfd0.57c5b04"]]},{"id":"bd9f687e.c01fc8","type":"set","name":"set path-type COMPOSITE","xml":"<set>\n<parameter name=\"path-type\" value= \"COMPOSITE\"/>","comments":"","x":762,"y":587,"z":"13ea1295.46163d","wires":[]},{"id":"2f9dfd0.57c5b04","type":"GenericXML","name":"record","xml":"<record  plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: input vnf-ids_length is blank, this is a COMPOSITE path\"/>","comments":"","outputs":1,"x":698,"y":641,"z":"13ea1295.46163d","wires":[[]]},{"id":"3f5b8bf5.fb4eb4","type":"returnSuccess","name":"return success","xml":"<return status='success'>","comments":"","x":214,"y":3703,"z":"13ea1295.46163d","wires":[]},{"id":"19cff64d.9e764a","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":655,"y":371,"z":"13ea1295.46163d","wires":[["e84a6720.65d5f8","2146f88b.5fab68"]]},{"id":"5fe8c913.e7db68","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":660,"y":457,"z":"13ea1295.46163d","wires":[["8e58421f.d9382","8228ea75.c55708"]]},{"id":"f22ed2ac.cf7d4","type":"set","name":"set outputs","xml":"<set>\n<parameter name=\"serv-inst.service-instance-id\" value= \"`$serv-inst.service-instance-id`\"/>\n<parameter name=\"serv-inst.vnf-list_length\" value= \"`$vnfListIndex`\"/>","comments":"","x":197,"y":3545,"z":"13ea1295.46163d","wires":[]},{"id":"fd97e171.58aa","type":"switchNode","name":"switch path-type","xml":"<switch test='`$path-type`'>\n","comments":"","outputs":1,"x":226,"y":833,"z":"13ea1295.46163d","wires":[["f27f4e54.99621","c68b280e.127728"]]},{"id":"f27f4e54.99621","type":"other","name":"SIMPLE","xml":"<outcome value='SIMPLE'>\n","comments":"","outputs":1,"x":388,"y":799,"z":"13ea1295.46163d","wires":[["7c6f9037.e4eeb"]]},{"id":"7c6f9037.e4eeb","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":416,"y":847,"z":"13ea1295.46163d","wires":[["ce28ec71.903b2","d3b27ea5.54dc1","839b28.f8b8b4d8","ccb84430.71e918","30f0e2b3.100a5e","cbe26532.112ec8","f4d41db.52befe"]]},{"id":"c68b280e.127728","type":"other","name":"COMPOSITE","xml":"<outcome value='COMPOSITE'>\n","comments":"","outputs":1,"x":359,"y":2429,"z":"13ea1295.46163d","wires":[["b6c1194d.fd2498"]]},{"id":"b6c1194d.fd2498","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":387,"y":2474,"z":"13ea1295.46163d","wires":[["e3148b0a.ca8e38","9edbc24f.7c9ff","223f61e8.f562be"]]},{"id":"2e158271.5031ee","type":"comment","name":"Get vf-module-ids from AAI using custom query vnfs-fromServiceInstance (aai-complex-service-1020)","info":"","comments":"","x":832,"y":800,"z":"13ea1295.46163d","wires":[]},{"id":"ce28ec71.903b2","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: Call AAI custom query vfModule-fromServiceInstance to get vf-module-ids\"/>","comments":"","outputs":1,"x":549,"y":891,"z":"13ea1295.46163d","wires":[[]]},{"id":"d3b27ea5.54dc1","type":"save","name":"AAI custom query: get vf-module-ids","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n      resource=\"custom-query\"\n      key=\"format = 'resource'\"\n      force=\"true\"\n      local-only=\"false\"\n      pfx=\"tmp.AnAI-data.vf-module-ids\">\n<parameter name=\"start[0]\" value=\"`'/nodes/service-instances/service-instance?service-instance-id=' + $serv-inst.service-instance-id `\" />\n<!--<parameter name=\"start[0]\" value=\"`'/business/customers/customer/bgb-customer/service-subscriptions/service-subscription/bgb-service-type/service-instances' `\" />-->\n<!--<parameter name=\"start[0]\" value=\"`'/business/customers/customer/la-customer/service-subscriptions/service-subscription/la-service-type/service-instances' `\" />-->\n<parameter name=\"start_length\" value=\"1\" />\n<parameter name=\"query\" value=\"/query/vfModule-fromServiceInstance\" />\n<!--<parameter name=\"query\" value=\"/query/vnfs-fromServiceInstance\" /> -->","comments":"","outputs":1,"x":642,"y":942,"z":"13ea1295.46163d","wires":[["e082040c.6d4908","5c4292b1.11b9ec","9e260ec9.cf65b"]]},{"id":"e082040c.6d4908","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":877.2380867004395,"y":895.6664667129517,"z":"13ea1295.46163d","wires":[["e3c1e843.25a028"]]},{"id":"e3c1e843.25a028","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":1016.9524154663086,"y":895.3806056976318,"z":"13ea1295.46163d","wires":[["d997efa6.55434"]]},{"id":"d997efa6.55434","type":"configure","name":"set error-message","xml":"<set>\n<parameter name=\"error-message\" value=\"Failed call to AAI custom query: vfModule-fromServiceInstance\" />\n<parameter name=\"serv-inst.api\" value= \"\"/>\n<parameter name='tmp.vf-module-ids_length' value='0' />\n<parameter name='tmp.vnf-instances_length' value='0' />\n","comments":"","outputs":1,"x":1197.52392578125,"y":895.0949096679688,"z":"13ea1295.46163d","wires":[[]]},{"id":"5c4292b1.11b9ec","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":878.3809814453125,"y":941.3806762695312,"z":"13ea1295.46163d","wires":[["c08b2b88.a84a68"]]},{"id":"c08b2b88.a84a68","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":1020.666690826416,"y":941.9521732330322,"z":"13ea1295.46163d","wires":[["3734ee52.190de2"]]},{"id":"3734ee52.190de2","type":"configure","name":"set error-message","xml":"<set>\n<parameter name=\"error-message\" value=\"No vfModules returned from AAI: vfModule-fromService-instance\" />\n<parameter name=\"serv-inst.api\" value= \"\"/>\n","comments":"","outputs":1,"x":1196.2381591796875,"y":941.66650390625,"z":"13ea1295.46163d","wires":[[]]},{"id":"9e260ec9.cf65b","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":879.6190592447915,"y":985.904560724894,"z":"13ea1295.46163d","wires":[["5f4d6161.d1d83"]]},{"id":"2e29cfe9.5fb8d","type":"set","name":"set tmp.vf-module-ids","xml":"<set>\n<parameter name=\"`'tmp.vf-module-ids[' + $vfModuleResultIndex + ']'`\" value='`$tmp.AnAI-data.vf-module-ids.results[$vfModuleResultIndex].vf-module.vf-module-id`' />","comments":"","x":1462.952392578125,"y":986.2379150390625,"z":"13ea1295.46163d","wires":[]},{"id":"298f95cb.b9d00a","type":"execute","name":"execute RestApiCallNode - get vnf info from MDSAL","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.vnf-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"vnf-mdsal\" />\n\n","comments":"","outputs":1,"x":730,"y":1276,"z":"13ea1295.46163d","wires":[["8dbbf79d.f608f8","7547ae1e.fdfd8","47f0ddf8.60b2a4"]]},{"id":"8dbbf79d.f608f8","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1019.2958984375,"y":1297.2840576171875,"z":"13ea1295.46163d","wires":[["d45a77f7.e93578"]]},{"id":"7547ae1e.fdfd8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1016.4285278320312,"y":1203.333251953125,"z":"13ea1295.46163d","wires":[["6eaa31f.30034d"]]},{"id":"d45a77f7.e93578","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1171.1427612304688,"y":1296.6666345596313,"z":"13ea1295.46163d","wires":[["3b707d7e.5db1d2","3acd5d10.4693f2","8a75505d.5e275","c9f071fb.6503e","4a6aa86e.0c6ee8"]]},{"id":"47f0ddf8.60b2a4","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1023.3332977294922,"y":1246.666660308838,"z":"13ea1295.46163d","wires":[["3c63c905.5585c6"]]},{"id":"6eaa31f.30034d","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":1171.999984741211,"y":1203.3333263397217,"z":"13ea1295.46163d","wires":[["dc6dd3bd.e9878"]]},{"id":"3c63c905.5585c6","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":1170.333236694336,"y":1246.9999828338623,"z":"13ea1295.46163d","wires":[["d8e6fd9b.a0476"]]},{"id":"dc6dd3bd.e9878","type":"configure","name":"set error-message","xml":"<set>\n<parameter name=\"error-message\" value=\"Failed to read vnf info from MD-SAL\" />\n<parameter name=\"serv-inst.api\" value= \"\"/>\n<parameter name=\"tmp.mdsal-error-encountered\" value= \"true\"/>\n","comments":"","outputs":1,"x":1362,"y":1202.6666259765625,"z":"13ea1295.46163d","wires":[[]]},{"id":"d8e6fd9b.a0476","type":"configure","name":"set error-message","xml":"<set>\n<parameter name=\"error-message\" value=\"Cannot find vnf info in MD-SAL\" />\n<parameter name=\"serv-inst.api\" value= \"\"/>\n<parameter name=\"tmp.mdsal-error-encountered\" value= \"true\"/>\n","comments":"","outputs":1,"x":1358.6666107177734,"y":1246.6666107177734,"z":"13ea1295.46163d","wires":[[]]},{"id":"66b278a1.60b278","type":"comment","name":"vf-module-ids in AAI = vnf-ids in VNF-API","info":"","comments":"","x":652,"y":1018,"z":"13ea1295.46163d","wires":[]},{"id":"ff48aed9.45e91","type":"comment","name":"For each vf-module-id returned from AAI, get vnf-request-information and vnf-topology-information from MDSAL (correlation-simple-service-1050)","info":"","comments":"","x":971,"y":1063,"z":"13ea1295.46163d","wires":[]},{"id":"aecdddc8.b3b0c","type":"execute","name":"execute readProperties","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n","comments":"","outputs":1,"x":249,"y":204,"z":"13ea1295.46163d","wires":[["1a85095b.106d37","83c24e54.cc2ec"]]},{"id":"1a85095b.106d37","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":448,"y":183,"z":"13ea1295.46163d","wires":[["24badd74.50bb32"]]},{"id":"83c24e54.cc2ec","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":446,"y":224,"z":"13ea1295.46163d","wires":[["be153b36.98ee58"]]},{"id":"be153b36.98ee58","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":583,"y":224,"z":"13ea1295.46163d","wires":[["29d5441f.3724bc","6ab4c663.88b828"]]},{"id":"29d5441f.3724bc","type":"GenericXML","name":"record","xml":"<record  plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: Could not read properties file.\"/>\n<parameter name=\"field3\" value='`$prop.restapi.pm.getpolicy.templatefile`'/>","comments":"","outputs":1,"x":714,"y":224,"z":"13ea1295.46163d","wires":[[]]},{"id":"24badd74.50bb32","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":584,"y":183,"z":"13ea1295.46163d","wires":[["dafe4463.f562a8"]]},{"id":"4ff24ed7.c425c","type":"comment","name":"Read properties","info":"","comments":"","x":224,"y":157,"z":"13ea1295.46163d","wires":[]},{"id":"dafe4463.f562a8","type":"GenericXML","name":"record","xml":"<record  plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: read properties file.\"/>","comments":"","outputs":1,"x":715,"y":183,"z":"13ea1295.46163d","wires":[[]]},{"id":"839b28.f8b8b4d8","type":"for","name":"for each vf-module-id","xml":"<for index='vfModuleIndex' start='0' end='`$tmp.vf-module-ids_length`' >\n","comments":"","outputs":1,"x":591,"y":1149,"z":"13ea1295.46163d","wires":[["b1bdd8d2.bfdca8"]]},{"id":"2315cfff.9ba5d","type":"configure","name":"set vnf-url","xml":"<set>\n<parameter name=\"tmp.vnf-url\" value=\"`'/restconf/config/VNF-API:vnfs/vnf-list/' + $tmp.vf-module-ids[$vfModuleIndex]`\" />\n","comments":"","outputs":1,"x":601,"y":1235,"z":"13ea1295.46163d","wires":[[]]},{"id":"b1bdd8d2.bfdca8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":594,"y":1188,"z":"13ea1295.46163d","wires":[["2315cfff.9ba5d","298f95cb.b9d00a"]]},{"id":"a3612e1f.f6e3c","type":"set","name":"set tmp.vf-module-ids * TEST-ONLY *","xml":"<set>\n<!--<parameter name='tmp.vf-module-ids' value='`$tmp.AnAI-data.vf-module-ids.results[0]`' />\n<parameter name=\"error-message\" value=\"AAI custom query: vfModule-fromServiceInstance yielded no data found\" />-->\n<parameter name='tmp.vf-module-ids_length' value='5' />\n<parameter name='tmp.vf-module-ids[0]' value='vf-module-id-1' />\n<parameter name='tmp.vf-module-ids[1]' value='vf-module-id-2' />\n<parameter name='tmp.vf-module-ids[2]' value='vf-module-id-3' />\n<parameter name='tmp.vf-module-ids[3]' value='vf-module-id-4' />\n<parameter name='tmp.vf-module-ids[4]' value='vf-module-id-5' />\n<!--<parameter name='tmp.vf-module-ids[5]' value='vf-module-id-not-in-mdsal' />-->\n<parameter name='tmp.vnf-instances_length' value='5' />","comments":"","x":1512,"y":896,"z":"13ea1295.46163d","wires":[]},{"id":"3b707d7e.5db1d2","type":"configure","name":"set vnf-instances entry","xml":"<set>\n<parameter name=\"`'tmp.vnf-instances[' + $tmp.vnfInstancesIndex + ']'`.\" value= '`$vnf-mdsal.vnf-list[0].`' />\n<parameter name=\"genericVnfIdFound\" value= 'false' />","comments":"","outputs":1,"x":759,"y":1335,"z":"13ea1295.46163d","wires":[[]]},{"id":"30f0e2b3.100a5e","type":"for","name":"for each input vnf-ids","xml":"<for index='vnfIdIndex' start='0' end='`$vnf-ids_length`' >\n","comments":"","outputs":1,"x":579,"y":1876,"z":"13ea1295.46163d","wires":[["bf9cd966.df87b8"]]},{"id":"bf9cd966.df87b8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":587,"y":1915,"z":"13ea1295.46163d","wires":[["eb7c4606.b94158"]]},{"id":"18c296f0.f609b9","type":"comment","name":"For each  input vnf-ids  find match on triplet-list.model-customization-id and add to output.vnf-list","info":"Preserve the order of input vnf-ids for output vf-module-list","comments":"","x":1032,"y":1877,"z":"13ea1295.46163d","wires":[]},{"id":"4df533f1.abe1ac","type":"switchNode","name":"switch tmp.vnf-instances...vnf-id == triplet-list.vf-module-id","xml":"<switch test='`$tmp.vnf-instances[$vnfInstanceIndex].service-data.vnf-request-information.vnf-id == $tmp.triplet-list[$tmp.tripletListIndex].vf-module-id`'>\n","comments":"","outputs":1,"x":1548,"y":2094,"z":"13ea1295.46163d","wires":[["552bbcfa.05b014","4e1ec540.09ad0c"]]},{"id":"24e48058.7c71","type":"for","name":"for each vnf-instances","xml":"<for index='vnfInstanceIndex' start='0' end='`$tmp.vnf-instances_length`' >\n","comments":"","outputs":1,"x":1403,"y":2006,"z":"13ea1295.46163d","wires":[["ca71b6dd.e84f48"]]},{"id":"552bbcfa.05b014","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1834,"y":2025,"z":"13ea1295.46163d","wires":[["58caa0ea.b51b9"]]},{"id":"4e1ec540.09ad0c","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1835,"y":2088,"z":"13ea1295.46163d","wires":[[]]},{"id":"efef540e.1cc898","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: MATCH for vnf-instances.vnf-id and triplet-list.vf-module-id: \"/>\n<parameter name=\"field3\" value='`$tmp.triplet-list[$tmp.tripletListIndex].vf-module-id`'/>","comments":"","outputs":1,"x":2089,"y":2026,"z":"13ea1295.46163d","wires":[[]]},{"id":"4a6aa86e.0c6ee8","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: MDSAL vnf-instances vnf-id|generic-vnf-id: \"/>\n<parameter name=\"field3\" value='`$tmp.vnf-instances[$tmp.vnfInstancesIndex].service-data.vnf-request-information.vnf-id`' />\n<parameter name=\"field4\" value='`$tmp.vnf-instances[$tmp.vnfInstancesIndex].service-data.vnf-request-information.generic-vnf-id`' />","comments":"","outputs":1,"x":1017,"y":1336,"z":"13ea1295.46163d","wires":[[]]},{"id":"ca71b6dd.e84f48","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1395,"y":2049,"z":"13ea1295.46163d","wires":[["ad57ec62.5f55b","4df533f1.abe1ac"]]},{"id":"ad57ec62.5f55b","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: vnfIdIndex:id | vnfInstanceIndex:id | : \"/>\n<parameter name=\"field3\" value='`$vnfIdIndex`'/>\n<parameter name=\"field4\" value='`$vnf-ids[$vnfIdIndex]`'/>\n<parameter name=\"field5\" value='`$vnfInstanceIndex`'/>\n<parameter name=\"field6\" value='`$tmp.vnf-instances[$vnfInstanceIndex].service-data.vnf-request-information.vnf-id`'/>","comments":"","outputs":1,"x":1524,"y":2049,"z":"13ea1295.46163d","wires":[[]]},{"id":"58caa0ea.b51b9","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1961,"y":2025,"z":"13ea1295.46163d","wires":[["efef540e.1cc898","cd48dddf.0bfc5","e17a07e5.5d80a8","bfb01e4d.428b5"]]},{"id":"a17a3bfc.c25d68","type":"configure","name":"set output serv-inst.vnf-list.vnf-network-list data","xml":"<set>\n<parameter name=\"serv-inst.vnf-list[$vnfListIndex].vnf-network-list[$vnfNetworksIndex].network-name\" value= \"`$tmp.vnf-instances[$vnfInstanceIndex].service-data.vnf-topology-information.vnf-assignments.vnf-networks[$vnfNetworksIndex].network-name`\"/>\n<parameter name=\"serv-inst.vnf-list[$vnfListIndex].vnf-network-list[$vnfNetworksIndex].network-role\" value= \"`$tmp.vnf-instances[$vnfInstanceIndex].service-data.vnf-topology-information.vnf-assignments.vnf-networks[$vnfNetworksIndex].network-role`\"/>\n<parameter name=\"serv-inst.vnf-list[$vnfListIndex].vnf-network-list[$vnfNetworksIndex].vf-module-id\" value= \"`$tmp.vnf-instances[$vnfInstanceIndex].service-data.vnf-request-information.vnf-id`\"/>\n<parameter name=\"serv-inst.vnf-list[$vnfListIndex].vnf-network-list_length\" value= '`$vnfNetworksIndex + 1`'/>","comments":"","outputs":1,"x":2510,"y":2254,"z":"13ea1295.46163d","wires":[[]]},{"id":"4d9d23f1.73fdcc","type":"comment","name":"For each  vnf-networks in service-data.vnf-topology-information.vnf-assignments from MDSAL","info":"","comments":"","x":2348,"y":2081,"z":"13ea1295.46163d","wires":[]},{"id":"1d16c8d7.f918d7","type":"for","name":"for each vnf-networks","xml":"<for index='vnfNetworksIndex' start='0' end='`$tmp.vnf-instances[$vnfInstanceIndex].service-data.vnf-topology-information.vnf-assignments.vnf-networks_length`' >","comments":"","outputs":1,"x":2387,"y":2136,"z":"13ea1295.46163d","wires":[["645a1c52.50ce74"]]},{"id":"645a1c52.50ce74","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2386,"y":2177,"z":"13ea1295.46163d","wires":[["df93772e.0015b8","a17a3bfc.c25d68"]]},{"id":"df93772e.0015b8","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: MATCH for vnf-id and vnf-instances for vnf-id: \"/>\n<parameter name=\"field3\" value='`$vnf-ids[$vnfIdIndex]`'/>\n<parameter name=\"field4\" value='`$tmp.vnf-instances[$vnfInstanceIndex].service-data.vnf-topology-information.vnf-assignments.vnf-networks[$vnfnetworksIndex].`'/>","comments":"","outputs":1,"x":2388,"y":2217,"z":"13ea1295.46163d","wires":[[]]},{"id":"9a17f638.85fd98","type":"comment","name":"Don't return failure on error cases, only set error message for calling DG","info":"","comments":"","x":1041,"y":325,"z":"13ea1295.46163d","wires":[]},{"id":"de27074d.c737b8","type":"comment","name":"Get vf-module IDs from AAI using service-instance-id","info":"","comments":"","x":658,"y":2429,"z":"13ea1295.46163d","wires":[]},{"id":"135b7762.c5e859","type":"execute","name":"execute RestApiCallNode - get vnf info","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.vnf-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"vnf-mdsal\" />\n\n","comments":"","outputs":1,"x":682,"y":2883,"z":"13ea1295.46163d","wires":[["753b2988.dfef28","99c14378.a3f9","f1f797d0.263348"]]},{"id":"753b2988.dfef28","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1042.2959594726562,"y":2929.283935546875,"z":"13ea1295.46163d","wires":[["b25832e3.7436b"]]},{"id":"99c14378.a3f9","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1036.4285278320312,"y":2841.333251953125,"z":"13ea1295.46163d","wires":[["76686649.41d148"]]},{"id":"b25832e3.7436b","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1196.142822265625,"y":2928.66650390625,"z":"13ea1295.46163d","wires":[["5b7d3312.5bcb0c","7a1e825e.b258bc"]]},{"id":"f1f797d0.263348","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1043.3332977294922,"y":2884.666660308838,"z":"13ea1295.46163d","wires":[["3cc2434b.c5d82c"]]},{"id":"76686649.41d148","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1214.999984741211,"y":2841.3333263397217,"z":"13ea1295.46163d","wires":[["17e2e25d.a6f52e"]]},{"id":"3cc2434b.c5d82c","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1213.333236694336,"y":2884.9999828338623,"z":"13ea1295.46163d","wires":[["3795156.dcfd4ea"]]},{"id":"17e2e25d.a6f52e","type":"configure","name":"set error-message","xml":"<set>\n<parameter name=\"error-message\" value=\"Failed to read vnf info from MD-SAL\" />\n<parameter name=\"serv-inst.api\" value= \"\"/>\n","comments":"","outputs":1,"x":1418.999984741211,"y":2840.666732788086,"z":"13ea1295.46163d","wires":[[]]},{"id":"3795156.dcfd4ea","type":"configure","name":"set error-message","xml":"<set>\n<parameter name=\"error-message\" value=\"Cannot find vnf info in MD-SAL\" />\n<parameter name=\"serv-inst.api\" value= \"\"/>\n","comments":"","outputs":1,"x":1416.6666107177734,"y":2884.6666107177734,"z":"13ea1295.46163d","wires":[[]]},{"id":"53e54934.536148","type":"comment","name":"vf-module-ids in AAI = vnf-ids in VNF-API","info":"","comments":"","x":620,"y":2649,"z":"13ea1295.46163d","wires":[]},{"id":"d34738ff.ce94d8","type":"comment","name":"For only the FIRST vf-module-id returned from AAI, get vnf-request-information and vnf-topology-information from MDSAL","info":"","comments":"","x":871,"y":2688,"z":"13ea1295.46163d","wires":[]},{"id":"b1f6e8e0.9913d8","type":"configure","name":"set vnf-url","xml":"<set>\n<parameter name=\"tmp.vnf-url\" value=\"`'/restconf/config/VNF-API:vnfs/vnf-list/' + $tmp.vf-module-ids[0]`\" />\n","comments":"","outputs":1,"x":784,"y":2731,"z":"13ea1295.46163d","wires":[[]]},{"id":"5b7d3312.5bcb0c","type":"configure","name":"set vnf-instances entry","xml":"<set>\n<parameter name=\"`'tmp.vnf-instances[0]'`.\" value= '`$vnf-mdsal.vnf-list[0].`' />","comments":"","outputs":1,"x":1429,"y":2929,"z":"13ea1295.46163d","wires":[[]]},{"id":"7a1e825e.b258bc","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: MDSAL vnf-instances vnf-id: \"/>\n<parameter name=\"field3\" value='`$tmp.vnf-instances[0].service-data.vnf-request-information.vnf-id`' />","comments":"","outputs":1,"x":1382,"y":2974,"z":"13ea1295.46163d","wires":[[]]},{"id":"375897b0.e3b0d8","type":"configure","name":"set output serv-inst.vnf-list data","xml":"<set>\n<parameter name=\"serv-inst.vnf-list[$vnfListIndex].vnf-network-list[$vnfNetworksIndex].network-name\" value= \"`$tmp.vnf-instances[0].service-data.vnf-topology-information.vnf-assignments.vnf-networks[$vnfNetworksIndex].network-name`\"/>\n<parameter name=\"serv-inst.vnf-list[$vnfListIndex].vnf-network-list[$vnfNetworksIndex].network-role\" value= \"`$tmp.vnf-instances[0].service-data.vnf-topology-information.vnf-assignments.vnf-networks[$vnfNetworksIndex].network-role`\"/>\n<parameter name=\"serv-inst.vnf-list[$vnfListIndex].vnf-network-list[$vnfNetworksIndex].vf-module-id\" value= \"`$tmp.vnf-instances[0].service-data.vnf-request-information.vnf-id`\"/>\n<parameter name=\"serv-inst.vnf-list[$vnfListIndex].vnf-network-list_length\" value= '`$vnfNetworksIndex + 1`'/>","comments":"","outputs":1,"x":1310,"y":3172,"z":"13ea1295.46163d","wires":[[]]},{"id":"768bcf6c.1de2e","type":"comment","name":"For each  vnf-networks in service-data.vnf-topology-information.vnf-assignments from MDSAL","info":"","comments":"","x":844,"y":2989,"z":"13ea1295.46163d","wires":[]},{"id":"a36f6533.d1b958","type":"for","name":"for each vnf-networks","xml":"<for index='vnfNetworksIndex' start='0' end='`$tmp.vnf-instances[0].service-data.vnf-topology-information.vnf-assignments.vnf-networks_length`' >","comments":"","outputs":1,"x":1232,"y":3038,"z":"13ea1295.46163d","wires":[["dbf6a49f.116a88"]]},{"id":"dbf6a49f.116a88","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1231,"y":3085,"z":"13ea1295.46163d","wires":[["97414ac7.a86b08","375897b0.e3b0d8"]]},{"id":"97414ac7.a86b08","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: copy vnf-instance data to output: \"/>\n<parameter name=\"field3\" value='`$tmp.vnf-instances[0].service-data.vnf-topology-information.vnf-assignments.vnf-networks[$vnfnetworksIndex].`'/>","comments":"","outputs":1,"x":1233,"y":3128,"z":"13ea1295.46163d","wires":[[]]},{"id":"746c2073.80207","type":"comment","name":"MATCH for vnf-instances.vnf-id and tripliet-list.vf-module-id","info":"","comments":"","x":1986,"y":1978,"z":"13ea1295.46163d","wires":[]},{"id":"cd48dddf.0bfc5","type":"configure","name":"set serv-inst.vnf-list[$vnfListIndex].vnf-id","xml":"<set>\n<parameter name=\"serv-inst.vnf-list[$vnfListIndex].vnf-id\" value= \"`$tmp.triplet-list[$tmp.tripletListIndex].generic-vnf-id`\"/>","comments":"","outputs":1,"x":2181,"y":2371,"z":"13ea1295.46163d","wires":[[]]},{"id":"73374c07.1b3084","type":"set","name":"initialize output serv-inst.api to NULL, set to VNF on success","xml":"<set>\n<parameter name=\"serv-inst.api\" value= \"\"/>","comments":"","x":597,"y":95,"z":"13ea1295.46163d","wires":[]},{"id":"6ab4c663.88b828","type":"set","name":"Set error-message","xml":"<set>\n<parameter name=\"serv-inst.api\" value= \"\"/>\n<parameter name=\"error-message\" value=\"Could not read properties file\" />","comments":"","x":751,"y":265,"z":"13ea1295.46163d","wires":[]},{"id":"2146f88b.5fab68","type":"set","name":"Set error-message","xml":"<set>\n<parameter name=\"serv-inst.api\" value= \"\"/>\n<parameter name=\"error-message\" value=\"serv-inst.service-instance-id is not set\" />","comments":"","x":819,"y":412,"z":"13ea1295.46163d","wires":[]},{"id":"8228ea75.c55708","type":"set","name":"Set error-message","xml":"<set>\n<parameter name=\"serv-inst.api\" value= \"\"/>\n<parameter name=\"error-message\" value=\"input match-type is not set\" />","comments":"","x":827,"y":503,"z":"13ea1295.46163d","wires":[]},{"id":"e3148b0a.ca8e38","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: Call AAI custom query vfModule-fromServiceInstance to get vf-module-ids\"/>","comments":"","outputs":1,"x":528,"y":2521,"z":"13ea1295.46163d","wires":[[]]},{"id":"77ecc850.cc3808","type":"configure","name":"set vnfListIndex to 1","xml":"<set>\n<parameter name=\"vnfListIndex\" value= \"1\"/>","comments":"","outputs":1,"x":656,"y":3214,"z":"13ea1295.46163d","wires":[[]]},{"id":"6a0cc06e.d6de8","type":"configure","name":"set output serv-inst.vnf-list[$vnfListIndex].vnf-id to service-data.vnf-request-information.generic-vnf-id","xml":"<set>\n<parameter name=\"serv-inst.vnf-list[$vnfListIndex].vnf-id\" value= \"`$vnf-mdsal.vnf-list[0].service-data.vnf-request-information.generic-vnf-id`\"/>","comments":"","outputs":1,"x":872,"y":3278,"z":"13ea1295.46163d","wires":[[]]},{"id":"e17a07e5.5d80a8","type":"configure","name":"increment vnfListIndex and set serv-inst.vnf-list[$vnfListIndex].vnf-id","xml":"<set>\n<parameter name=\"vnfListIndex\" value= '`$vnfListIndex + 1`'/>","comments":"","outputs":1,"x":2265,"y":2418,"z":"13ea1295.46163d","wires":[[]]},{"id":"6aac23f6.7f905c","type":"comment","name":"check for vnf-instances_length is null?","info":"","comments":"","x":1641,"y":1940,"z":"13ea1295.46163d","wires":[]},{"id":"1b271514.dafa0b","type":"switchNode","name":"switch - check for networks on this vf-module","xml":"<switch test='`$tmp.vnf-instances[0].service-data.vnf-topology-information.vnf-assignments.vnf-networks_length > 0`'>","comments":"","outputs":1,"x":704,"y":3043,"z":"13ea1295.46163d","wires":[["d1a68e34.a4ab2","8855592b.6b2398"]]},{"id":"d1a68e34.a4ab2","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1059,"y":3038,"z":"13ea1295.46163d","wires":[["a36f6533.d1b958"]]},{"id":"3e84d391.f3809c","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: No vnf-networks found for vnf-id: \"/>\n<parameter name=\"field3\" value='`$tmp.vnf-instances[0].service-data.vnf-request-information.vnf-id`' />","comments":"","outputs":1,"x":1054,"y":3168,"z":"13ea1295.46163d","wires":[[]]},{"id":"bfb01e4d.428b5","type":"switchNode","name":"switch","xml":"<switch test='`$tmp.vnf-instances[$vnfInstanceIndex].service-data.vnf-topology-information.vnf-assignments.vnf-networks_length > 0`'>","comments":"","outputs":1,"x":2082,"y":2136,"z":"13ea1295.46163d","wires":[["ae827f9e.9c43e","ae2d5283.d1e13"]]},{"id":"ae827f9e.9c43e","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2211,"y":2136,"z":"13ea1295.46163d","wires":[["1d16c8d7.f918d7"]]},{"id":"ae2d5283.d1e13","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":2211,"y":2176,"z":"13ea1295.46163d","wires":[["465fccd7.347e54"]]},{"id":"682293ae.eb62dc","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: No vnf-networks found for vnf-id: \"/>\n<parameter name=\"field3\" value='`$tmp.vnf-instances[$vnfInstanceIndex].service-data.vnf-request-information.vnf-id`' />","comments":"","outputs":1,"x":2214,"y":2256,"z":"13ea1295.46163d","wires":[[]]},{"id":"465fccd7.347e54","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2213,"y":2216,"z":"13ea1295.46163d","wires":[["682293ae.eb62dc","e19e0e13.0e404"]]},{"id":"e19e0e13.0e404","type":"configure","name":"set vnf-networks-list_length to 0","xml":"<set>\n<parameter name='`tmp.vnf-instances[$vnfInstanceIndex].service-data.vnf-topology-information.vnf-assignments.vnf-networks_length' value=\"0\" />\n","comments":"","outputs":1,"x":2291,"y":2297,"z":"13ea1295.46163d","wires":[[]]},{"id":"b5aa567b.b40f18","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1058,"y":3123,"z":"13ea1295.46163d","wires":[["c5205e75.d54a2","3e84d391.f3809c"]]},{"id":"c5205e75.d54a2","type":"configure","name":"set vnf-networks-list_length to 0","xml":"<set>\n<parameter name='`tmp.vnf-instances[0].service-data.vnf-topology-information.vnf-assignments.vnf-networks_length' value=\"0\" />\n","comments":"","outputs":1,"x":1134,"y":3213,"z":"13ea1295.46163d","wires":[[]]},{"id":"8855592b.6b2398","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1056,"y":3083,"z":"13ea1295.46163d","wires":[["b5aa567b.b40f18"]]},{"id":"cba2b409.58b7e8","type":"configure","name":"set triplet-list entry","xml":"<set>\n<parameter name=\"`'tmp.triplet-list[' + $tmp.tripletListIndex + '].generic-vnf-id'`\" value= '`$vnf-mdsal.vnf-list[0].service-data.vnf-request-information.generic-vnf-id`' />\n<parameter name=\"`'tmp.triplet-list[' + $tmp.tripletListIndex + '].vf-module-id'`\" value= '`$tmp.vf-module-ids[$vfModuleIndex]`' />\n<parameter name=\"tmp.triplet-list_length\" value= '`$tmp.triplet-list_length + 1`'/>\n<parameter name=\"tmp.tripletListIndex\" value= '`$tmp.tripletListIndex + 1`'/>","comments":"","outputs":1,"x":1575,"y":1472,"z":"13ea1295.46163d","wires":[[]]},{"id":"70e218a1.775218","type":"comment","name":"Put unique generic-vnf-ids in triplet-list","info":"","comments":"","x":802,"y":1377,"z":"13ea1295.46163d","wires":[]},{"id":"ccb84430.71e918","type":"configure","name":"initialize triplet-list_length, tripletListIndex, vnf-instances_length, vnfInstancesIndex","xml":"<set>\n<parameter name=\"tmp.triplet-list_length\" value= \"0\" />\n<parameter name=\"tmp.tripletListIndex\" value= \"0\" />\n<parameter name=\"tmp.vnf-instances_length\" value= \"0\" />\n<parameter name=\"tmp.vnfInstancesIndex\" value= \"0\" />\n<parameter name=\"tmp.mdsal-error-encountered\" value= \"false\"/>","comments":"","outputs":1,"x":779,"y":1106,"z":"13ea1295.46163d","wires":[[]]},{"id":"61ac05e6.c7c46c","type":"switchNode","name":"switch triplet-list.generic-vnf-id == tmp.vnf-instances...generic-vnf-id","xml":"<switch test='`$tmp.triplet-list[$tmp.tripletListIndex2].generic-vnf-id == $tmp.vnf-instances[$tmp.vnfInstancesIndex].service-data.vnf-request-information.generic-vnf-id`'>","comments":"","outputs":1,"x":1100,"y":1424,"z":"13ea1295.46163d","wires":[["9637658b.18c518","dbeec32.fac504"]]},{"id":"3acd5d10.4693f2","type":"for","name":"for each triplet-list","xml":"<for index='tmp.tripletListIndex2' start='0' end='`$tmp.triplet-list_length`' >\n","comments":"","outputs":1,"x":752,"y":1424,"z":"13ea1295.46163d","wires":[["61ac05e6.c7c46c"]]},{"id":"9637658b.18c518","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1412,"y":1424,"z":"13ea1295.46163d","wires":[["304ff5ef.83e86a"]]},{"id":"304ff5ef.83e86a","type":"configure","name":"set genericVnfIdFound to true","xml":"<set>\n<parameter name=\"genericVnfIdFound\" value= 'true' />","comments":"","outputs":1,"x":1613,"y":1424,"z":"13ea1295.46163d","wires":[[]]},{"id":"8a75505d.5e275","type":"switchNode","name":"if generic-vnf-id is not found, add it to the triplet-list","xml":"<switch test='`$genericVnfIdFound`'>","comments":"","outputs":1,"x":850,"y":1472,"z":"13ea1295.46163d","wires":[["3b4269a.ed66a96","79dde64e.97dd98"]]},{"id":"3b4269a.ed66a96","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1122,"y":1472,"z":"13ea1295.46163d","wires":[["f82770da.fca6d"]]},{"id":"e824e92f.414b48","type":"comment","name":"for each unique generic-vnf-id get model-customization-id from AAI (aai-composite-service-1030)","info":"","comments":"","x":812,"y":1612,"z":"13ea1295.46163d","wires":[]},{"id":"6c6e891c.dbd4c8","type":"get-resource","name":"get-resource generic-vnf from AAI","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"generic-vnf\"\n        key=\"generic-vnf.vnf-id = $tmp.triplet-list[$tmp.tripletListIndex].generic-vnf-id\"\n        pfx='aai.generic-vnf' local-only='false' >","comments":"","outputs":1,"x":1180.4666137695312,"y":1737.999755859375,"z":"13ea1295.46163d","wires":[["f04edd7e.e23b6","cd278dcc.c2019","1bb880d7.a21fdf"]]},{"id":"1bb880d7.a21fdf","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1408.8369750976562,"y":1698.03662109375,"z":"13ea1295.46163d","wires":[["52d0213a.4be84"]]},{"id":"f04edd7e.e23b6","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1412.3279418945312,"y":1739.61083984375,"z":"13ea1295.46163d","wires":[["79cc9835.c09578"]]},{"id":"cd278dcc.c2019","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1408.6609497070312,"y":1781.944091796875,"z":"13ea1295.46163d","wires":[["db4b07f7.81a198"]]},{"id":"95c1fb6f.8ce458","type":"for","name":"for each triplet-list","xml":"<for index='tmp.tripletListIndex' start='0' end='`$tmp.triplet-list_length`' >\n","comments":"","outputs":1,"x":1104,"y":1652,"z":"13ea1295.46163d","wires":[["8ed8396d.a616d8"]]},{"id":"8ed8396d.a616d8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1098,"y":1697,"z":"13ea1295.46163d","wires":[["6c6e891c.dbd4c8"]]},{"id":"381400.3e580c","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: Set model-customization-id for vf-module-id|generic-vnf-id: \"/>\n<parameter name=\"field3\" value='`$tmp.triplet-list[$tmp.tripletListIndex].vf-module-id`'/>\n<parameter name=\"field4\" value='`$tmp.triplet-list[$tmp.tripletListIndex].generic-vnf-id`'/>\n<parameter name=\"field5\" value='`$aai.generic-vnf.model-customization-id`'/>","comments":"","outputs":1,"x":1933,"y":1737,"z":"13ea1295.46163d","wires":[[]]},{"id":"e900810b.ad8dc","type":"configure","name":"set model-customization-id in triplet-list","xml":"<set>\n<parameter name=\"`'tmp.triplet-list[' + $tmp.tripletListIndex + '].model-customization-id'`\" value= '`$aai.generic-vnf.model-customization-id`' />","comments":"","outputs":1,"x":2039,"y":1784,"z":"13ea1295.46163d","wires":[[]]},{"id":"eb7c4606.b94158","type":"for","name":"for each triplet-list entry","xml":"<for index='tmp.tripletListIndex' start='0' end='`$tmp.triplet-list_length`' >\n","comments":"","outputs":1,"x":635,"y":1956,"z":"13ea1295.46163d","wires":[["9da49d50.75e35"]]},{"id":"9da49d50.75e35","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":627,"y":1998,"z":"13ea1295.46163d","wires":[["890ce2d0.5b40b","d2ac92ce.821b3"]]},{"id":"890ce2d0.5b40b","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: vnfIdIndex:id | tripletListIndex:model-customization-id | : \"/>\n<parameter name=\"field3\" value='`$vnfIdIndex`'/>\n<parameter name=\"field4\" value='`$vnf-ids[$vnfIdIndex]`'/>\n<parameter name=\"field5\" value='`$tmp.tripletListIndex`'/>\n<parameter name=\"field6\" value='`$tmp.triplet-list[$tmp.tripletListIndex].model-customization-id`'/>","comments":"","outputs":1,"x":757,"y":1998,"z":"13ea1295.46163d","wires":[[]]},{"id":"d2ac92ce.821b3","type":"switchNode","name":"switch input vnf-ids == tmp.triplet-list.model-customization-id","xml":"<switch test='`$vnf-ids[$vnfIdIndex] == $tmp.triplet-list[$tmp.tripletListIndex].model-customization-id`'>\n","comments":"","outputs":1,"x":801,"y":2038,"z":"13ea1295.46163d","wires":[["1cb90b9d.0e11f4","9cc55fa1.79208"]]},{"id":"1cb90b9d.0e11f4","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1104,"y":2006,"z":"13ea1295.46163d","wires":[["bb8ca97b.bc0b28"]]},{"id":"9cc55fa1.79208","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1105,"y":2069,"z":"13ea1295.46163d","wires":[[]]},{"id":"bb8ca97b.bc0b28","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1231,"y":2006,"z":"13ea1295.46163d","wires":[["24e48058.7c71","7829c9e3.21a538"]]},{"id":"e5c521c1.28bbc","type":"comment","name":"MATCH for input.vnf-id and triplet-list.model-customizaiton-id","info":"","comments":"","x":1271,"y":1962,"z":"13ea1295.46163d","wires":[]},{"id":"79cc9835.c09578","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: generic-vnf not found in AAI for generic-vnf-id: \"/>\n<parameter name=\"field4\" value='`$tmp.triplet-list[$tmp.tripletListIndex].generic-vnf-id`'/>","comments":"","outputs":1,"x":1545,"y":1740,"z":"13ea1295.46163d","wires":[[]]},{"id":"a7f70fe1.122d9","type":"configure","name":"initialize vnfListIndex to 0","xml":"<set>\n<parameter name=\"vnfListIndex\" value= \"0\"/>","comments":"","outputs":1,"x":246,"y":737,"z":"13ea1295.46163d","wires":[[]]},{"id":"52d0213a.4be84","type":"switchNode","name":"switch","xml":"<switch test='`$aai.generic-vnf.model-customization-id`'>","comments":"","outputs":1,"x":1546,"y":1698,"z":"13ea1295.46163d","wires":[["cf59adeb.87937","7a2c4466.a8136c"]]},{"id":"cf59adeb.87937","type":"other","name":"Blank","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":1683,"y":1699,"z":"13ea1295.46163d","wires":[["94c3e99.5c6af18"]]},{"id":"7ab1a203.dde39c","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: model-customization-id is BLANK for vf-module-id|generic-vnf-id: \"/>\n<parameter name=\"field3\" value='`$tmp.triplet-list[$tmp.tripletListIndex].vf-module-id`'/>\n<parameter name=\"field4\" value='`$tmp.triplet-list[$tmp.tripletListIndex].generic-vnf-id`'/>","comments":"","outputs":1,"x":1933,"y":1699,"z":"13ea1295.46163d","wires":[[]]},{"id":"7a2c4466.a8136c","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1685,"y":1736,"z":"13ea1295.46163d","wires":[["d338b448.935f88"]]},{"id":"d338b448.935f88","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1804,"y":1737,"z":"13ea1295.46163d","wires":[["381400.3e580c","e900810b.ad8dc"]]},{"id":"79dde64e.97dd98","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1120,"y":1514,"z":"13ea1295.46163d","wires":[["c46507d8.82beb8"]]},{"id":"56d7b2ac.773fdc","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: generic-vnf-id is already in triplet-list, don't add it\"/>","comments":"","outputs":1,"x":1412,"y":1514,"z":"13ea1295.46163d","wires":[[]]},{"id":"c46507d8.82beb8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1262,"y":1514,"z":"13ea1295.46163d","wires":[["56d7b2ac.773fdc"]]},{"id":"f82770da.fca6d","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1264,"y":1472,"z":"13ea1295.46163d","wires":[["604f4fcd.1f225","cba2b409.58b7e8"]]},{"id":"604f4fcd.1f225","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: generic-vnf-id in NOT found in triplet-list, add it\"/>","comments":"","outputs":1,"x":1411,"y":1474,"z":"13ea1295.46163d","wires":[[]]},{"id":"a665647f.954468","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":552,"y":1558,"z":"13ea1295.46163d","wires":[["d1da650.11e1998"]]},{"id":"d1da650.11e1998","type":"for","name":"for each triplet-list entry","xml":"<for index='tmp.tripletListIndex' start='0' end='`$tmp.triplet-list_length`' >\n","comments":"","outputs":1,"x":728,"y":1558,"z":"13ea1295.46163d","wires":[["a2d8b75a.7ab8c8"]]},{"id":"a2d8b75a.7ab8c8","type":"record","name":"PRINT triplet-list","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: PRINT triplet-list BEFORE AAI | vf-module-id:generic-vnf-id:model-customization-id | \"/>\n<parameter name=\"field3\" value='`$tmp.tripletListIndex`'/>\n<parameter name=\"field4\" value='`$tmp.triplet-list[$tmp.tripletListIndex].vf-module-id`'/>\n<parameter name=\"field5\" value='`$tmp.triplet-list[$tmp.tripletListIndex].generic-vnf-id`'/>\n<parameter name=\"field6\" value='`$tmp.triplet-list[$tmp.tripletListIndex].model-customization-id`'/>","comments":"","outputs":1,"x":939,"y":1558,"z":"13ea1295.46163d","wires":[[]]},{"id":"94c3e99.5c6af18","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1805,"y":1699,"z":"13ea1295.46163d","wires":[["7ab1a203.dde39c"]]},{"id":"d124590b.f69c68","type":"configure","name":"set model-customization-id in triplet-list  * TEST-ONLY *","xml":"<set>\n<parameter name=\"`'tmp.triplet-list[' + $tmp.tripletListIndex + '].model-customization-id'`\" value= \"`model-cusomization-uuid-$tmp.tripletListIndex`\" />","comments":"","outputs":1,"x":2209,"y":1699,"z":"13ea1295.46163d","wires":[[]]},{"id":"c9f071fb.6503e","type":"configure","name":"increment tmp.vnfInstancesIndex and tmp.vnf-instances_length","xml":"<set>\n<parameter name=\"tmp.vnfInstancesIndex\" value= '`$tmp.vnfInstancesIndex + 1`'/>\n<parameter name=\"tmp.vnf-instances_length\" value= '`$tmp.vnf-instances_length + 1`'/>","comments":"","outputs":1,"x":781,"y":1516,"z":"13ea1295.46163d","wires":[[]]},{"id":"dbeec32.fac504","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1413,"y":1384,"z":"13ea1295.46163d","wires":[[]]},{"id":"cbe26532.112ec8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":549,"y":1827,"z":"13ea1295.46163d","wires":[["4e6cd927.66b648"]]},{"id":"4e6cd927.66b648","type":"for","name":"for each triplet-list entry","xml":"<for index='tmp.tripletListIndex' start='0' end='`$tmp.triplet-list_length`' >\n","comments":"","outputs":1,"x":725,"y":1827,"z":"13ea1295.46163d","wires":[["94e42015.54dfc"]]},{"id":"94e42015.54dfc","type":"record","name":"PRINT triplet-list","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: PRINT triplet-list | vf-module-id:generic-vnf-id:model-customization-id | \"/>\n<parameter name=\"field3\" value='`$tmp.tripletListIndex`'/>\n<parameter name=\"field4\" value='`$tmp.triplet-list[$tmp.tripletListIndex].vf-module-id`'/>\n<parameter name=\"field5\" value='`$tmp.triplet-list[$tmp.tripletListIndex].generic-vnf-id`'/>\n<parameter name=\"field6\" value='`$tmp.triplet-list[$tmp.tripletListIndex].model-customization-id`'/>","comments":"","outputs":1,"x":937,"y":1827,"z":"13ea1295.46163d","wires":[[]]},{"id":"7829c9e3.21a538","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: MATCH for input vnf-id and triplet-list.model-customizaiton-id: \"/>\n<parameter name=\"field3\" value='`$vnf-ids[$vnfIdIndex]`'/>","comments":"","outputs":1,"x":1232,"y":2044,"z":"13ea1295.46163d","wires":[[]]},{"id":"db4b07f7.81a198","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"LAINA: getpathsegment-populate-from-vnfapi: unable to access AAI for generic-vnf-id: \"/>\n<parameter name=\"field4\" value='`$tmp.triplet-list[$tmp.tripletListIndex].generic-vnf-id`'/>","comments":"","outputs":1,"x":1546,"y":1782,"z":"13ea1295.46163d","wires":[[]]},{"id":"e4f6f713.40c298","type":"for","name":"for each vf-module-id","xml":"<for index='vfModuleResultIndex' start='0' end='`$tmp.AnAI-data.vf-module-ids.results_length`' >\n","comments":"","outputs":1,"x":1205,"y":986,"z":"13ea1295.46163d","wires":[["2e29cfe9.5fb8d"]]},{"id":"5f4d6161.d1d83","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1020,"y":986,"z":"13ea1295.46163d","wires":[["e4f6f713.40c298","94dc95d3.e5de88"]]},{"id":"94dc95d3.e5de88","type":"set","name":"set tmp.vf-module-ids_length","xml":"<set>\n<parameter name='tmp.vf-module-ids_length' value='`$tmp.AnAI-data.vf-module-ids.results_length`' />","comments":"","x":1229,"y":1021,"z":"13ea1295.46163d","wires":[]},{"id":"568d4dc9.681e44","type":"set","name":"set invalid vf-module-id that won't resolve in MDSAL  * TEST-ONLY *","xml":"<set>\n<parameter name=\"`'tmp.vf-module-ids[' + $vf-module-ids_length + ']'`\" value='invalid-vf-module-id' />\n<parameter name='tmp.vf-module-ids_length' value='`$tmp.vf-module-ids_length + 1`' />","comments":"","x":1608,"y":1024,"z":"13ea1295.46163d","wires":[]},{"id":"9edbc24f.7c9ff","type":"save","name":"AAI custom query: get vf-module-ids","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n      resource=\"custom-query\"\n      key=\"format = 'resource'\"\n      force=\"true\"\n      local-only=\"false\"\n      pfx=\"tmp.AnAI-data.vf-module-ids\">\n<parameter name=\"start[0]\" value=\"`'/nodes/service-instances/service-instance?service-instance-id=' + $serv-inst.service-instance-id `\" />\n<!--<parameter name=\"start[0]\" value=\"`'/business/customers/customer/bgb-customer/service-subscriptions/service-subscription/bgb-service-type/service-instances' `\" />-->\n<!--<parameter name=\"start[0]\" value=\"`'/business/customers/customer/la-customer/service-subscriptions/service-subscription/la-service-type/service-instances' `\" />-->\n<parameter name=\"start_length\" value=\"1\" />\n<parameter name=\"query\" value=\"/query/vfModule-fromServiceInstance\" />\n<!--<parameter name=\"query\" value=\"/query/vnfs-fromServiceInstance\" /> -->","comments":"","outputs":1,"x":620,"y":2564,"z":"13ea1295.46163d","wires":[["d8164ad7.bb02b8","212d7195.b42b2e","2da2f7c7.6a31c8"]]},{"id":"d8164ad7.bb02b8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":855.2380867004395,"y":2517.6664667129517,"z":"13ea1295.46163d","wires":[["d68c739a.44959"]]},{"id":"212d7195.b42b2e","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":856.3809814453125,"y":2563.3806762695312,"z":"13ea1295.46163d","wires":[["1e8358ef.3ee4d7"]]},{"id":"2da2f7c7.6a31c8","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":857.6190592447915,"y":2607.904560724894,"z":"13ea1295.46163d","wires":[["c4d6e68e.266f18"]]},{"id":"d68c739a.44959","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":994.9524154663086,"y":2517.380605697632,"z":"13ea1295.46163d","wires":[["f7584659.74a708"]]},{"id":"1e8358ef.3ee4d7","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":998.666690826416,"y":2563.952173233032,"z":"13ea1295.46163d","wires":[["c8a6f155.75ce8"]]},{"id":"c4d6e68e.266f18","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":998,"y":2608,"z":"13ea1295.46163d","wires":[["ec349c31.3499e","e0c57ef.cbd068"]]},{"id":"f7584659.74a708","type":"configure","name":"set error-message","xml":"<set>\n<parameter name=\"error-message\" value=\"Failed call to AAI custom query: vfModule-fromServiceInstance\" />\n<parameter name=\"serv-inst.api\" value= \"\"/>\n<parameter name='tmp.vf-module-ids_length' value='0' />\n<parameter name='tmp.vnf-instances_length' value='0' />\n","comments":"","outputs":1,"x":1175.52392578125,"y":2517.0949096679688,"z":"13ea1295.46163d","wires":[[]]},{"id":"c8a6f155.75ce8","type":"configure","name":"set error-message","xml":"<set>\n<parameter name=\"error-message\" value=\"No vfModules returned from AAI: vfModule-fromService-instance\" />\n<parameter name=\"serv-inst.api\" value= \"\"/>\n","comments":"","outputs":1,"x":1174.2381591796875,"y":2563.66650390625,"z":"13ea1295.46163d","wires":[[]]},{"id":"ec349c31.3499e","type":"for","name":"for each vf-module-id","xml":"<for index='vfModuleResultIndex' start='0' end='`$tmp.AnAI-data.vf-module-ids.results_length`' >\n","comments":"","outputs":1,"x":1183,"y":2608,"z":"13ea1295.46163d","wires":[["daa52c98.70291"]]},{"id":"e0c57ef.cbd068","type":"set","name":"set tmp.vf-module-ids_length","xml":"<set>\n<parameter name='tmp.vf-module-ids_length' value='`$tmp.AnAI-data.vf-module-ids.results_length`' />","comments":"","x":1207,"y":2643,"z":"13ea1295.46163d","wires":[]},{"id":"daa52c98.70291","type":"set","name":"set tmp.vf-module-ids","xml":"<set>\n<parameter name=\"`'tmp.vf-module-ids[' + $vfModuleResultIndex + ']'`\" value='`$tmp.AnAI-data.vf-module-ids.results[$vfModuleResultIndex].vf-module.vf-module-id`' />","comments":"","x":1440.952392578125,"y":2608.2379150390625,"z":"13ea1295.46163d","wires":[]},{"id":"cf9d4004.d81ce","type":"switchNode","name":"switch - check vnf-list length and set output.api if > 0","xml":"<switch test='`$serv-inst.vnf-list_length > 0`'>","comments":"","outputs":1,"x":325,"y":3592,"z":"13ea1295.46163d","wires":[["d27c75c1.526558"]]},{"id":"d27c75c1.526558","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":608,"y":3592,"z":"13ea1295.46163d","wires":[["f583b3e8.6485f"]]},{"id":"f583b3e8.6485f","type":"set","name":"set output serv-inst.api to VNF","xml":"<set>\n<parameter name=\"serv-inst.api\" value= \"VNF\"/>","comments":"","x":821,"y":3592,"z":"13ea1295.46163d","wires":[]},{"id":"f4d41db.52befe","type":"switchNode","name":"switch mdsal-error-encountered","xml":"<switch test='`$tmp.mdsal-error-encountered`'>\n","comments":"","outputs":1,"x":614,"y":1653,"z":"13ea1295.46163d","wires":[["88d062e4.05329","b1c6724.fe0e59"]]},{"id":"88d062e4.05329","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":830,"y":1652,"z":"13ea1295.46163d","wires":[["2684df46.e012f"]]},{"id":"b1c6724.fe0e59","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":584,"y":1741,"z":"13ea1295.46163d","wires":[["f58428cf.3a6858"]]},{"id":"2684df46.e012f","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":950,"y":1652,"z":"13ea1295.46163d","wires":[["95c1fb6f.8ce458"]]},{"id":"f58428cf.3a6858","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":726,"y":1741,"z":"13ea1295.46163d","wires":[[]]},{"id":"223f61e8.f562be","type":"for","name":"for each vf-module-id","xml":"<for index='vfModuleIndex' start='0' end='`$tmp.vf-module-ids_length`' >\n","comments":"","outputs":1,"x":564,"y":2729,"z":"13ea1295.46163d","wires":[["b8281b3d.23f5e8"]]},{"id":"b8281b3d.23f5e8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":567,"y":2768,"z":"13ea1295.46163d","wires":[["857f142a.fb6238","135b7762.c5e859","1b271514.dafa0b","6a0cc06e.d6de8","97812196.a3549"]]},{"id":"857f142a.fb6238","type":"configure","name":"set vnf-url","xml":"<set>\n<parameter name=\"tmp.vnf-url\" value=\"`'/restconf/config/VNF-API:vnfs/vnf-list/' + $tmp.vf-module-ids[$vfModuleIndex]`\" />\n","comments":"","outputs":1,"x":597,"y":2832,"z":"13ea1295.46163d","wires":[[]]},{"id":"97812196.a3549","type":"configure","name":"increment vnfListIndex and set serv-inst.vnf-list[$vnfListIndex].vnf-id","xml":"<set>\n<parameter name=\"vnfListIndex\" value= '`$vnfListIndex + 1`'/>","comments":"","outputs":1,"x":774,"y":3326,"z":"13ea1295.46163d","wires":[[]]}]