[{"id":"8f1f2ad4.1b2628","type":"dgstart","name":"DGSTART","outputs":1,"x":185,"y":110,"z":"892de9cf.a3e7e8","wires":[["aef28f38.d3ad2"]]},{"id":"aef28f38.d3ad2","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":281.2380790710449,"y":170.95239067077637,"z":"892de9cf.a3e7e8","wires":[["d541214e.1421c"]]},{"id":"d541214e.1421c","type":"method","name":"brg-topology-operation-unassign","xml":"<method rpc='brg-topology-operation-unassign' mode='sync'>\n","comments":"","outputs":1,"x":325.15489196777344,"y":210.190447807312,"z":"892de9cf.a3e7e8","wires":[["3d909232.be8cbe"]]},{"id":"3d909232.be8cbe","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","comments":"","outputs":1,"x":235.47619247436523,"y":349.5237879753113,"z":"892de9cf.a3e7e8","wires":[["ac546d04.a44e3","65b7ebff.45ef54","887af0a1.cfd5a","16719562.f89cfb","921e5db9.a3742","ae6a6800.748f18","4585bd6c.db3454","a30a4193.dc67c"]]},{"id":"65b7ebff.45ef54","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":502.0001106262207,"y":1019.2145080566406,"z":"892de9cf.a3e7e8","wires":[]},{"id":"ac546d04.a44e3","type":"set","name":"set output to api handler","xml":"<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='brg-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $brg-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n","comments":"","x":530.7540245056152,"y":983.3370542526245,"z":"892de9cf.a3e7e8","wires":[]},{"id":"16719562.f89cfb","type":"set","name":"set tmp.ar.self-link","xml":"<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:brg-allotted-resources/brg-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/brg-topology/'` \" />\n\n","comments":"","x":497.73806381225586,"y":323.33332538604736,"z":"892de9cf.a3e7e8","wires":[]},{"id":"887af0a1.cfd5a","type":"set","name":"set tmp.ar.allotted-resource-id,etc","xml":"<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$brg-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n<parameter name='tmp.ar.parent-service-instance-id' value='`$brg-topology-operation-input.allotted-resource-information.parent-service-instance-id`' />\n<parameter name='tmp.ar.brg-vnf-id' value='`$brg-topology-operation-input.allotted-resource-data.brg-topology.brg-assignments.brg-vnf-id`' />\n\n\n","comments":"","x":544.9973258972168,"y":289.59259128570557,"z":"892de9cf.a3e7e8","wires":[]},{"id":"921e5db9.a3742","type":"execute","name":"execute Properties","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n","comments":"","outputs":1,"x":503.9934196472168,"y":359.23152446746826,"z":"892de9cf.a3e7e8","wires":[[]]},{"id":"4585bd6c.db3454","type":"execute","name":"execute RestApiCallNode - Get AR by id","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n","comments":"","outputs":1,"x":566.5187530517578,"y":520.4594917297363,"z":"892de9cf.a3e7e8","wires":[["39c78959.7ed206","f4ec9c65.dbf1a"]]},{"id":"ae6a6800.748f18","type":"execute","name":"generate allotted-resource url","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.brg-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n","comments":"","outputs":1,"x":532.0648536682129,"y":419.0172290802002,"z":"892de9cf.a3e7e8","wires":[[]]},{"id":"39c78959.7ed206","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":823.8148918151855,"y":519.2672522068024,"z":"892de9cf.a3e7e8","wires":[["aa4578bf.e01898"]]},{"id":"cf288e81.867c","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":844.837329864502,"y":926.432332418859,"z":"892de9cf.a3e7e8","wires":[["562e732f.776e5c"]]},{"id":"8f1f61fb.4c4c9","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":835.8373794555664,"y":894.9323581680655,"z":"892de9cf.a3e7e8","wires":[["562e732f.776e5c"]]},{"id":"48115134.9ae56","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":839.5874176025391,"y":865.2894630432129,"z":"892de9cf.a3e7e8","wires":[["9c761fba.db0c3"]]},{"id":"562e732f.776e5c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for brg-allotted-resource\" />\n","comments":"","x":1005.5874176025391,"y":895.6823820099235,"z":"892de9cf.a3e7e8","wires":[]},{"id":"aa4578bf.e01898","type":"block","name":"block: atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":1004.8148460388184,"y":519.7672016620636,"z":"892de9cf.a3e7e8","wires":[["d17cf2f0.cec85","dae16c74.e3b7c"]]},{"id":"d17cf2f0.cec85","type":"switchNode","name":"switch brg length","xml":"<switch test='`$mdsal-ar.brg-allotted-resource_length`'>\n","comments":"","outputs":1,"x":1250.6720924377441,"y":554.052964925766,"z":"892de9cf.a3e7e8","wires":[["9eb758cd.982008"]]},{"id":"9eb758cd.982008","type":"other","name":"outcome 1","xml":"<outcome value='1'>\n","comments":"","outputs":1,"x":1441.6720962524414,"y":554.0529625415802,"z":"892de9cf.a3e7e8","wires":[["e43335e7.a2b4b8"]]},{"id":"90a7fa85.7e06d8","type":"set","name":"set brg-ar from get","xml":"<set>\n<parameter name='brg-ar.' value='$mdsal-ar.brg-allotted-resource[0].' />\n","comments":"","x":1841.5292320251465,"y":554.6243867874146,"z":"892de9cf.a3e7e8","wires":[]},{"id":"e43335e7.a2b4b8","type":"block","name":"block: atomic","xml":"<block atomic='true'>\n","atomic":"false","comments":"","outputs":1,"x":1612.5290794372559,"y":554.6244316101074,"z":"892de9cf.a3e7e8","wires":[["90a7fa85.7e06d8","82e79827.7b2528","e9d4c55b.3b68e8"]]},{"id":"82e79827.7b2528","type":"set","name":"set oper-status","xml":"<set>\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$brg-ar.allotted-resource-data.allotted-resource-operation-information.request-information.request-action`' />\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$brg-ar.allotted-resource-status.rpc-action`' />\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$brg-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.svc-request-id`' />\n\n","comments":"","x":1839.5294761657715,"y":622.0529508590698,"z":"892de9cf.a3e7e8","wires":[]},{"id":"dceff592.9c16a8","type":"comment","name":"GET brg-allotted-resource from mdsal","info":"","comments":"","x":591.8148155212402,"y":483.7671926021576,"z":"892de9cf.a3e7e8","wires":[]},{"id":"e9d4c55b.3b68e8","type":"switchNode","name":"switch order-status","xml":"<switch test='`$brg-ar.allotted-resource-data.allotted-resource-oper-status.order-status`'>\n","comments":"","outputs":1,"x":1849.52925491333,"y":587.6243848800659,"z":"892de9cf.a3e7e8","wires":[["ee32ca42.029ac8","f44f15e1.8ed938"]]},{"id":"ee32ca42.029ac8","type":"outcome","name":"outcome Created","xml":"<outcome value='Created'>\n","comments":"","outputs":1,"x":2061.1292114257812,"y":548.6243848800659,"z":"892de9cf.a3e7e8","wires":[["74e489f7.35eb68"]]},{"id":"f44f15e1.8ed938","type":"outcome","name":"outcome Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2086.8435859680176,"y":584.052975654602,"z":"892de9cf.a3e7e8","wires":[["74e489f7.35eb68"]]},{"id":"dae16c74.e3b7c","type":"set","name":"save backup copy of mdsal-ar for rollback","xml":"<set>\n<parameter name='bk-brg-ar' value='$mdsal-ar.' />\n","comments":"","x":1330.3864250183105,"y":519.7672936916351,"z":"892de9cf.a3e7e8","wires":[]},{"id":"972a22dc.b7b85","type":"comment","name":"Create urls for restapi","info":"","comments":"","x":502.9576606750488,"y":388.6243562698364,"z":"892de9cf.a3e7e8","wires":[]},{"id":"9c761fba.db0c3","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":981.2433853149414,"y":861.481632232666,"z":"892de9cf.a3e7e8","wires":[[]]},{"id":"f4ec9c65.dbf1a","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":823.5766868591309,"y":555.4814250469208,"z":"892de9cf.a3e7e8","wires":[["8c932988.c6f7a8"]]},{"id":"8c932988.c6f7a8","type":"block","name":"block: atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":1003.5766372680664,"y":556.1479756832123,"z":"892de9cf.a3e7e8","wires":[[]]},{"id":"74e489f7.35eb68","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2275.5997276306152,"y":550.0000190734863,"z":"892de9cf.a3e7e8","wires":[[]]},{"id":"a30a4193.dc67c","type":"execute","name":"execute RestApiCallNode - PUT AR by id","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='DELETE' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n","comments":"","outputs":1,"x":568.0000610351562,"y":878.0000267028809,"z":"892de9cf.a3e7e8","wires":[["48115134.9ae56","8f1f61fb.4c4c9","cf288e81.867c"]]}]
