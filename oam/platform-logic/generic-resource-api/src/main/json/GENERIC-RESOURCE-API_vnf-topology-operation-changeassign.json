[{"id":"e1c194c1.6c0748","type":"dgstart","name":"DGSTART","outputs":1,"x":160,"y":109.55651497840881,"z":"a52bb8fe.adb788","wires":[["ead596a6.b90fe8"]]},{"id":"ead596a6.b90fe8","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":272.4285583496094,"y":149.79462552070618,"z":"a52bb8fe.adb788","wires":[["54440786.fc64e8"]]},{"id":"54440786.fc64e8","type":"method","name":"method vnf-topology-operation-changeassign","xml":"<method rpc='vnf-topology-operation-changeassign' mode='sync'>\n","comments":"","outputs":1,"x":268.14290618896484,"y":189.55651307106018,"z":"a52bb8fe.adb788","wires":[["83d88b47.4d48e8"]]},{"id":"a350908d.3a513","type":"comment","name":"vnf-topology-operation-changeassign","info":"","comments":"","x":554.344856262207,"y":57.1428587436676,"z":"a52bb8fe.adb788","wires":[]},{"id":"d4c5e8f.85d7e18","type":"switchNode","name":"switch request-action","xml":"<switch test='`$vnf-topology-operation-input.request-information.request-action`'>\n","comments":"","outputs":1,"x":559.2381134033203,"y":291.2708065509796,"z":"a52bb8fe.adb788","wires":[["1d618262.2b7c0e","a1afa6db.9a8228"]]},{"id":"1d618262.2b7c0e","type":"outcome","name":"CreateVnfInstance","xml":"<outcome value='CreateVnfInstance'>\n","comments":"","outputs":1,"x":783.3809280395508,"y":265.5565149784088,"z":"a52bb8fe.adb788","wires":[["933303e3.faabc"]]},{"id":"a1afa6db.9a8228","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":746.3809509277344,"y":309.60415387153625,"z":"a52bb8fe.adb788","wires":[["43d5251e.0786cc"]]},{"id":"933303e3.faabc","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":974.9523849487305,"y":265.5565502643585,"z":"a52bb8fe.adb788","wires":[[]]},{"id":"43d5251e.0786cc","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"If svc-action is 'changeassign' then request-action must be 'CreateVnfInstance'\" />\n","comments":"","x":953.7618980407715,"y":309.60416531562805,"z":"a52bb8fe.adb788","wires":[]},{"id":"e362aea6.b1346","type":"switchNode","name":"switch order-status","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.order-status`'>\n","comments":"","outputs":1,"x":1255.6667022705078,"y":794.4138145446777,"z":"a52bb8fe.adb788","wires":[["74079e6b.aefc1","f88a32.e16d55d"]]},{"id":"74079e6b.aefc1","type":"other","name":"PendingDelete","xml":"<outcome value='PendingDelete'>\n","comments":"","outputs":1,"x":1457.6667594909668,"y":772.1279821395874,"z":"a52bb8fe.adb788","wires":[["66e4e92e.0e5cb8"]]},{"id":"f0d7f0c0.b9715","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"The requested VNF is not pending deletion\" />\n","comments":"","x":1623.8096237182617,"y":815.4613599777222,"z":"a52bb8fe.adb788","wires":[]},{"id":"262a166a.7d1fda","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":973.666748046875,"y":790.1756362915039,"z":"a52bb8fe.adb788","wires":[["f0824f71.68f53","10dfb5b0.7b060a","f92bbe0f.41a0d","1842bbb2.3f45e4","f4966ea2.08ebe","e75e31c6.759f8"]]},{"id":"f0824f71.68f53","type":"set","name":"set service-object-path","xml":"<set>\n<parameter name='service-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $service-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n","comments":"","x":1263.9643783569336,"y":1151.0924091339111,"z":"a52bb8fe.adb788","wires":[]},{"id":"10dfb5b0.7b060a","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n","comments":"","x":1238.2500801086426,"y":1193.9495477676392,"z":"a52bb8fe.adb788","wires":[]},{"id":"1883e45.437cc1c","type":"switchNode","name":"switch vnf_length","xml":"<switch test='`$service-data.vnfs.vnf_length`'>\n","comments":"","outputs":1,"x":545.2380523681641,"y":366.41365361213684,"z":"a52bb8fe.adb788","wires":[["bd6d0272.639e4"]]},{"id":"bd6d0272.639e4","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":731.9047317504883,"y":365.746951341629,"z":"a52bb8fe.adb788","wires":[["c208e20e.dee69"]]},{"id":"c208e20e.dee69","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs in MD-SAL\" />\n","comments":"","x":913.5713577270508,"y":365.746951341629,"z":"a52bb8fe.adb788","wires":[]},{"id":"e783c444.749018","type":"for","name":"for each vnf","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n","comments":"","outputs":1,"x":528.3332901000977,"y":412.8898298740387,"z":"a52bb8fe.adb788","wires":[["1fa6a1eb.45f01e"]]},{"id":"1fa6a1eb.45f01e","type":"switchNode","name":"switch this vnf-id == input vnf-id","xml":"<switch test='`$service-data.vnfs.vnf[$idx].vnf-id == $vnf-topology-operation-input.vnf-information.vnf-id`'>\n","comments":"","outputs":1,"x":783.3333778381348,"y":412.5564978122711,"z":"a52bb8fe.adb788","wires":[["e1552725.581738"]]},{"id":"e1552725.581738","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1014.6666641235352,"y":412.55647587776184,"z":"a52bb8fe.adb788","wires":[["7d331694.1e4b48"]]},{"id":"7d331694.1e4b48","type":"set","name":"set vnf-index","xml":"<set>\n<parameter name='vnf-index' value='`$idx`' />\n","comments":"","x":1189.9998588562012,"y":412.5564978122711,"z":"a52bb8fe.adb788","wires":[]},{"id":"93ca063a.aa8398","type":"switchNode","name":"switch vnf-index","xml":"<switch test='`$vnf-index`'>\n","comments":"","outputs":1,"x":539.9999542236328,"y":458.55649971961975,"z":"a52bb8fe.adb788","wires":[["49ee296a.51dd08"]]},{"id":"49ee296a.51dd08","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":721.6665725708008,"y":457.8898298740387,"z":"a52bb8fe.adb788","wires":[["37762b01.3309d4"]]},{"id":"37762b01.3309d4","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"'Could not find VNF ' + $vnf-topology-operation-input.vnf-information.vnf-id + ' in MD-SAL'\" />\n","comments":"","x":888.3332595825195,"y":457.5564558506012,"z":"a52bb8fe.adb788","wires":[]},{"id":"f92bbe0f.41a0d","type":"set","name":"copy ONAP model information","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.'\n  value='`$vnf-topology-operation-input.vnf-information.onap-model-information.`' />\n","comments":"","x":1287.3213272094727,"y":1053.6786460876465,"z":"a52bb8fe.adb788","wires":[]},{"id":"1842bbb2.3f45e4","type":"set","name":"set vnf-level-oper-status to Created","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.order-status' value='Created' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.last-rpc-action' value='`$vnf-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.last-action' value='`$vnf-topology-operation-input.request-information.request-action`' />\n","comments":"","x":1299.9168014526367,"y":1103.473310470581,"z":"a52bb8fe.adb788","wires":[]},{"id":"66e4e92e.0e5cb8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1607.0001220703125,"y":771.4762535095215,"z":"a52bb8fe.adb788","wires":[[]]},{"id":"f88a32.e16d55d","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1432.000156402588,"y":816.4762439727783,"z":"a52bb8fe.adb788","wires":[["f0d7f0c0.b9715"]]},{"id":"f4966ea2.08ebe","type":"get-resource","name":"get-resource VF_MODEL","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n  key='SELECT * from VF_MODEL WHERE customization_uuid = $vnf-topology-operation-input.vnf-information.onap-model-information.model-customization-uuid'\n  pfx='db.vf-model'>\n\n","comments":"","outputs":1,"x":1276.5834732055664,"y":981.0595569610596,"z":"a52bb8fe.adb788","wires":[["ed164bcc.8ffe08","4e821164.7d0e4"]]},{"id":"4d872d36.fe2664","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No model found for VNF customization UUID ' + $vnf-topology-operation-input.vnf-information.onap-model-information.model-customization-uuid`\" />\n","comments":"","x":1629.6786613464355,"y":1006.1547298431396,"z":"a52bb8fe.adb788","wires":[]},{"id":"ed164bcc.8ffe08","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1464.0358619689941,"y":961.4403944015503,"z":"a52bb8fe.adb788","wires":[["4d7f7e60.5f93a"]]},{"id":"4e821164.7d0e4","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1472.607292175293,"y":1005.7261075973511,"z":"a52bb8fe.adb788","wires":[["4d872d36.fe2664"]]},{"id":"4d7f7e60.5f93a","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VF_MODEL table\" />\n","comments":"","x":1629.0358619689941,"y":961.2499885559082,"z":"a52bb8fe.adb788","wires":[]},{"id":"e93ff26c.a95eb","type":"comment","name":"check removed with US622450","info":"","comments":"","x":1821.2858963012695,"y":782.428619146347,"z":"a52bb8fe.adb788","wires":[]},{"id":"713df0ac.79aeb","type":"call","name":"call self-serve-vnf-changeassign","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-vnf-changeassign' mode='sync' >\n","comments":"","outputs":1,"x":1036.642837524414,"y":1337.8930521011353,"z":"a52bb8fe.adb788","wires":[["8a6087f4.1886c8","f68bd7bf.4aaeb8"]]},{"id":"8a6087f4.1886c8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1262.392822265625,"y":1338.1430406570435,"z":"a52bb8fe.adb788","wires":[["6db31d59.bc5ac4"]]},{"id":"6db31d59.bc5ac4","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value=\"`'Encountered error performing changeassign for self-serve resources with error: '+ $error-message`\" />\n","comments":"","x":1421.9642486572266,"y":1337.7859354019165,"z":"a52bb8fe.adb788","wires":[]},{"id":"83d88b47.4d48e8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":287.14286041259766,"y":412.8571436405182,"z":"a52bb8fe.adb788","wires":[["d4c5e8f.85d7e18","1883e45.437cc1c","e783c444.749018","93ca063a.aa8398","31d5e46.5d4c41c","81386862.83ff18","15268cd3.f26f53"]]},{"id":"f68bd7bf.4aaeb8","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1268.8573150634766,"y":1383.4287576675415,"z":"a52bb8fe.adb788","wires":[["41ad583b.a267b8"]]},{"id":"41ad583b.a267b8","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":1437.4287300109863,"y":1383.0001993179321,"z":"a52bb8fe.adb788","wires":[]},{"id":"e75e31c6.759f8","type":"switchNode","name":"switch model-customization-id","xml":"<switch test='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid`'>\n","comments":"","outputs":1,"x":1291.2857284545898,"y":913.8929176330566,"z":"a52bb8fe.adb788","wires":[["76be18e5.42cbc8"]]},{"id":"76be18e5.42cbc8","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1496.2857284545898,"y":913.892900466919,"z":"a52bb8fe.adb788","wires":[["8c93cdfd.d8a0a"]]},{"id":"8c93cdfd.d8a0a","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"vf-module-information.onap-model-information.model-customization-uuid is a required input\" />\n","comments":"","x":1647.7142944335938,"y":913.8928985595703,"z":"a52bb8fe.adb788","wires":[]},{"id":"31f3c93b.c00b06","type":"comment","name":"model-customization-uuid validation moved from validate-vnf-input DG","info":"","comments":"","x":1425.0357284545898,"y":872.8929309844971,"z":"a52bb8fe.adb788","wires":[]},{"id":"31d5e46.5d4c41c","type":"call","name":"call self-serve-vnf-forking-logic","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-vnf-forking-logic' mode='sync' >\n","comments":"","outputs":1,"x":578.5713806152344,"y":684.2857723236084,"z":"a52bb8fe.adb788","wires":[[]]},{"id":"81386862.83ff18","type":"switchNode","name":"switch ss.self-serve-flag","xml":"<switch test=\"`$ss.self-serve-flag`\">\n","comments":"","outputs":1,"x":572.7142028808594,"y":789.8572196960449,"z":"a52bb8fe.adb788","wires":[["60e43430.ed401c","1920358d.2f5cda"]]},{"id":"60e43430.ed401c","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":799.7142028808594,"y":790.2858047485352,"z":"a52bb8fe.adb788","wires":[["262a166a.7d1fda"]]},{"id":"1920358d.2f5cda","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":803.8569946289062,"y":1337.7145385742188,"z":"a52bb8fe.adb788","wires":[["713df0ac.79aeb"]]},{"id":"15268cd3.f26f53","type":"get-resource","name":"get-resource VF_MODEL","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n  key='SELECT * from VF_MODEL WHERE customization_uuid = $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-customization-uuid'\n  pfx='db.vf-model'>\n\n","comments":"","outputs":1,"x":564.1428527832031,"y":578.5714359283447,"z":"a52bb8fe.adb788","wires":[["4c8c944d.055d7c","75caadc7.5e0494"]]},{"id":"7805a43c.ee725c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No model found for VNF customization UUID ' + $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-customization-uuid`\" />\n","comments":"","x":964.999885559082,"y":601.9999370574951,"z":"a52bb8fe.adb788","wires":[]},{"id":"4c8c944d.055d7c","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":786.2142562866211,"y":557.5237483978271,"z":"a52bb8fe.adb788","wires":[["e499924e.025d2"]]},{"id":"75caadc7.5e0494","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":794.7856864929199,"y":601.8094615936279,"z":"a52bb8fe.adb788","wires":[["7805a43c.ee725c"]]},{"id":"e499924e.025d2","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VF_MODEL table\" />\n","comments":"","x":964.3570861816406,"y":557.0951957702637,"z":"a52bb8fe.adb788","wires":[]},{"id":"50618ca.12b8274","type":"comment","name":"Query is needed by forking logic","info":"","comments":"","x":584.2857055664062,"y":532.8572034835815,"z":"a52bb8fe.adb788","wires":[]}]