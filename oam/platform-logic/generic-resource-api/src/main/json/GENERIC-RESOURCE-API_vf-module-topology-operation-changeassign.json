[{"id":"206edd66.51e652","type":"dgstart","name":"DGSTART","outputs":1,"x":101.66666412353516,"y":82.41365432739258,"z":"fa58896c.a8e848","wires":[["5690a99b.ec8778"]]},{"id":"5690a99b.ec8778","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":214.9523696899414,"y":122.65176582336426,"z":"fa58896c.a8e848","wires":[["5b0a303e.e1d48"]]},{"id":"5b0a303e.e1d48","type":"method","name":"method vf-module-topology-operation-changeassign","xml":"<method rpc='vf-module-topology-operation-changeassign' mode='sync'>\n","comments":"","outputs":1,"x":233.0952911376953,"y":162.41365432739258,"z":"fa58896c.a8e848","wires":[["66e405b6.f01a7c"]]},{"id":"6437f4cb.316a2c","type":"comment","name":"vf-module-topology-operation-changeassign","info":"","comments":"","x":496.0115203857422,"y":29.999998092651367,"z":"fa58896c.a8e848","wires":[]},{"id":"6fdbf534.00d43c","type":"switchNode","name":"switch request-action","xml":"<switch test='`$vf-module-topology-operation-input.request-information.request-action`'>\n","comments":"","outputs":1,"x":505.1904754638672,"y":261.2707920074463,"z":"fa58896c.a8e848","wires":[["7af20766.b5fe78","2fa375b8.bda7ba"]]},{"id":"7af20766.b5fe78","type":"outcome","name":"CreateVfModuleInstance","xml":"<outcome value='CreateVfModuleInstance'>\n","comments":"","outputs":1,"x":756.2380905151367,"y":238.4136781692505,"z":"fa58896c.a8e848","wires":[["b84b0314.4c284"]]},{"id":"2fa375b8.bda7ba","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":699.9047355651855,"y":283.7946672439575,"z":"fa58896c.a8e848","wires":[["fb8a5c21.c5ba4"]]},{"id":"b84b0314.4c284","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":946.0952548980713,"y":238.41370964050293,"z":"fa58896c.a8e848","wires":[[]]},{"id":"fb8a5c21.c5ba4","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"If svc-action is 'changeassign' then request-action must be 'CreateVfModuleInstance'\" />\n","comments":"","x":964.9047431945801,"y":284.1279797554016,"z":"fa58896c.a8e848","wires":[]},{"id":"66e405b6.f01a7c","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":170.47621154785156,"y":457.4135799407959,"z":"fa58896c.a8e848","wires":[["6fdbf534.00d43c","5401e74b.3d2138","ab370680.4d1d68","1999519.d00e0ae","499fe3f8.979a2c","dbbe7c81.45754","59a5052d.a6c78c","a99f8e3.3a5e27","89912787.66ee78"]]},{"id":"ab370680.4d1d68","type":"switchNode","name":"switch service-data.vnfs.vnf_length","xml":"<switch test='`$service-data.vnfs.vnf_length`'>\n","comments":"","outputs":1,"x":549.9999923706055,"y":392.41361904144287,"z":"fa58896c.a8e848","wires":[["b6ee91a4.3a37f","b8e5865c.c31308"]]},{"id":"b6ee91a4.3a37f","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":790.7142639160156,"y":369.55635929107666,"z":"fa58896c.a8e848","wires":[["86b8a02.25e7b6"]]},{"id":"b8e5865c.c31308","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":790.4761047363281,"y":410.5088777542114,"z":"fa58896c.a8e848","wires":[["81637a69.dc91a8"]]},{"id":"86b8a02.25e7b6","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs defined in MD-SAL\" />\n","comments":"","x":957.3808784484863,"y":368.84211444854736,"z":"fa58896c.a8e848","wires":[]},{"id":"81637a69.dc91a8","type":"for","name":"for each vnf","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n","comments":"","outputs":1,"x":952.7142486572266,"y":410.1754961013794,"z":"fa58896c.a8e848","wires":[["ca245765.0e91a8"]]},{"id":"ca245765.0e91a8","type":"switchNode","name":"switch service data vnf == input vnf","xml":"<switch test='`$service-data.vnfs.vnf[$idx].vnf-id == $vf-module-topology-operation-input.vnf-information.vnf-id`'>\n","comments":"","outputs":1,"x":1204.0474662780762,"y":409.84218311309814,"z":"fa58896c.a8e848","wires":[["3f4b4e25.318c62"]]},{"id":"3f4b4e25.318c62","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1434.0475578308105,"y":409.175537109375,"z":"fa58896c.a8e848","wires":[["8721d18c.8ed4b"]]},{"id":"5401e74b.3d2138","type":"set","name":"set vnf-index to -1","xml":"<set>\n<parameter name='vnf-index' value='-1' />\n","comments":"","x":494.04759216308594,"y":330.50879096984863,"z":"fa58896c.a8e848","wires":[]},{"id":"c949c164.bfb1e","type":"set","name":"set vnf-index to idx","xml":"<set>\n<parameter name='vnf-index' value='`$idx`' />\n","comments":"","x":1755.7141952514648,"y":380.1754951477051,"z":"fa58896c.a8e848","wires":[]},{"id":"1999519.d00e0ae","type":"switchNode","name":"switch vnf-index","xml":"<switch test='`$vnf-index`'>\n","comments":"","outputs":1,"x":485.7142753601074,"y":457.17549324035645,"z":"fa58896c.a8e848","wires":[["23428438.190abc"]]},{"id":"23428438.190abc","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":664.0476608276367,"y":456.5088691711426,"z":"fa58896c.a8e848","wires":[["e0dee4ef.c5ad38"]]},{"id":"e0dee4ef.c5ad38","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find VNF ID ' + $vf-module-topology-operation-input.vnf-information.vnf-id + ' in MD-SAL'`\" />\n","comments":"","x":824.0475692749023,"y":455.84217262268066,"z":"fa58896c.a8e848","wires":[]},{"id":"8721d18c.8ed4b","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1582.3810195922852,"y":408.09523582458496,"z":"fa58896c.a8e848","wires":[["c949c164.bfb1e","1d8adeec.ba3e91"]]},{"id":"1d8adeec.ba3e91","type":"break","name":"break","xml":"<break>\n","comments":"","x":1717.3809852600098,"y":429.7618217468262,"z":"fa58896c.a8e848","wires":[]},{"id":"dbbe7c81.45754","type":"switchNode","name":"switch service-data...vf-module_length","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n","comments":"","outputs":1,"x":558.3333053588867,"y":555.7469902038574,"z":"fa58896c.a8e848","wires":[["aa141bda.6d5a28","e8068e6e.b49b9"]]},{"id":"aa141bda.6d5a28","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":809.0476150512695,"y":534.556393623352,"z":"fa58896c.a8e848","wires":[["21aa7dbf.c01442"]]},{"id":"e8068e6e.b49b9","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":808.809455871582,"y":575.5089120864868,"z":"fa58896c.a8e848","wires":[["134a0350.3f0a5d"]]},{"id":"21aa7dbf.c01442","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'There are no VF modules defined in MD-SAL for VNF ' + $vf-module-topology-operation-input.vnf-information.vnf-id`\" />\n","comments":"","x":975.7142295837402,"y":533.8421487808228,"z":"fa58896c.a8e848","wires":[]},{"id":"134a0350.3f0a5d","type":"for","name":"for each vf-module","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' >\n","comments":"","outputs":1,"x":971.0475997924805,"y":575.1755304336548,"z":"fa58896c.a8e848","wires":[["edc547d5.0aa318"]]},{"id":"edc547d5.0aa318","type":"switchNode","name":"switch service data vf-module == input vf-module","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id == $vf-module-topology-operation-input.vf-module-information.vf-module-id`'>\n","comments":"","outputs":1,"x":1277.380760192871,"y":574.8422660827637,"z":"fa58896c.a8e848","wires":[["318564aa.ae35ac"]]},{"id":"318564aa.ae35ac","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1547.3808135986328,"y":572.5088710784912,"z":"fa58896c.a8e848","wires":[["a8605c3c.4de66"]]},{"id":"499fe3f8.979a2c","type":"set","name":"set vf-module-index to -1","xml":"<set>\n<parameter name='vf-module-index' value='-1' />\n","comments":"","x":514.0475769042969,"y":505.5088291168213,"z":"fa58896c.a8e848","wires":[]},{"id":"9995bda.e901c4","type":"set","name":"set vf-module-index to idx","xml":"<set>\n<parameter name='vf-module-index' value='`$idx`' />\n","comments":"","x":1877.3809051513672,"y":543.5088500976562,"z":"fa58896c.a8e848","wires":[]},{"id":"59a5052d.a6c78c","type":"switchNode","name":"switch vf-module-index","xml":"<switch test='`$vf-module-index`'>\n","comments":"","outputs":1,"x":510.7142791748047,"y":623.842248916626,"z":"fa58896c.a8e848","wires":[["f812b688.df3ec8"]]},{"id":"f812b688.df3ec8","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":689.047664642334,"y":623.1756248474121,"z":"fa58896c.a8e848","wires":[["c06013b1.823e"]]},{"id":"c06013b1.823e","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find VF module ID ' + $vf-module-topology-operation-input.vf-module-information.vf-module-id + ' in MD-SAL'`\" />\n","comments":"","x":849.0475730895996,"y":622.5089282989502,"z":"fa58896c.a8e848","wires":[]},{"id":"a8605c3c.4de66","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1680.71435546875,"y":571.4286108016968,"z":"fa58896c.a8e848","wires":[["9995bda.e901c4","eb5ada4d.57f188"]]},{"id":"eb5ada4d.57f188","type":"break","name":"break","xml":"<break>\n","comments":"","x":1815.7143211364746,"y":593.095196723938,"z":"fa58896c.a8e848","wires":[]},{"id":"320f662a.e7dbfa","type":"set","name":"set order-status to Created","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status'\n  value='Created' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.last-rpc-action'\n  value='`$vf-module-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.last-action'\n  value='`$vf-module-topology-operation-input.request-information.request-action`' />\n","comments":"","x":1175.1429710388184,"y":1252.2947244644165,"z":"fa58896c.a8e848","wires":[]},{"id":"c5598d08.12175","type":"switchNode","name":"switch order-status","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status`'>\n","comments":"","outputs":1,"x":1145.809555053711,"y":950.4613409042358,"z":"fa58896c.a8e848","wires":[["1a5708fa.418947","6c5dfae7.bf4834"]]},{"id":"1a5708fa.418947","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1323.8096504211426,"y":969.175669670105,"z":"fa58896c.a8e848","wires":[["b961dd8b.8c6fa"]]},{"id":"9d70d98b.f9c758","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1495.0001068115234,"y":921.4614133834839,"z":"fa58896c.a8e848","wires":[[]]},{"id":"b961dd8b.8c6fa","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Order status is ' + $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status + ' instead of PendingDelete'`\" />\n","comments":"","x":1509.4763069152832,"y":969.1757106781006,"z":"fa58896c.a8e848","wires":[]},{"id":"cd4935a2.274768","type":"set","name":"copy ONAP model information","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-information.onap-model-information.'\n   value='$vf-module-topology-operation-input.vf-module-information.onap-model-information.' />\n\n","comments":"","x":1185.8095932006836,"y":1205.6280965805054,"z":"fa58896c.a8e848","wires":[]},{"id":"e9cc2895.625258","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":1135.142879486084,"y":1300.62802028656,"z":"fa58896c.a8e848","wires":[]},{"id":"6c5dfae7.bf4834","type":"outcome","name":"PendingDelete","xml":"<outcome value='PendingDelete'>\n","comments":"","outputs":1,"x":1348.4762802124023,"y":920.7143230438232,"z":"fa58896c.a8e848","wires":[["9d70d98b.f9c758"]]},{"id":"9af7c56e.87c6e8","type":"get-resource","name":"get-resource VF_MODULE_MODEL","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n  key='SELECT * from VF_MODULE_MODEL WHERE customization_uuid = $vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid'\n  pfx='db.vf-module-model'>\n\n","comments":"","outputs":1,"x":1204.4762802124023,"y":1138.961350440979,"z":"fa58896c.a8e848","wires":[["ec94331f.572ec","aa8e07b3.dcbc28"]]},{"id":"fac5f793.94fd68","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No model found for VF module customization UUID ' + $vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid`\" />\n","comments":"","x":1649.9047012329102,"y":1163.3898229599,"z":"fa58896c.a8e848","wires":[]},{"id":"ec94331f.572ec","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1474.2619705200195,"y":1119.3421812057495,"z":"fa58896c.a8e848","wires":[["d6b3fa68.162948"]]},{"id":"aa8e07b3.dcbc28","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1482.8334007263184,"y":1163.6278944015503,"z":"fa58896c.a8e848","wires":[["fac5f793.94fd68"]]},{"id":"d6b3fa68.162948","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VF_MODULE_MODEL table\" />\n","comments":"","x":1649.2619018554688,"y":1118.4850816726685,"z":"fa58896c.a8e848","wires":[]},{"id":"3ac9be19.c95f12","type":"comment","name":"check removed with US622450","info":"","comments":"","x":1107.5238876342773,"y":911.4286470413208,"z":"fa58896c.a8e848","wires":[]},{"id":"df389f05.3d088","type":"call","name":"call self-serve-vfmodule-changeassign","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-vfmodule-changeassign' mode='sync' >\n","comments":"","outputs":1,"x":975.5951690673828,"y":789.3214473724365,"z":"fa58896c.a8e848","wires":[["3b96494d.ab7ab6","d685937f.c7e43"]]},{"id":"3b96494d.ab7ab6","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1225.3451538085938,"y":789.5714359283447,"z":"fa58896c.a8e848","wires":[["6f907cba.351524"]]},{"id":"6f907cba.351524","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value=\"`'Encountered error performing changeassign for self-serve vf-module resources with error: '+ $error-message`\" />\n","comments":"","x":1384.9165802001953,"y":789.2143306732178,"z":"fa58896c.a8e848","wires":[]},{"id":"82bc5f2b.daf28","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":916.0953598022461,"y":1139.4287586212158,"z":"fa58896c.a8e848","wires":[["9af7c56e.87c6e8","cd4935a2.274768","320f662a.e7dbfa","e9cc2895.625258","4973a160.64101"]]},{"id":"d685937f.c7e43","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1231.6666069030762,"y":833.4285087585449,"z":"fa58896c.a8e848","wires":[["f13b3439.d3c228"]]},{"id":"f13b3439.d3c228","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":1388.8095932006836,"y":833.4285221099854,"z":"fa58896c.a8e848","wires":[]},{"id":"4973a160.64101","type":"switchNode","name":"switch model-customization-id","xml":"<switch test='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid`'>\n","comments":"","outputs":1,"x":1184.6666946411133,"y":1074.7351503372192,"z":"fa58896c.a8e848","wires":[["c0d3eb0d.421c18"]]},{"id":"c0d3eb0d.421c18","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1389.6666946411133,"y":1074.7351331710815,"z":"fa58896c.a8e848","wires":[["5d502035.c3483"]]},{"id":"5d502035.c3483","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"vf-module-information.onap-model-information.model-customization-uuid is a required input\" />\n","comments":"","x":1541.0952606201172,"y":1074.735131263733,"z":"fa58896c.a8e848","wires":[]},{"id":"48438534.93283c","type":"comment","name":"model-customization-uuid validation moved from validate-vnf-input DG","info":"","comments":"","x":1203.4166946411133,"y":1037.2351369857788,"z":"fa58896c.a8e848","wires":[]},{"id":"44948529.f6abec","type":"comment","name":"SELF-SERVE FORK","info":"","comments":"","x":795.9523849487305,"y":745.7142667770386,"z":"fa58896c.a8e848","wires":[]},{"id":"a99f8e3.3a5e27","type":"call","name":"call self-serve-vf-module-forking-logic","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-vf-module-forking-logic' mode='sync' >\n","comments":"","outputs":1,"x":554.9681701660156,"y":685.5361366271973,"z":"fa58896c.a8e848","wires":[[]]},{"id":"89912787.66ee78","type":"switchNode","name":"switch ss.self-serve-flag","xml":"<switch test=\"`$ss.self-serve-flag`\">\n","comments":"","outputs":1,"x":511.6823272705078,"y":958.25048828125,"z":"fa58896c.a8e848","wires":[["92f63a1f.1a08e8","dca3e5a3.e9fdf8"]]},{"id":"92f63a1f.1a08e8","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":734.6822624206543,"y":1139.1071319580078,"z":"fa58896c.a8e848","wires":[["82bc5f2b.daf28"]]},{"id":"dca3e5a3.e9fdf8","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":734.3965606689453,"y":788.9647417068481,"z":"fa58896c.a8e848","wires":[["df389f05.3d088"]]}]