[{"id":"b7bd68dc.2f2598","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n\t<parameter name=\"error-code\" value=\"200\" />","comments":"","x":442.83336639404297,"y":580.250039100647,"z":"8bafd60a.f9e8e8","wires":[]},{"id":"29350296.bd8dfe","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":219.83331298828125,"y":173.8333282470703,"z":"8bafd60a.f9e8e8","wires":[["d2e1aff0.abd97","b7bd68dc.2f2598","1100f729.686421","f7dbd114.d5b85","99a80553.587948","e47598ee.1b6f68","ca1dc7fb.a35a5"]]},{"id":"d2e1aff0.abd97","type":"set","name":"set: order-status = Deleted","xml":"<set>\n\t<parameter name=\"service-data.oper-status.order-status\" value=\"Deleted\"/>","comments":"","x":483.83336639404297,"y":407.250039100647,"z":"8bafd60a.f9e8e8","wires":[]},{"id":"f243526a.6db178","type":"method","name":"method vnf-topology-delete","xml":"<method rpc='vnf-topology-delete' mode='sync'>\n","comments":"","outputs":1,"x":251.5,"y":122.99999237060547,"z":"8bafd60a.f9e8e8","wires":[["29350296.bd8dfe"]]},{"id":"163c6981.d4f7ee","type":"service-logic","name":"VNF-API ${project.version}","module":"VNF-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='VNF-API' version='${project.version}'>","outputs":1,"x":368.16663360595703,"y":71.00000286102295,"z":"8bafd60a.f9e8e8","wires":[["f243526a.6db178"]]},{"id":"1c4e666f.583c8a","type":"dgstart","name":"DGSTART","outputs":1,"x":158.33331298828125,"y":70.83332824707031,"z":"8bafd60a.f9e8e8","wires":[["163c6981.d4f7ee"]]},{"id":"499d2345.e96514","type":"other","name":"false","xml":"<outcome value='false'>","comments":"","outputs":1,"x":1146.757640838623,"y":255.29546451568604,"z":"8bafd60a.f9e8e8","wires":[["829c09fd.4a37f8"]]},{"id":"829c09fd.4a37f8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='400'/>\n\t<parameter name='error-message' value='Invalid order-status'/>","comments":"","x":1299.0907707214355,"y":255.29552555084229,"z":"8bafd60a.f9e8e8","wires":[]},{"id":"99a80553.587948","type":"set","name":"set: last-action ","xml":"<set>\n\t<parameter name=\"service-data.oper-status.last-action\" value=\"`$service-data.request-information.request-action`\"/>","comments":"","x":445.0909652709961,"y":450.7956323623657,"z":"8bafd60a.f9e8e8","wires":[]},{"id":"1100f729.686421","type":"switchNode","name":"switch:vnf-id   config == input","xml":"<switch test=\"`$vnf-topology-operation-input.vnf-request-information.vnf-id == $service-data.vnf-id`\">","comments":"","outputs":1,"x":488.97721099853516,"y":173.32087326049805,"z":"8bafd60a.f9e8e8","wires":[["1fa6b0bd.a10757"]]},{"id":"1fa6b0bd.a10757","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":690.431770324707,"y":173.50270080566406,"z":"8bafd60a.f9e8e8","wires":[["7a028d33.c7867c"]]},{"id":"7a028d33.c7867c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='400'/>\n\t<parameter name='error-message' value='vnf-id not found'/>","comments":"","x":854.0226898193359,"y":173.6618013381958,"z":"8bafd60a.f9e8e8","wires":[]},{"id":"f7dbd114.d5b85","type":"set","name":"set: last-order-status = order-status","xml":"<set>\n\t<parameter name=\"service-data.oper-status.last-order-status\" value=\"`$service-data.oper-status.order-status`\"/>","comments":"","x":510.2273178100586,"y":365.987587928772,"z":"8bafd60a.f9e8e8","wires":[]},{"id":"e47598ee.1b6f68","type":"set","name":"Clear vnf topology","xml":"<set>\n\t<parameter name=\"service-data.\" value=\"\" /> \n","comments":"","x":454.2273178100586,"y":490.987587928772,"z":"8bafd60a.f9e8e8","wires":[]},{"id":"588037ab.411398","type":"switchNode","name":"switch: order-status = Active","xml":"<switch test=\"`$service-data.oper-status.order-status == Active`\">","comments":"","outputs":1,"x":944.9405403137207,"y":255.59526538848877,"z":"8bafd60a.f9e8e8","wires":[["499d2345.e96514"]]},{"id":"ca1dc7fb.a35a5","type":"set","name":"Set final indicator to Y","xml":"<set>\n<parameter name=\"ack-final\" value=\"Y\"/>","comments":"","x":465.5476837158203,"y":536.1905126571655,"z":"8bafd60a.f9e8e8","wires":[]},{"id":"3bd3c149.991f8e","type":"switchNode","name":"switch: INPUT aic-cloud-region","xml":"<switch test=\"`$vnf-topology-operation-input.vnf-request-information.aic-cloud-region`\">","comments":"","outputs":1,"x":497.83336639404297,"y":255.9166669845581,"z":"8bafd60a.f9e8e8","wires":[["29f9627f.944e3e"]]},{"id":"6f4819ac.e92ae8","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":729.5833625793457,"y":303.55952072143555,"z":"8bafd60a.f9e8e8","wires":[["cc9b109c.a783d8"]]},{"id":"cc9b109c.a783d8","type":"switchNode","name":"switch: INPUT aic-clli","xml":"<switch test=\"`$vnf-topology-operation-input.vnf-request-information.aic-clli`\">","comments":"","outputs":1,"x":926.5834045410156,"y":303.6666889190674,"z":"8bafd60a.f9e8e8","wires":[["36c5c0c5.92b1b","382df0cf.996808"]]},{"id":"29f9627f.944e3e","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":729.083423614502,"y":255.66668128967285,"z":"8bafd60a.f9e8e8","wires":[["588037ab.411398"]]},{"id":"36c5c0c5.92b1b","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":1121.583351135254,"y":304.4166622161865,"z":"8bafd60a.f9e8e8","wires":[["c9b05e7f.f314d8"]]},{"id":"c9b05e7f.f314d8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='400'/>\n\t<parameter name='error-message' value='Either aic-cloud-region or aic-clli must be present'/>","comments":"","x":1294.083351135254,"y":304.9166622161865,"z":"8bafd60a.f9e8e8","wires":[]},{"id":"382df0cf.996808","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1122.833351135254,"y":346.9166622161865,"z":"8bafd60a.f9e8e8","wires":[["b2a8ee0.050159"]]},{"id":"ad2e2232.a5be28","type":"save","name":"delete generic-vnf-l3-network","xml":"<delete plugin=\"org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource\" \n\tresource=\"generic-vnf-l3-network\" \n\tkey=\"DELETE FROM GENERIC_VNF_L3_NETWORK WHERE vnf_id = $service-data.vnf-id\" \n\tforce=\"true\" >\n\n","comments":"","outputs":1,"x":1245.333381652832,"y":469.4166851043701,"z":"8bafd60a.f9e8e8","wires":[["fdbba735.e0de7"]]},{"id":"e9bd3f49.9f08a8","type":"save","name":"delete GammaResource: generic-vnf","xml":"<delete plugin=\"org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource\" \n\tresource=\"generic-vnf\" \n\tkey=\"DELETE FROM GENERIC_VNF where vnf_id = $service-data.vnf-id\" \n\tlocal-only=\"true\" \n\tforce=\"true\" >\n\n","comments":"","outputs":1,"x":1268.992546081543,"y":555.7879467010498,"z":"8bafd60a.f9e8e8","wires":[["fdbba735.e0de7"]]},{"id":"26073509.d26ec2","type":"save","name":"delete generic-vnf-vserver","xml":"<delete plugin=\"org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource\" \n\tresource=\"generic-vnf-vserver\" \n\tkey=\"DELETE FROM GENERIC_VNF_VSERVER where vnf_id = $service-data.vnf-id\" \n\tforce=\"true\" >\n\n","comments":"","outputs":1,"x":1236.742546081543,"y":510.87122917175293,"z":"8bafd60a.f9e8e8","wires":[["fdbba735.e0de7"]]},{"id":"579bfb77.6bce7c","type":"switchNode","name":"switch: order-status = PendingDelete","xml":"<switch test=\"'$service-data.oper-status.order-status == PendingDelete'\">\n\n<!--\nleaf order-status {\n\ttype enumeration {\n\t\tenum \"Active\";\n\t\tenum \"PendingAssignment\";\n\t\tenum \"PendingCreate\";\n\t\tenum \"PendingUpdate\";\n\t\tenum \"Deleted\";\n\t}\n}\n-->","comments":"","outputs":1,"x":1268.583366394043,"y":427.66666984558105,"z":"8bafd60a.f9e8e8","wires":[["aabc86d2.b53c08"]]},{"id":"aabc86d2.b53c08","type":"other","name":"false","xml":"<outcome value='false'>","comments":"","outputs":1,"x":1497.9167404174805,"y":427.9999828338623,"z":"8bafd60a.f9e8e8","wires":[["1d00dfdf.4c452"]]},{"id":"1d00dfdf.4c452","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='400'/>\n\t<parameter name='error-message' value='Invalid order-status'/>","comments":"","x":1650.249870300293,"y":428.00004386901855,"z":"8bafd60a.f9e8e8","wires":[]},{"id":"b2a8ee0.050159","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1015.3333511352539,"y":427.9166622161865,"z":"8bafd60a.f9e8e8","wires":[["ad2e2232.a5be28","e9bd3f49.9f08a8","26073509.d26ec2","14ecdcf0.08e2c3"]]},{"id":"fdbba735.e0de7","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1531.583351135254,"y":510.4166622161865,"z":"8bafd60a.f9e8e8","wires":[["64bf16b1.96428"]]},{"id":"64bf16b1.96428","type":"set","name":"set: error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"An error occurred while deleting generic-vnf, generic-vnf-l3-netweork or generic-vnf-vserver from GammaResource\"/>","comments":"","x":1714.0833740234375,"y":510.41667079925537,"z":"8bafd60a.f9e8e8","wires":[]},{"id":"14ecdcf0.08e2c3","type":"save","name":"delete AnAI: generic-vnf","xml":"<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"generic-vnf\" \n\tkey=\"generic-vnf.vnf-id = $service-data.vnf-id\" \n\tlocal-only=\"false\" \n\tforce=\"true\" >\n\n","comments":"","outputs":1,"x":1228.4445495605469,"y":600.1666746139526,"z":"8bafd60a.f9e8e8","wires":[["9832e19f.ecb298"]]},{"id":"9832e19f.ecb298","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1420.4241561889648,"y":600.2953777313232,"z":"8bafd60a.f9e8e8","wires":[["fbabc3e8.8b39d"]]},{"id":"fbabc3e8.8b39d","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='500'/>\n\t<parameter name='error-message' value=\"`'Failed to delete generic-vnf from AnAI with vnf-id = '+ $service-data.vnf-id`\"/>","comments":"","x":1578.5906829833984,"y":600.378758430481,"z":"8bafd60a.f9e8e8","wires":[]},{"id":"94222545.335fe8","type":"comment","name":"NOT checking order-status intentionally","info":"","comments":"","x":1372.833366394043,"y":391.9166679382324,"z":"8bafd60a.f9e8e8","wires":[]},{"id":"6deab84a.46fd68","type":"comment","name":"Removing check for aic-cllu in 1707","info":"ks220y: Confirmed with Pat Cheung, as MSO won't send aic-clli","comments":"","x":816.1235427856445,"y":341.9444580078125,"z":"8bafd60a.f9e8e8","wires":[]}]
